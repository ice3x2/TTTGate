var dl=Object.defineProperty;var hl=(e,t,a)=>t in e?dl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var Lt=(e,t,a)=>(hl(e,typeof t!="symbol"?t+"":t,a),a);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();function ct(){}function pl(e,t){for(const a in t)e[a]=t[a];return e}function eo(e){return e()}function _0(){return Object.create(null)}function nr(e){e.forEach(eo)}function Wa(e){return typeof e=="function"}function Gt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let an;function Xi(e,t){return e===t?!0:(an||(an=document.createElement("a")),an.href=t,e===an.href)}function vl(e){return Object.keys(e).length===0}function gl(e,t,a,r){if(e){const n=to(e,t,a,r);return e[0](n)}}function to(e,t,a,r){return e[1]&&r?pl(a.ctx.slice(),e[1](r(t))):a.ctx}function yl(e,t,a,r){if(e[2]&&r){const n=e[2](r(a));if(t.dirty===void 0)return n;if(typeof n=="object"){const i=[],s=Math.max(t.dirty.length,n.length);for(let o=0;o<s;o+=1)i[o]=t.dirty[o]|n[o];return i}return t.dirty|n}return t.dirty}function xl(e,t,a,r,n,i){if(n){const s=to(t,a,r,i);e.p(s,n)}}function ml(e){if(e.ctx.length>32){const t=[],a=e.ctx.length/32;for(let r=0;r<a;r++)t[r]=-1;return t}return-1}function m(e,t){e.appendChild(t)}function le(e,t,a){e.insertBefore(t,a||null)}function se(e){e.parentNode&&e.parentNode.removeChild(e)}function _a(e,t){for(let a=0;a<e.length;a+=1)e[a]&&e[a].d(t)}function N(e){return document.createElement(e)}function Cl(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function de(e){return document.createTextNode(e)}function Q(){return de(" ")}function ja(){return de("")}function _e(e,t,a,r){return e.addEventListener(t,a,r),()=>e.removeEventListener(t,a,r)}function R(e,t,a){a==null?e.removeAttribute(t):e.getAttribute(t)!==a&&e.setAttribute(t,a)}function Mt(e){return e===""?null:+e}function El(e){return Array.from(e.childNodes)}function Ke(e,t){t=""+t,e.data!==t&&(e.data=t)}function qe(e,t){e.value=t??""}function L(e,t,a,r){a==null?e.style.removeProperty(t):e.style.setProperty(t,a,r?"important":"")}function b0(e,t,a){for(let r=0;r<e.options.length;r+=1){const n=e.options[r];if(n.__value===t){n.selected=!0;return}}(!a||t!==void 0)&&(e.selectedIndex=-1)}function _l(e){const t=e.querySelector(":checked");return t&&t.__value}function bl(e,t,{bubbles:a=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:a,cancelable:r})}class Tn{constructor(t=!1){Lt(this,"is_svg",!1);Lt(this,"e");Lt(this,"n");Lt(this,"t");Lt(this,"a");this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,a,r=null){this.e||(this.is_svg?this.e=Cl(a.nodeName):this.e=N(a.nodeType===11?"TEMPLATE":a.nodeName),this.t=a.tagName!=="TEMPLATE"?a:a.content,this.c(t)),this.i(r)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(t){for(let a=0;a<this.n.length;a+=1)le(this.t,this.n[a],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(se)}}let qa;function Fa(e){qa=e}function An(){if(!qa)throw new Error("Function called outside component initialization");return qa}function Sl(e){An().$$.before_update.push(e)}function kr(e){An().$$.on_mount.push(e)}function Tl(e){An().$$.after_update.push(e)}function Ya(){const e=An();return(t,a,{cancelable:r=!1}={})=>{const n=e.$$.callbacks[t];if(n){const i=bl(t,a,{cancelable:r});return n.slice().forEach(s=>{s.call(e,i)}),!i.defaultPrevented}return!0}}const ha=[],ft=[];let xa=[];const wi=[],Al=Promise.resolve();let ki=!1;function Bl(){ki||(ki=!0,Al.then(vr))}function pn(e){xa.push(e)}function Kt(e){wi.push(e)}const Mn=new Set;let ca=0;function vr(){if(ca!==0)return;const e=qa;do{try{for(;ca<ha.length;){const t=ha[ca];ca++,Fa(t),Il(t.$$)}}catch(t){throw ha.length=0,ca=0,t}for(Fa(null),ha.length=0,ca=0;ft.length;)ft.pop()();for(let t=0;t<xa.length;t+=1){const a=xa[t];Mn.has(a)||(Mn.add(a),a())}xa.length=0}while(ha.length);for(;wi.length;)wi.pop()();ki=!1,Mn.clear(),Fa(e)}function Il(e){if(e.fragment!==null){e.update(),nr(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(pn)}}function wl(e){const t=[],a=[];xa.forEach(r=>e.indexOf(r)===-1?t.push(r):a.push(r)),a.forEach(r=>r()),xa=t}const un=new Set;let na;function zr(){na={r:0,c:[],p:na}}function qr(){na.r||nr(na.c),na=na.p}function Te(e,t){e&&e.i&&(un.delete(e),e.i(t))}function De(e,t,a,r){if(e&&e.o){if(un.has(e))return;un.add(e),na.c.push(()=>{un.delete(e),r&&(a&&e.d(1),r())}),e.o(t)}else r&&r()}function ar(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Ht(e,t,a){const r=e.$$.props[t];r!==void 0&&(e.$$.bound[r]=a,a(e.$$.ctx[r]))}function ut(e){e&&e.c()}function ot(e,t,a){const{fragment:r,after_update:n}=e.$$;r&&r.m(t,a),pn(()=>{const i=e.$$.on_mount.map(eo).filter(Wa);e.$$.on_destroy?e.$$.on_destroy.push(...i):nr(i),e.$$.on_mount=[]}),n.forEach(pn)}function lt(e,t){const a=e.$$;a.fragment!==null&&(wl(a.after_update),nr(a.on_destroy),a.fragment&&a.fragment.d(t),a.on_destroy=a.fragment=null,a.ctx=[])}function kl(e,t){e.$$.dirty[0]===-1&&(ha.push(e),Bl(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Qt(e,t,a,r,n,i,s,o=[-1]){const f=qa;Fa(e);const l=e.$$={fragment:null,ctx:[],props:i,update:ct,not_equal:n,bound:_0(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(f?f.$$.context:[])),callbacks:_0(),dirty:o,skip_bound:!1,root:t.target||f.$$.root};s&&s(l.root);let u=!1;if(l.ctx=a?a(e,t.props||{},(c,d,...h)=>{const p=h.length?h[0]:d;return l.ctx&&n(l.ctx[c],l.ctx[c]=p)&&(!l.skip_bound&&l.bound[c]&&l.bound[c](p),u&&kl(e,c)),d}):[],l.update(),u=!0,nr(l.before_update),l.fragment=r?r(l.ctx):!1,t.target){if(t.hydrate){const c=El(t.target);l.fragment&&l.fragment.l(c),c.forEach(se)}else l.fragment&&l.fragment.c();t.intro&&Te(e.$$.fragment),ot(e,t.target,t.anchor),vr()}Fa(f)}class Wt{constructor(){Lt(this,"$$");Lt(this,"$$set")}$destroy(){lt(this,1),this.$destroy=ct}$on(t,a){if(!Wa(a))return ct;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(a),()=>{const n=r.indexOf(a);n!==-1&&r.splice(n,1)}}$set(t){this.$$set&&!vl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Nl="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Nl);var Ue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ro(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Rl(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var a=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};a.prototype=t.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(a,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}),a}var ao={exports:{}};function Ll(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Kn={exports:{}};const Dl={},Pl=Object.freeze(Object.defineProperty({__proto__:null,default:Dl},Symbol.toStringTag,{value:"Module"})),Bn=Rl(Pl);var S0;function Qe(){return S0||(S0=1,function(e,t){(function(a,r){e.exports=r()})(Ue,function(){var a=a||function(r,n){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof Ue<"u"&&Ue.crypto&&(i=Ue.crypto),!i&&typeof Ll=="function")try{i=Bn}catch{}var s=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function x(){}return function(y){var S;return x.prototype=y,S=new x,x.prototype=null,S}}(),f={},l=f.lib={},u=l.Base=function(){return{extend:function(x){var y=o(this);return x&&y.mixIn(x),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var x=this.extend();return x.init.apply(x,arguments),x},init:function(){},mixIn:function(x){for(var y in x)x.hasOwnProperty(y)&&(this[y]=x[y]);x.hasOwnProperty("toString")&&(this.toString=x.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),c=l.WordArray=u.extend({init:function(x,y){x=this.words=x||[],y!=n?this.sigBytes=y:this.sigBytes=x.length*4},toString:function(x){return(x||h).stringify(this)},concat:function(x){var y=this.words,S=x.words,T=this.sigBytes,A=x.sigBytes;if(this.clamp(),T%4)for(var k=0;k<A;k++){var B=S[k>>>2]>>>24-k%4*8&255;y[T+k>>>2]|=B<<24-(T+k)%4*8}else for(var O=0;O<A;O+=4)y[T+O>>>2]=S[O>>>2];return this.sigBytes+=A,this},clamp:function(){var x=this.words,y=this.sigBytes;x[y>>>2]&=4294967295<<32-y%4*8,x.length=r.ceil(y/4)},clone:function(){var x=u.clone.call(this);return x.words=this.words.slice(0),x},random:function(x){for(var y=[],S=0;S<x;S+=4)y.push(s());return new c.init(y,x)}}),d=f.enc={},h=d.Hex={stringify:function(x){for(var y=x.words,S=x.sigBytes,T=[],A=0;A<S;A++){var k=y[A>>>2]>>>24-A%4*8&255;T.push((k>>>4).toString(16)),T.push((k&15).toString(16))}return T.join("")},parse:function(x){for(var y=x.length,S=[],T=0;T<y;T+=2)S[T>>>3]|=parseInt(x.substr(T,2),16)<<24-T%8*4;return new c.init(S,y/2)}},p=d.Latin1={stringify:function(x){for(var y=x.words,S=x.sigBytes,T=[],A=0;A<S;A++){var k=y[A>>>2]>>>24-A%4*8&255;T.push(String.fromCharCode(k))}return T.join("")},parse:function(x){for(var y=x.length,S=[],T=0;T<y;T++)S[T>>>2]|=(x.charCodeAt(T)&255)<<24-T%4*8;return new c.init(S,y)}},v=d.Utf8={stringify:function(x){try{return decodeURIComponent(escape(p.stringify(x)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(x){return p.parse(unescape(encodeURIComponent(x)))}},g=l.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(x){typeof x=="string"&&(x=v.parse(x)),this._data.concat(x),this._nDataBytes+=x.sigBytes},_process:function(x){var y,S=this._data,T=S.words,A=S.sigBytes,k=this.blockSize,B=k*4,O=A/B;x?O=r.ceil(O):O=r.max((O|0)-this._minBufferSize,0);var I=O*k,w=r.min(I*4,A);if(I){for(var P=0;P<I;P+=k)this._doProcessBlock(T,P);y=T.splice(0,I),S.sigBytes-=w}return new c.init(y,w)},clone:function(){var x=u.clone.call(this);return x._data=this._data.clone(),x},_minBufferSize:0});l.Hasher=g.extend({cfg:u.extend(),init:function(x){this.cfg=this.cfg.extend(x),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(x){return this._append(x),this._process(),this},finalize:function(x){x&&this._append(x);var y=this._doFinalize();return y},blockSize:16,_createHelper:function(x){return function(y,S){return new x.init(S).finalize(y)}},_createHmacHelper:function(x){return function(y,S){return new C.HMAC.init(x,S).finalize(y)}}});var C=f.algo={};return f}(Math);return a})}(Kn)),Kn.exports}var Hn={exports:{}},T0;function In(){return T0||(T0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){return function(r){var n=a,i=n.lib,s=i.Base,o=i.WordArray,f=n.x64={};f.Word=s.extend({init:function(l,u){this.high=l,this.low=u}}),f.WordArray=s.extend({init:function(l,u){l=this.words=l||[],u!=r?this.sigBytes=u:this.sigBytes=l.length*8},toX32:function(){for(var l=this.words,u=l.length,c=[],d=0;d<u;d++){var h=l[d];c.push(h.high),c.push(h.low)}return o.create(c,this.sigBytes)},clone:function(){for(var l=s.clone.call(this),u=l.words=this.words.slice(0),c=u.length,d=0;d<c;d++)u[d]=u[d].clone();return l}})}(),a})}(Hn)),Hn.exports}var zn={exports:{}},A0;function Ul(){return A0||(A0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){return function(){if(typeof ArrayBuffer=="function"){var r=a,n=r.lib,i=n.WordArray,s=i.init,o=i.init=function(f){if(f instanceof ArrayBuffer&&(f=new Uint8Array(f)),(f instanceof Int8Array||typeof Uint8ClampedArray<"u"&&f instanceof Uint8ClampedArray||f instanceof Int16Array||f instanceof Uint16Array||f instanceof Int32Array||f instanceof Uint32Array||f instanceof Float32Array||f instanceof Float64Array)&&(f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength)),f instanceof Uint8Array){for(var l=f.byteLength,u=[],c=0;c<l;c++)u[c>>>2]|=f[c]<<24-c%4*8;s.call(this,u,l)}else s.apply(this,arguments)};o.prototype=i}}(),a.lib.WordArray})}(zn)),zn.exports}var qn={exports:{}},B0;function Ol(){return B0||(B0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.WordArray,s=r.enc;s.Utf16=s.Utf16BE={stringify:function(f){for(var l=f.words,u=f.sigBytes,c=[],d=0;d<u;d+=2){var h=l[d>>>2]>>>16-d%4*8&65535;c.push(String.fromCharCode(h))}return c.join("")},parse:function(f){for(var l=f.length,u=[],c=0;c<l;c++)u[c>>>1]|=f.charCodeAt(c)<<16-c%2*16;return i.create(u,l*2)}},s.Utf16LE={stringify:function(f){for(var l=f.words,u=f.sigBytes,c=[],d=0;d<u;d+=2){var h=o(l[d>>>2]>>>16-d%4*8&65535);c.push(String.fromCharCode(h))}return c.join("")},parse:function(f){for(var l=f.length,u=[],c=0;c<l;c++)u[c>>>1]|=o(f.charCodeAt(c)<<16-c%2*16);return i.create(u,l*2)}};function o(f){return f<<8&4278255360|f>>>8&16711935}}(),a.enc.Utf16})}(qn)),qn.exports}var Gn={exports:{}},I0;function ba(){return I0||(I0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.WordArray,s=r.enc;s.Base64={stringify:function(f){var l=f.words,u=f.sigBytes,c=this._map;f.clamp();for(var d=[],h=0;h<u;h+=3)for(var p=l[h>>>2]>>>24-h%4*8&255,v=l[h+1>>>2]>>>24-(h+1)%4*8&255,g=l[h+2>>>2]>>>24-(h+2)%4*8&255,C=p<<16|v<<8|g,x=0;x<4&&h+x*.75<u;x++)d.push(c.charAt(C>>>6*(3-x)&63));var y=c.charAt(64);if(y)for(;d.length%4;)d.push(y);return d.join("")},parse:function(f){var l=f.length,u=this._map,c=this._reverseMap;if(!c){c=this._reverseMap=[];for(var d=0;d<u.length;d++)c[u.charCodeAt(d)]=d}var h=u.charAt(64);if(h){var p=f.indexOf(h);p!==-1&&(l=p)}return o(f,l,c)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(f,l,u){for(var c=[],d=0,h=0;h<l;h++)if(h%4){var p=u[f.charCodeAt(h-1)]<<h%4*2,v=u[f.charCodeAt(h)]>>>6-h%4*2,g=p|v;c[d>>>2]|=g<<24-d%4*8,d++}return i.create(c,d)}}(),a.enc.Base64})}(Gn)),Gn.exports}var Qn={exports:{}},w0;function Vl(){return w0||(w0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.WordArray,s=r.enc;s.Base64url={stringify:function(f,l=!0){var u=f.words,c=f.sigBytes,d=l?this._safe_map:this._map;f.clamp();for(var h=[],p=0;p<c;p+=3)for(var v=u[p>>>2]>>>24-p%4*8&255,g=u[p+1>>>2]>>>24-(p+1)%4*8&255,C=u[p+2>>>2]>>>24-(p+2)%4*8&255,x=v<<16|g<<8|C,y=0;y<4&&p+y*.75<c;y++)h.push(d.charAt(x>>>6*(3-y)&63));var S=d.charAt(64);if(S)for(;h.length%4;)h.push(S);return h.join("")},parse:function(f,l=!0){var u=f.length,c=l?this._safe_map:this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var h=0;h<c.length;h++)d[c.charCodeAt(h)]=h}var p=c.charAt(64);if(p){var v=f.indexOf(p);v!==-1&&(u=v)}return o(f,u,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function o(f,l,u){for(var c=[],d=0,h=0;h<l;h++)if(h%4){var p=u[f.charCodeAt(h-1)]<<h%4*2,v=u[f.charCodeAt(h)]>>>6-h%4*2,g=p|v;c[d>>>2]|=g<<24-d%4*8,d++}return i.create(c,d)}}(),a.enc.Base64url})}(Qn)),Qn.exports}var Wn={exports:{}},k0;function Sa(){return k0||(k0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){return function(r){var n=a,i=n.lib,s=i.WordArray,o=i.Hasher,f=n.algo,l=[];(function(){for(var v=0;v<64;v++)l[v]=r.abs(r.sin(v+1))*4294967296|0})();var u=f.MD5=o.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(v,g){for(var C=0;C<16;C++){var x=g+C,y=v[x];v[x]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var S=this._hash.words,T=v[g+0],A=v[g+1],k=v[g+2],B=v[g+3],O=v[g+4],I=v[g+5],w=v[g+6],P=v[g+7],V=v[g+8],$=v[g+9],K=v[g+10],H=v[g+11],q=v[g+12],ne=v[g+13],fe=v[g+14],X=v[g+15],M=S[0],G=S[1],Y=S[2],W=S[3];M=c(M,G,Y,W,T,7,l[0]),W=c(W,M,G,Y,A,12,l[1]),Y=c(Y,W,M,G,k,17,l[2]),G=c(G,Y,W,M,B,22,l[3]),M=c(M,G,Y,W,O,7,l[4]),W=c(W,M,G,Y,I,12,l[5]),Y=c(Y,W,M,G,w,17,l[6]),G=c(G,Y,W,M,P,22,l[7]),M=c(M,G,Y,W,V,7,l[8]),W=c(W,M,G,Y,$,12,l[9]),Y=c(Y,W,M,G,K,17,l[10]),G=c(G,Y,W,M,H,22,l[11]),M=c(M,G,Y,W,q,7,l[12]),W=c(W,M,G,Y,ne,12,l[13]),Y=c(Y,W,M,G,fe,17,l[14]),G=c(G,Y,W,M,X,22,l[15]),M=d(M,G,Y,W,A,5,l[16]),W=d(W,M,G,Y,w,9,l[17]),Y=d(Y,W,M,G,H,14,l[18]),G=d(G,Y,W,M,T,20,l[19]),M=d(M,G,Y,W,I,5,l[20]),W=d(W,M,G,Y,K,9,l[21]),Y=d(Y,W,M,G,X,14,l[22]),G=d(G,Y,W,M,O,20,l[23]),M=d(M,G,Y,W,$,5,l[24]),W=d(W,M,G,Y,fe,9,l[25]),Y=d(Y,W,M,G,B,14,l[26]),G=d(G,Y,W,M,V,20,l[27]),M=d(M,G,Y,W,ne,5,l[28]),W=d(W,M,G,Y,k,9,l[29]),Y=d(Y,W,M,G,P,14,l[30]),G=d(G,Y,W,M,q,20,l[31]),M=h(M,G,Y,W,I,4,l[32]),W=h(W,M,G,Y,V,11,l[33]),Y=h(Y,W,M,G,H,16,l[34]),G=h(G,Y,W,M,fe,23,l[35]),M=h(M,G,Y,W,A,4,l[36]),W=h(W,M,G,Y,O,11,l[37]),Y=h(Y,W,M,G,P,16,l[38]),G=h(G,Y,W,M,K,23,l[39]),M=h(M,G,Y,W,ne,4,l[40]),W=h(W,M,G,Y,T,11,l[41]),Y=h(Y,W,M,G,B,16,l[42]),G=h(G,Y,W,M,w,23,l[43]),M=h(M,G,Y,W,$,4,l[44]),W=h(W,M,G,Y,q,11,l[45]),Y=h(Y,W,M,G,X,16,l[46]),G=h(G,Y,W,M,k,23,l[47]),M=p(M,G,Y,W,T,6,l[48]),W=p(W,M,G,Y,P,10,l[49]),Y=p(Y,W,M,G,fe,15,l[50]),G=p(G,Y,W,M,I,21,l[51]),M=p(M,G,Y,W,q,6,l[52]),W=p(W,M,G,Y,B,10,l[53]),Y=p(Y,W,M,G,K,15,l[54]),G=p(G,Y,W,M,A,21,l[55]),M=p(M,G,Y,W,V,6,l[56]),W=p(W,M,G,Y,X,10,l[57]),Y=p(Y,W,M,G,w,15,l[58]),G=p(G,Y,W,M,ne,21,l[59]),M=p(M,G,Y,W,O,6,l[60]),W=p(W,M,G,Y,H,10,l[61]),Y=p(Y,W,M,G,k,15,l[62]),G=p(G,Y,W,M,$,21,l[63]),S[0]=S[0]+M|0,S[1]=S[1]+G|0,S[2]=S[2]+Y|0,S[3]=S[3]+W|0},_doFinalize:function(){var v=this._data,g=v.words,C=this._nDataBytes*8,x=v.sigBytes*8;g[x>>>5]|=128<<24-x%32;var y=r.floor(C/4294967296),S=C;g[(x+64>>>9<<4)+15]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,g[(x+64>>>9<<4)+14]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,v.sigBytes=(g.length+1)*4,this._process();for(var T=this._hash,A=T.words,k=0;k<4;k++){var B=A[k];A[k]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360}return T},clone:function(){var v=o.clone.call(this);return v._hash=this._hash.clone(),v}});function c(v,g,C,x,y,S,T){var A=v+(g&C|~g&x)+y+T;return(A<<S|A>>>32-S)+g}function d(v,g,C,x,y,S,T){var A=v+(g&x|C&~x)+y+T;return(A<<S|A>>>32-S)+g}function h(v,g,C,x,y,S,T){var A=v+(g^C^x)+y+T;return(A<<S|A>>>32-S)+g}function p(v,g,C,x,y,S,T){var A=v+(C^(g|~x))+y+T;return(A<<S|A>>>32-S)+g}n.MD5=o._createHelper(u),n.HmacMD5=o._createHmacHelper(u)}(Math),a.MD5})}(Wn)),Wn.exports}var jn={exports:{}},N0;function Zi(){return N0||(N0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.WordArray,s=n.Hasher,o=r.algo,f=[],l=o.SHA1=s.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,c){for(var d=this._hash.words,h=d[0],p=d[1],v=d[2],g=d[3],C=d[4],x=0;x<80;x++){if(x<16)f[x]=u[c+x]|0;else{var y=f[x-3]^f[x-8]^f[x-14]^f[x-16];f[x]=y<<1|y>>>31}var S=(h<<5|h>>>27)+C+f[x];x<20?S+=(p&v|~p&g)+1518500249:x<40?S+=(p^v^g)+1859775393:x<60?S+=(p&v|p&g|v&g)-1894007588:S+=(p^v^g)-899497514,C=g,g=v,v=p<<30|p>>>2,p=h,h=S}d[0]=d[0]+h|0,d[1]=d[1]+p|0,d[2]=d[2]+v|0,d[3]=d[3]+g|0,d[4]=d[4]+C|0},_doFinalize:function(){var u=this._data,c=u.words,d=this._nDataBytes*8,h=u.sigBytes*8;return c[h>>>5]|=128<<24-h%32,c[(h+64>>>9<<4)+14]=Math.floor(d/4294967296),c[(h+64>>>9<<4)+15]=d,u.sigBytes=c.length*4,this._process(),this._hash},clone:function(){var u=s.clone.call(this);return u._hash=this._hash.clone(),u}});r.SHA1=s._createHelper(l),r.HmacSHA1=s._createHmacHelper(l)}(),a.SHA1})}(jn)),jn.exports}var Yn={exports:{}},R0;function no(){return R0||(R0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){return function(r){var n=a,i=n.lib,s=i.WordArray,o=i.Hasher,f=n.algo,l=[],u=[];(function(){function h(C){for(var x=r.sqrt(C),y=2;y<=x;y++)if(!(C%y))return!1;return!0}function p(C){return(C-(C|0))*4294967296|0}for(var v=2,g=0;g<64;)h(v)&&(g<8&&(l[g]=p(r.pow(v,1/2))),u[g]=p(r.pow(v,1/3)),g++),v++})();var c=[],d=f.SHA256=o.extend({_doReset:function(){this._hash=new s.init(l.slice(0))},_doProcessBlock:function(h,p){for(var v=this._hash.words,g=v[0],C=v[1],x=v[2],y=v[3],S=v[4],T=v[5],A=v[6],k=v[7],B=0;B<64;B++){if(B<16)c[B]=h[p+B]|0;else{var O=c[B-15],I=(O<<25|O>>>7)^(O<<14|O>>>18)^O>>>3,w=c[B-2],P=(w<<15|w>>>17)^(w<<13|w>>>19)^w>>>10;c[B]=I+c[B-7]+P+c[B-16]}var V=S&T^~S&A,$=g&C^g&x^C&x,K=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),H=(S<<26|S>>>6)^(S<<21|S>>>11)^(S<<7|S>>>25),q=k+H+V+u[B]+c[B],ne=K+$;k=A,A=T,T=S,S=y+q|0,y=x,x=C,C=g,g=q+ne|0}v[0]=v[0]+g|0,v[1]=v[1]+C|0,v[2]=v[2]+x|0,v[3]=v[3]+y|0,v[4]=v[4]+S|0,v[5]=v[5]+T|0,v[6]=v[6]+A|0,v[7]=v[7]+k|0},_doFinalize:function(){var h=this._data,p=h.words,v=this._nDataBytes*8,g=h.sigBytes*8;return p[g>>>5]|=128<<24-g%32,p[(g+64>>>9<<4)+14]=r.floor(v/4294967296),p[(g+64>>>9<<4)+15]=v,h.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var h=o.clone.call(this);return h._hash=this._hash.clone(),h}});n.SHA256=o._createHelper(d),n.HmacSHA256=o._createHmacHelper(d)}(Math),a.SHA256})}(Yn)),Yn.exports}var Xn={exports:{}},L0;function Fl(){return L0||(L0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),no())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.WordArray,s=r.algo,o=s.SHA256,f=s.SHA224=o.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var l=o._doFinalize.call(this);return l.sigBytes-=4,l}});r.SHA224=o._createHelper(f),r.HmacSHA224=o._createHmacHelper(f)}(),a.SHA224})}(Xn)),Xn.exports}var Zn={exports:{}},D0;function io(){return D0||(D0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),In())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.Hasher,s=r.x64,o=s.Word,f=s.WordArray,l=r.algo;function u(){return o.create.apply(o,arguments)}var c=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],d=[];(function(){for(var p=0;p<80;p++)d[p]=u()})();var h=l.SHA512=i.extend({_doReset:function(){this._hash=new f.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(p,v){for(var g=this._hash.words,C=g[0],x=g[1],y=g[2],S=g[3],T=g[4],A=g[5],k=g[6],B=g[7],O=C.high,I=C.low,w=x.high,P=x.low,V=y.high,$=y.low,K=S.high,H=S.low,q=T.high,ne=T.low,fe=A.high,X=A.low,M=k.high,G=k.low,Y=B.high,W=B.low,ve=O,he=I,xe=w,ae=P,ye=V,Pe=$,Re=K,Ae=H,Ie=q,me=ne,Se=fe,ge=X,Ve=M,Be=G,gt=Y,yt=W,xt=0;xt<80;xt++){var et,Bt,Ye=d[xt];if(xt<16)Bt=Ye.high=p[v+xt*2]|0,et=Ye.low=p[v+xt*2+1]|0;else{var Ze=d[xt-15],j=Ze.high,J=Ze.low,ke=(j>>>1|J<<31)^(j>>>8|J<<24)^j>>>7,we=(J>>>1|j<<31)^(J>>>8|j<<24)^(J>>>7|j<<25),pt=d[xt-2],jt=pt.high,ir=pt.low,$a=(jt>>>19|ir<<13)^(jt<<3|ir>>>29)^jt>>>6,Rt=(ir>>>19|jt<<13)^(ir<<3|jt>>>29)^(ir>>>6|jt<<26),br=d[xt-7],Nr=br.high,Rr=br.low,ka=d[xt-16],Na=ka.high,Lr=ka.low;et=we+Rr,Bt=ke+Nr+(et>>>0<we>>>0?1:0),et=et+Rt,Bt=Bt+$a+(et>>>0<Rt>>>0?1:0),et=et+Lr,Bt=Bt+Na+(et>>>0<Lr>>>0?1:0),Ye.high=Bt,Ye.low=et}var sr=Ie&Se^~Ie&Ve,Ra=me&ge^~me&Be,Sr=ve&xe^ve&ye^xe&ye,en=he&ae^he&Pe^ae&Pe,jr=(ve>>>28|he<<4)^(ve<<30|he>>>2)^(ve<<25|he>>>7),ur=(he>>>28|ve<<4)^(he<<30|ve>>>2)^(he<<25|ve>>>7),ua=(Ie>>>14|me<<18)^(Ie>>>18|me<<14)^(Ie<<23|me>>>9),La=(me>>>14|Ie<<18)^(me>>>18|Ie<<14)^(me<<23|Ie>>>9),Yr=c[xt],tn=Yr.high,Tr=Yr.low,mt=yt+La,Zt=gt+ua+(mt>>>0<yt>>>0?1:0),mt=mt+Ra,Zt=Zt+sr+(mt>>>0<Ra>>>0?1:0),mt=mt+Tr,Zt=Zt+tn+(mt>>>0<Tr>>>0?1:0),mt=mt+et,Zt=Zt+Bt+(mt>>>0<et>>>0?1:0),Da=ur+en,Dt=jr+Sr+(Da>>>0<ur>>>0?1:0);gt=Ve,yt=Be,Ve=Se,Be=ge,Se=Ie,ge=me,me=Ae+mt|0,Ie=Re+Zt+(me>>>0<Ae>>>0?1:0)|0,Re=ye,Ae=Pe,ye=xe,Pe=ae,xe=ve,ae=he,he=mt+Da|0,ve=Zt+Dt+(he>>>0<mt>>>0?1:0)|0}I=C.low=I+he,C.high=O+ve+(I>>>0<he>>>0?1:0),P=x.low=P+ae,x.high=w+xe+(P>>>0<ae>>>0?1:0),$=y.low=$+Pe,y.high=V+ye+($>>>0<Pe>>>0?1:0),H=S.low=H+Ae,S.high=K+Re+(H>>>0<Ae>>>0?1:0),ne=T.low=ne+me,T.high=q+Ie+(ne>>>0<me>>>0?1:0),X=A.low=X+ge,A.high=fe+Se+(X>>>0<ge>>>0?1:0),G=k.low=G+Be,k.high=M+Ve+(G>>>0<Be>>>0?1:0),W=B.low=W+yt,B.high=Y+gt+(W>>>0<yt>>>0?1:0)},_doFinalize:function(){var p=this._data,v=p.words,g=this._nDataBytes*8,C=p.sigBytes*8;v[C>>>5]|=128<<24-C%32,v[(C+128>>>10<<5)+30]=Math.floor(g/4294967296),v[(C+128>>>10<<5)+31]=g,p.sigBytes=v.length*4,this._process();var x=this._hash.toX32();return x},clone:function(){var p=i.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:1024/32});r.SHA512=i._createHelper(h),r.HmacSHA512=i._createHmacHelper(h)}(),a.SHA512})}(Zn)),Zn.exports}var Jn={exports:{}},P0;function Ml(){return P0||(P0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),In(),io())})(Ue,function(a){return function(){var r=a,n=r.x64,i=n.Word,s=n.WordArray,o=r.algo,f=o.SHA512,l=o.SHA384=f.extend({_doReset:function(){this._hash=new s.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var u=f._doFinalize.call(this);return u.sigBytes-=16,u}});r.SHA384=f._createHelper(l),r.HmacSHA384=f._createHmacHelper(l)}(),a.SHA384})}(Jn)),Jn.exports}var $n={exports:{}},U0;function Kl(){return U0||(U0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),In())})(Ue,function(a){return function(r){var n=a,i=n.lib,s=i.WordArray,o=i.Hasher,f=n.x64,l=f.Word,u=n.algo,c=[],d=[],h=[];(function(){for(var g=1,C=0,x=0;x<24;x++){c[g+5*C]=(x+1)*(x+2)/2%64;var y=C%5,S=(2*g+3*C)%5;g=y,C=S}for(var g=0;g<5;g++)for(var C=0;C<5;C++)d[g+5*C]=C+(2*g+3*C)%5*5;for(var T=1,A=0;A<24;A++){for(var k=0,B=0,O=0;O<7;O++){if(T&1){var I=(1<<O)-1;I<32?B^=1<<I:k^=1<<I-32}T&128?T=T<<1^113:T<<=1}h[A]=l.create(k,B)}})();var p=[];(function(){for(var g=0;g<25;g++)p[g]=l.create()})();var v=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var g=this._state=[],C=0;C<25;C++)g[C]=new l.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(g,C){for(var x=this._state,y=this.blockSize/2,S=0;S<y;S++){var T=g[C+2*S],A=g[C+2*S+1];T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360;var k=x[S];k.high^=A,k.low^=T}for(var B=0;B<24;B++){for(var O=0;O<5;O++){for(var I=0,w=0,P=0;P<5;P++){var k=x[O+5*P];I^=k.high,w^=k.low}var V=p[O];V.high=I,V.low=w}for(var O=0;O<5;O++)for(var $=p[(O+4)%5],K=p[(O+1)%5],H=K.high,q=K.low,I=$.high^(H<<1|q>>>31),w=$.low^(q<<1|H>>>31),P=0;P<5;P++){var k=x[O+5*P];k.high^=I,k.low^=w}for(var ne=1;ne<25;ne++){var I,w,k=x[ne],fe=k.high,X=k.low,M=c[ne];M<32?(I=fe<<M|X>>>32-M,w=X<<M|fe>>>32-M):(I=X<<M-32|fe>>>64-M,w=fe<<M-32|X>>>64-M);var G=p[d[ne]];G.high=I,G.low=w}var Y=p[0],W=x[0];Y.high=W.high,Y.low=W.low;for(var O=0;O<5;O++)for(var P=0;P<5;P++){var ne=O+5*P,k=x[ne],ve=p[ne],he=p[(O+1)%5+5*P],xe=p[(O+2)%5+5*P];k.high=ve.high^~he.high&xe.high,k.low=ve.low^~he.low&xe.low}var k=x[0],ae=h[B];k.high^=ae.high,k.low^=ae.low}},_doFinalize:function(){var g=this._data,C=g.words;this._nDataBytes*8;var x=g.sigBytes*8,y=this.blockSize*32;C[x>>>5]|=1<<24-x%32,C[(r.ceil((x+1)/y)*y>>>5)-1]|=128,g.sigBytes=C.length*4,this._process();for(var S=this._state,T=this.cfg.outputLength/8,A=T/8,k=[],B=0;B<A;B++){var O=S[B],I=O.high,w=O.low;I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,k.push(w),k.push(I)}return new s.init(k,T)},clone:function(){for(var g=o.clone.call(this),C=g._state=this._state.slice(0),x=0;x<25;x++)C[x]=C[x].clone();return g}});n.SHA3=o._createHelper(v),n.HmacSHA3=o._createHmacHelper(v)}(Math),a.SHA3})}($n)),$n.exports}var ei={exports:{}},O0;function Hl(){return O0||(O0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var n=a,i=n.lib,s=i.WordArray,o=i.Hasher,f=n.algo,l=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),d=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=s.create([0,1518500249,1859775393,2400959708,2840853838]),p=s.create([1352829926,1548603684,1836072691,2053994217,0]),v=f.RIPEMD160=o.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(A,k){for(var B=0;B<16;B++){var O=k+B,I=A[O];A[O]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360}var w=this._hash.words,P=h.words,V=p.words,$=l.words,K=u.words,H=c.words,q=d.words,ne,fe,X,M,G,Y,W,ve,he,xe;Y=ne=w[0],W=fe=w[1],ve=X=w[2],he=M=w[3],xe=G=w[4];for(var ae,B=0;B<80;B+=1)ae=ne+A[k+$[B]]|0,B<16?ae+=g(fe,X,M)+P[0]:B<32?ae+=C(fe,X,M)+P[1]:B<48?ae+=x(fe,X,M)+P[2]:B<64?ae+=y(fe,X,M)+P[3]:ae+=S(fe,X,M)+P[4],ae=ae|0,ae=T(ae,H[B]),ae=ae+G|0,ne=G,G=M,M=T(X,10),X=fe,fe=ae,ae=Y+A[k+K[B]]|0,B<16?ae+=S(W,ve,he)+V[0]:B<32?ae+=y(W,ve,he)+V[1]:B<48?ae+=x(W,ve,he)+V[2]:B<64?ae+=C(W,ve,he)+V[3]:ae+=g(W,ve,he)+V[4],ae=ae|0,ae=T(ae,q[B]),ae=ae+xe|0,Y=xe,xe=he,he=T(ve,10),ve=W,W=ae;ae=w[1]+X+he|0,w[1]=w[2]+M+xe|0,w[2]=w[3]+G+Y|0,w[3]=w[4]+ne+W|0,w[4]=w[0]+fe+ve|0,w[0]=ae},_doFinalize:function(){var A=this._data,k=A.words,B=this._nDataBytes*8,O=A.sigBytes*8;k[O>>>5]|=128<<24-O%32,k[(O+64>>>9<<4)+14]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360,A.sigBytes=(k.length+1)*4,this._process();for(var I=this._hash,w=I.words,P=0;P<5;P++){var V=w[P];w[P]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360}return I},clone:function(){var A=o.clone.call(this);return A._hash=this._hash.clone(),A}});function g(A,k,B){return A^k^B}function C(A,k,B){return A&k|~A&B}function x(A,k,B){return(A|~k)^B}function y(A,k,B){return A&B|k&~B}function S(A,k,B){return A^(k|~B)}function T(A,k){return A<<k|A>>>32-k}n.RIPEMD160=o._createHelper(v),n.HmacRIPEMD160=o._createHmacHelper(v)}(),a.RIPEMD160})}(ei)),ei.exports}var ti={exports:{}},V0;function Ji(){return V0||(V0=1,function(e,t){(function(a,r){e.exports=r(Qe())})(Ue,function(a){(function(){var r=a,n=r.lib,i=n.Base,s=r.enc,o=s.Utf8,f=r.algo;f.HMAC=i.extend({init:function(l,u){l=this._hasher=new l.init,typeof u=="string"&&(u=o.parse(u));var c=l.blockSize,d=c*4;u.sigBytes>d&&(u=l.finalize(u)),u.clamp();for(var h=this._oKey=u.clone(),p=this._iKey=u.clone(),v=h.words,g=p.words,C=0;C<c;C++)v[C]^=1549556828,g[C]^=909522486;h.sigBytes=p.sigBytes=d,this.reset()},reset:function(){var l=this._hasher;l.reset(),l.update(this._iKey)},update:function(l){return this._hasher.update(l),this},finalize:function(l){var u=this._hasher,c=u.finalize(l);u.reset();var d=u.finalize(this._oKey.clone().concat(c));return d}})})()})}(ti)),ti.exports}var ri={exports:{}},F0;function zl(){return F0||(F0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Zi(),Ji())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.Base,s=n.WordArray,o=r.algo,f=o.SHA1,l=o.HMAC,u=o.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:f,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,d){for(var h=this.cfg,p=l.create(h.hasher,c),v=s.create(),g=s.create([1]),C=v.words,x=g.words,y=h.keySize,S=h.iterations;C.length<y;){var T=p.update(d).finalize(g);p.reset();for(var A=T.words,k=A.length,B=T,O=1;O<S;O++){B=p.finalize(B),p.reset();for(var I=B.words,w=0;w<k;w++)A[w]^=I[w]}v.concat(T),x[0]++}return v.sigBytes=y*4,v}});r.PBKDF2=function(c,d,h){return u.create(h).compute(c,d)}}(),a.PBKDF2})}(ri)),ri.exports}var ai={exports:{}},M0;function oa(){return M0||(M0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Zi(),Ji())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.Base,s=n.WordArray,o=r.algo,f=o.MD5,l=o.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:f,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,c){for(var d,h=this.cfg,p=h.hasher.create(),v=s.create(),g=v.words,C=h.keySize,x=h.iterations;g.length<C;){d&&p.update(d),d=p.update(u).finalize(c),p.reset();for(var y=1;y<x;y++)d=p.finalize(d),p.reset();v.concat(d)}return v.sigBytes=C*4,v}});r.EvpKDF=function(u,c,d){return l.create(d).compute(u,c)}}(),a.EvpKDF})}(ai)),ai.exports}var ni={exports:{}},K0;function Nt(){return K0||(K0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),oa())})(Ue,function(a){a.lib.Cipher||function(r){var n=a,i=n.lib,s=i.Base,o=i.WordArray,f=i.BufferedBlockAlgorithm,l=n.enc;l.Utf8;var u=l.Base64,c=n.algo,d=c.EvpKDF,h=i.Cipher=f.extend({cfg:s.extend(),createEncryptor:function(I,w){return this.create(this._ENC_XFORM_MODE,I,w)},createDecryptor:function(I,w){return this.create(this._DEC_XFORM_MODE,I,w)},init:function(I,w,P){this.cfg=this.cfg.extend(P),this._xformMode=I,this._key=w,this.reset()},reset:function(){f.reset.call(this),this._doReset()},process:function(I){return this._append(I),this._process()},finalize:function(I){I&&this._append(I);var w=this._doFinalize();return w},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function I(w){return typeof w=="string"?O:A}return function(w){return{encrypt:function(P,V,$){return I(V).encrypt(w,P,V,$)},decrypt:function(P,V,$){return I(V).decrypt(w,P,V,$)}}}}()});i.StreamCipher=h.extend({_doFinalize:function(){var I=this._process(!0);return I},blockSize:1});var p=n.mode={},v=i.BlockCipherMode=s.extend({createEncryptor:function(I,w){return this.Encryptor.create(I,w)},createDecryptor:function(I,w){return this.Decryptor.create(I,w)},init:function(I,w){this._cipher=I,this._iv=w}}),g=p.CBC=function(){var I=v.extend();I.Encryptor=I.extend({processBlock:function(P,V){var $=this._cipher,K=$.blockSize;w.call(this,P,V,K),$.encryptBlock(P,V),this._prevBlock=P.slice(V,V+K)}}),I.Decryptor=I.extend({processBlock:function(P,V){var $=this._cipher,K=$.blockSize,H=P.slice(V,V+K);$.decryptBlock(P,V),w.call(this,P,V,K),this._prevBlock=H}});function w(P,V,$){var K,H=this._iv;H?(K=H,this._iv=r):K=this._prevBlock;for(var q=0;q<$;q++)P[V+q]^=K[q]}return I}(),C=n.pad={},x=C.Pkcs7={pad:function(I,w){for(var P=w*4,V=P-I.sigBytes%P,$=V<<24|V<<16|V<<8|V,K=[],H=0;H<V;H+=4)K.push($);var q=o.create(K,V);I.concat(q)},unpad:function(I){var w=I.words[I.sigBytes-1>>>2]&255;I.sigBytes-=w}};i.BlockCipher=h.extend({cfg:h.cfg.extend({mode:g,padding:x}),reset:function(){var I;h.reset.call(this);var w=this.cfg,P=w.iv,V=w.mode;this._xformMode==this._ENC_XFORM_MODE?I=V.createEncryptor:(I=V.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==I?this._mode.init(this,P&&P.words):(this._mode=I.call(V,this,P&&P.words),this._mode.__creator=I)},_doProcessBlock:function(I,w){this._mode.processBlock(I,w)},_doFinalize:function(){var I,w=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(w.pad(this._data,this.blockSize),I=this._process(!0)):(I=this._process(!0),w.unpad(I)),I},blockSize:128/32});var y=i.CipherParams=s.extend({init:function(I){this.mixIn(I)},toString:function(I){return(I||this.formatter).stringify(this)}}),S=n.format={},T=S.OpenSSL={stringify:function(I){var w,P=I.ciphertext,V=I.salt;return V?w=o.create([1398893684,1701076831]).concat(V).concat(P):w=P,w.toString(u)},parse:function(I){var w,P=u.parse(I),V=P.words;return V[0]==1398893684&&V[1]==1701076831&&(w=o.create(V.slice(2,4)),V.splice(0,4),P.sigBytes-=16),y.create({ciphertext:P,salt:w})}},A=i.SerializableCipher=s.extend({cfg:s.extend({format:T}),encrypt:function(I,w,P,V){V=this.cfg.extend(V);var $=I.createEncryptor(P,V),K=$.finalize(w),H=$.cfg;return y.create({ciphertext:K,key:P,iv:H.iv,algorithm:I,mode:H.mode,padding:H.padding,blockSize:I.blockSize,formatter:V.format})},decrypt:function(I,w,P,V){V=this.cfg.extend(V),w=this._parse(w,V.format);var $=I.createDecryptor(P,V).finalize(w.ciphertext);return $},_parse:function(I,w){return typeof I=="string"?w.parse(I,this):I}}),k=n.kdf={},B=k.OpenSSL={execute:function(I,w,P,V){V||(V=o.random(64/8));var $=d.create({keySize:w+P}).compute(I,V),K=o.create($.words.slice(w),P*4);return $.sigBytes=w*4,y.create({key:$,iv:K,salt:V})}},O=i.PasswordBasedCipher=A.extend({cfg:A.cfg.extend({kdf:B}),encrypt:function(I,w,P,V){V=this.cfg.extend(V);var $=V.kdf.execute(P,I.keySize,I.ivSize);V.iv=$.iv;var K=A.encrypt.call(this,I,w,$.key,V);return K.mixIn($),K},decrypt:function(I,w,P,V){V=this.cfg.extend(V),w=this._parse(w,V.format);var $=V.kdf.execute(P,I.keySize,I.ivSize,w.salt);V.iv=$.iv;var K=A.decrypt.call(this,I,w,$.key,V);return K}})}()})}(ni)),ni.exports}var ii={exports:{}},H0;function ql(){return H0||(H0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return a.mode.CFB=function(){var r=a.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(i,s){var o=this._cipher,f=o.blockSize;n.call(this,i,s,f,o),this._prevBlock=i.slice(s,s+f)}}),r.Decryptor=r.extend({processBlock:function(i,s){var o=this._cipher,f=o.blockSize,l=i.slice(s,s+f);n.call(this,i,s,f,o),this._prevBlock=l}});function n(i,s,o,f){var l,u=this._iv;u?(l=u.slice(0),this._iv=void 0):l=this._prevBlock,f.encryptBlock(l,0);for(var c=0;c<o;c++)i[s+c]^=l[c]}return r}(),a.mode.CFB})}(ii)),ii.exports}var si={exports:{}},z0;function Gl(){return z0||(z0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return a.mode.CTR=function(){var r=a.lib.BlockCipherMode.extend(),n=r.Encryptor=r.extend({processBlock:function(i,s){var o=this._cipher,f=o.blockSize,l=this._iv,u=this._counter;l&&(u=this._counter=l.slice(0),this._iv=void 0);var c=u.slice(0);o.encryptBlock(c,0),u[f-1]=u[f-1]+1|0;for(var d=0;d<f;d++)i[s+d]^=c[d]}});return r.Decryptor=n,r}(),a.mode.CTR})}(si)),si.exports}var oi={exports:{}},q0;function Ql(){return q0||(q0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return a.mode.CTRGladman=function(){var r=a.lib.BlockCipherMode.extend();function n(o){if((o>>24&255)===255){var f=o>>16&255,l=o>>8&255,u=o&255;f===255?(f=0,l===255?(l=0,u===255?u=0:++u):++l):++f,o=0,o+=f<<16,o+=l<<8,o+=u}else o+=1<<24;return o}function i(o){return(o[0]=n(o[0]))===0&&(o[1]=n(o[1])),o}var s=r.Encryptor=r.extend({processBlock:function(o,f){var l=this._cipher,u=l.blockSize,c=this._iv,d=this._counter;c&&(d=this._counter=c.slice(0),this._iv=void 0),i(d);var h=d.slice(0);l.encryptBlock(h,0);for(var p=0;p<u;p++)o[f+p]^=h[p]}});return r.Decryptor=s,r}(),a.mode.CTRGladman})}(oi)),oi.exports}var li={exports:{}},G0;function Wl(){return G0||(G0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return a.mode.OFB=function(){var r=a.lib.BlockCipherMode.extend(),n=r.Encryptor=r.extend({processBlock:function(i,s){var o=this._cipher,f=o.blockSize,l=this._iv,u=this._keystream;l&&(u=this._keystream=l.slice(0),this._iv=void 0),o.encryptBlock(u,0);for(var c=0;c<f;c++)i[s+c]^=u[c]}});return r.Decryptor=n,r}(),a.mode.OFB})}(li)),li.exports}var fi={exports:{}},Q0;function jl(){return Q0||(Q0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return a.mode.ECB=function(){var r=a.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(n,i){this._cipher.encryptBlock(n,i)}}),r.Decryptor=r.extend({processBlock:function(n,i){this._cipher.decryptBlock(n,i)}}),r}(),a.mode.ECB})}(fi)),fi.exports}var ui={exports:{}},W0;function Yl(){return W0||(W0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return a.pad.AnsiX923={pad:function(r,n){var i=r.sigBytes,s=n*4,o=s-i%s,f=i+o-1;r.clamp(),r.words[f>>>2]|=o<<24-f%4*8,r.sigBytes+=o},unpad:function(r){var n=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=n}},a.pad.Ansix923})}(ui)),ui.exports}var ci={exports:{}},j0;function Xl(){return j0||(j0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return a.pad.Iso10126={pad:function(r,n){var i=n*4,s=i-r.sigBytes%i;r.concat(a.lib.WordArray.random(s-1)).concat(a.lib.WordArray.create([s<<24],1))},unpad:function(r){var n=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=n}},a.pad.Iso10126})}(ci)),ci.exports}var di={exports:{}},Y0;function Zl(){return Y0||(Y0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return a.pad.Iso97971={pad:function(r,n){r.concat(a.lib.WordArray.create([2147483648],1)),a.pad.ZeroPadding.pad(r,n)},unpad:function(r){a.pad.ZeroPadding.unpad(r),r.sigBytes--}},a.pad.Iso97971})}(di)),di.exports}var hi={exports:{}},X0;function Jl(){return X0||(X0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return a.pad.ZeroPadding={pad:function(r,n){var i=n*4;r.clamp(),r.sigBytes+=i-(r.sigBytes%i||i)},unpad:function(r){for(var n=r.words,i=r.sigBytes-1,i=r.sigBytes-1;i>=0;i--)if(n[i>>>2]>>>24-i%4*8&255){r.sigBytes=i+1;break}}},a.pad.ZeroPadding})}(hi)),hi.exports}var pi={exports:{}},Z0;function $l(){return Z0||(Z0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return a.pad.NoPadding={pad:function(){},unpad:function(){}},a.pad.NoPadding})}(pi)),pi.exports}var vi={exports:{}},J0;function ef(){return J0||(J0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),Nt())})(Ue,function(a){return function(r){var n=a,i=n.lib,s=i.CipherParams,o=n.enc,f=o.Hex,l=n.format;l.Hex={stringify:function(u){return u.ciphertext.toString(f)},parse:function(u){var c=f.parse(u);return s.create({ciphertext:c})}}}(),a.format.Hex})}(vi)),vi.exports}var gi={exports:{}},$0;function tf(){return $0||($0=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),ba(),Sa(),oa(),Nt())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.BlockCipher,s=r.algo,o=[],f=[],l=[],u=[],c=[],d=[],h=[],p=[],v=[],g=[];(function(){for(var y=[],S=0;S<256;S++)S<128?y[S]=S<<1:y[S]=S<<1^283;for(var T=0,A=0,S=0;S<256;S++){var k=A^A<<1^A<<2^A<<3^A<<4;k=k>>>8^k&255^99,o[T]=k,f[k]=T;var B=y[T],O=y[B],I=y[O],w=y[k]*257^k*16843008;l[T]=w<<24|w>>>8,u[T]=w<<16|w>>>16,c[T]=w<<8|w>>>24,d[T]=w;var w=I*16843009^O*65537^B*257^T*16843008;h[k]=w<<24|w>>>8,p[k]=w<<16|w>>>16,v[k]=w<<8|w>>>24,g[k]=w,T?(T=B^y[y[y[I^B]]],A^=y[y[A]]):T=A=1}})();var C=[0,1,2,4,8,16,32,64,128,27,54],x=s.AES=i.extend({_doReset:function(){var y;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var S=this._keyPriorReset=this._key,T=S.words,A=S.sigBytes/4,k=this._nRounds=A+6,B=(k+1)*4,O=this._keySchedule=[],I=0;I<B;I++)I<A?O[I]=T[I]:(y=O[I-1],I%A?A>6&&I%A==4&&(y=o[y>>>24]<<24|o[y>>>16&255]<<16|o[y>>>8&255]<<8|o[y&255]):(y=y<<8|y>>>24,y=o[y>>>24]<<24|o[y>>>16&255]<<16|o[y>>>8&255]<<8|o[y&255],y^=C[I/A|0]<<24),O[I]=O[I-A]^y);for(var w=this._invKeySchedule=[],P=0;P<B;P++){var I=B-P;if(P%4)var y=O[I];else var y=O[I-4];P<4||I<=4?w[P]=y:w[P]=h[o[y>>>24]]^p[o[y>>>16&255]]^v[o[y>>>8&255]]^g[o[y&255]]}}},encryptBlock:function(y,S){this._doCryptBlock(y,S,this._keySchedule,l,u,c,d,o)},decryptBlock:function(y,S){var T=y[S+1];y[S+1]=y[S+3],y[S+3]=T,this._doCryptBlock(y,S,this._invKeySchedule,h,p,v,g,f);var T=y[S+1];y[S+1]=y[S+3],y[S+3]=T},_doCryptBlock:function(y,S,T,A,k,B,O,I){for(var w=this._nRounds,P=y[S]^T[0],V=y[S+1]^T[1],$=y[S+2]^T[2],K=y[S+3]^T[3],H=4,q=1;q<w;q++){var ne=A[P>>>24]^k[V>>>16&255]^B[$>>>8&255]^O[K&255]^T[H++],fe=A[V>>>24]^k[$>>>16&255]^B[K>>>8&255]^O[P&255]^T[H++],X=A[$>>>24]^k[K>>>16&255]^B[P>>>8&255]^O[V&255]^T[H++],M=A[K>>>24]^k[P>>>16&255]^B[V>>>8&255]^O[$&255]^T[H++];P=ne,V=fe,$=X,K=M}var ne=(I[P>>>24]<<24|I[V>>>16&255]<<16|I[$>>>8&255]<<8|I[K&255])^T[H++],fe=(I[V>>>24]<<24|I[$>>>16&255]<<16|I[K>>>8&255]<<8|I[P&255])^T[H++],X=(I[$>>>24]<<24|I[K>>>16&255]<<16|I[P>>>8&255]<<8|I[V&255])^T[H++],M=(I[K>>>24]<<24|I[P>>>16&255]<<16|I[V>>>8&255]<<8|I[$&255])^T[H++];y[S]=ne,y[S+1]=fe,y[S+2]=X,y[S+3]=M},keySize:256/32});r.AES=i._createHelper(x)}(),a.AES})}(gi)),gi.exports}var yi={exports:{}},es;function rf(){return es||(es=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),ba(),Sa(),oa(),Nt())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.WordArray,s=n.BlockCipher,o=r.algo,f=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],l=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=o.DES=s.extend({_doReset:function(){for(var C=this._key,x=C.words,y=[],S=0;S<56;S++){var T=f[S]-1;y[S]=x[T>>>5]>>>31-T%32&1}for(var A=this._subKeys=[],k=0;k<16;k++){for(var B=A[k]=[],O=u[k],S=0;S<24;S++)B[S/6|0]|=y[(l[S]-1+O)%28]<<31-S%6,B[4+(S/6|0)]|=y[28+(l[S+24]-1+O)%28]<<31-S%6;B[0]=B[0]<<1|B[0]>>>31;for(var S=1;S<7;S++)B[S]=B[S]>>>(S-1)*4+3;B[7]=B[7]<<5|B[7]>>>27}for(var I=this._invSubKeys=[],S=0;S<16;S++)I[S]=A[15-S]},encryptBlock:function(C,x){this._doCryptBlock(C,x,this._subKeys)},decryptBlock:function(C,x){this._doCryptBlock(C,x,this._invSubKeys)},_doCryptBlock:function(C,x,y){this._lBlock=C[x],this._rBlock=C[x+1],p.call(this,4,252645135),p.call(this,16,65535),v.call(this,2,858993459),v.call(this,8,16711935),p.call(this,1,1431655765);for(var S=0;S<16;S++){for(var T=y[S],A=this._lBlock,k=this._rBlock,B=0,O=0;O<8;O++)B|=c[O][((k^T[O])&d[O])>>>0];this._lBlock=k,this._rBlock=A^B}var I=this._lBlock;this._lBlock=this._rBlock,this._rBlock=I,p.call(this,1,1431655765),v.call(this,8,16711935),v.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),C[x]=this._lBlock,C[x+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function p(C,x){var y=(this._lBlock>>>C^this._rBlock)&x;this._rBlock^=y,this._lBlock^=y<<C}function v(C,x){var y=(this._rBlock>>>C^this._lBlock)&x;this._lBlock^=y,this._rBlock^=y<<C}r.DES=s._createHelper(h);var g=o.TripleDES=s.extend({_doReset:function(){var C=this._key,x=C.words;if(x.length!==2&&x.length!==4&&x.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var y=x.slice(0,2),S=x.length<4?x.slice(0,2):x.slice(2,4),T=x.length<6?x.slice(0,2):x.slice(4,6);this._des1=h.createEncryptor(i.create(y)),this._des2=h.createEncryptor(i.create(S)),this._des3=h.createEncryptor(i.create(T))},encryptBlock:function(C,x){this._des1.encryptBlock(C,x),this._des2.decryptBlock(C,x),this._des3.encryptBlock(C,x)},decryptBlock:function(C,x){this._des3.decryptBlock(C,x),this._des2.encryptBlock(C,x),this._des1.decryptBlock(C,x)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=s._createHelper(g)}(),a.TripleDES})}(yi)),yi.exports}var xi={exports:{}},ts;function af(){return ts||(ts=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),ba(),Sa(),oa(),Nt())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.StreamCipher,s=r.algo,o=s.RC4=i.extend({_doReset:function(){for(var u=this._key,c=u.words,d=u.sigBytes,h=this._S=[],p=0;p<256;p++)h[p]=p;for(var p=0,v=0;p<256;p++){var g=p%d,C=c[g>>>2]>>>24-g%4*8&255;v=(v+h[p]+C)%256;var x=h[p];h[p]=h[v],h[v]=x}this._i=this._j=0},_doProcessBlock:function(u,c){u[c]^=f.call(this)},keySize:256/32,ivSize:0});function f(){for(var u=this._S,c=this._i,d=this._j,h=0,p=0;p<4;p++){c=(c+1)%256,d=(d+u[c])%256;var v=u[c];u[c]=u[d],u[d]=v,h|=u[(u[c]+u[d])%256]<<24-p*8}return this._i=c,this._j=d,h}r.RC4=i._createHelper(o);var l=s.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)f.call(this)}});r.RC4Drop=i._createHelper(l)}(),a.RC4})}(xi)),xi.exports}var mi={exports:{}},rs;function nf(){return rs||(rs=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),ba(),Sa(),oa(),Nt())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.StreamCipher,s=r.algo,o=[],f=[],l=[],u=s.Rabbit=i.extend({_doReset:function(){for(var d=this._key.words,h=this.cfg.iv,p=0;p<4;p++)d[p]=(d[p]<<8|d[p]>>>24)&16711935|(d[p]<<24|d[p]>>>8)&4278255360;var v=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],g=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var p=0;p<4;p++)c.call(this);for(var p=0;p<8;p++)g[p]^=v[p+4&7];if(h){var C=h.words,x=C[0],y=C[1],S=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,T=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,A=S>>>16|T&4294901760,k=T<<16|S&65535;g[0]^=S,g[1]^=A,g[2]^=T,g[3]^=k,g[4]^=S,g[5]^=A,g[6]^=T,g[7]^=k;for(var p=0;p<4;p++)c.call(this)}},_doProcessBlock:function(d,h){var p=this._X;c.call(this),o[0]=p[0]^p[5]>>>16^p[3]<<16,o[1]=p[2]^p[7]>>>16^p[5]<<16,o[2]=p[4]^p[1]>>>16^p[7]<<16,o[3]=p[6]^p[3]>>>16^p[1]<<16;for(var v=0;v<4;v++)o[v]=(o[v]<<8|o[v]>>>24)&16711935|(o[v]<<24|o[v]>>>8)&4278255360,d[h+v]^=o[v]},blockSize:128/32,ivSize:64/32});function c(){for(var d=this._X,h=this._C,p=0;p<8;p++)f[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<f[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<f[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<f[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<f[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<f[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<f[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<f[6]>>>0?1:0)|0,this._b=h[7]>>>0<f[7]>>>0?1:0;for(var p=0;p<8;p++){var v=d[p]+h[p],g=v&65535,C=v>>>16,x=((g*g>>>17)+g*C>>>15)+C*C,y=((v&4294901760)*v|0)+((v&65535)*v|0);l[p]=x^y}d[0]=l[0]+(l[7]<<16|l[7]>>>16)+(l[6]<<16|l[6]>>>16)|0,d[1]=l[1]+(l[0]<<8|l[0]>>>24)+l[7]|0,d[2]=l[2]+(l[1]<<16|l[1]>>>16)+(l[0]<<16|l[0]>>>16)|0,d[3]=l[3]+(l[2]<<8|l[2]>>>24)+l[1]|0,d[4]=l[4]+(l[3]<<16|l[3]>>>16)+(l[2]<<16|l[2]>>>16)|0,d[5]=l[5]+(l[4]<<8|l[4]>>>24)+l[3]|0,d[6]=l[6]+(l[5]<<16|l[5]>>>16)+(l[4]<<16|l[4]>>>16)|0,d[7]=l[7]+(l[6]<<8|l[6]>>>24)+l[5]|0}r.Rabbit=i._createHelper(u)}(),a.Rabbit})}(mi)),mi.exports}var Ci={exports:{}},as;function sf(){return as||(as=1,function(e,t){(function(a,r,n){e.exports=r(Qe(),ba(),Sa(),oa(),Nt())})(Ue,function(a){return function(){var r=a,n=r.lib,i=n.StreamCipher,s=r.algo,o=[],f=[],l=[],u=s.RabbitLegacy=i.extend({_doReset:function(){var d=this._key.words,h=this.cfg.iv,p=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],v=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var g=0;g<4;g++)c.call(this);for(var g=0;g<8;g++)v[g]^=p[g+4&7];if(h){var C=h.words,x=C[0],y=C[1],S=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,T=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,A=S>>>16|T&4294901760,k=T<<16|S&65535;v[0]^=S,v[1]^=A,v[2]^=T,v[3]^=k,v[4]^=S,v[5]^=A,v[6]^=T,v[7]^=k;for(var g=0;g<4;g++)c.call(this)}},_doProcessBlock:function(d,h){var p=this._X;c.call(this),o[0]=p[0]^p[5]>>>16^p[3]<<16,o[1]=p[2]^p[7]>>>16^p[5]<<16,o[2]=p[4]^p[1]>>>16^p[7]<<16,o[3]=p[6]^p[3]>>>16^p[1]<<16;for(var v=0;v<4;v++)o[v]=(o[v]<<8|o[v]>>>24)&16711935|(o[v]<<24|o[v]>>>8)&4278255360,d[h+v]^=o[v]},blockSize:128/32,ivSize:64/32});function c(){for(var d=this._X,h=this._C,p=0;p<8;p++)f[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<f[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<f[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<f[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<f[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<f[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<f[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<f[6]>>>0?1:0)|0,this._b=h[7]>>>0<f[7]>>>0?1:0;for(var p=0;p<8;p++){var v=d[p]+h[p],g=v&65535,C=v>>>16,x=((g*g>>>17)+g*C>>>15)+C*C,y=((v&4294901760)*v|0)+((v&65535)*v|0);l[p]=x^y}d[0]=l[0]+(l[7]<<16|l[7]>>>16)+(l[6]<<16|l[6]>>>16)|0,d[1]=l[1]+(l[0]<<8|l[0]>>>24)+l[7]|0,d[2]=l[2]+(l[1]<<16|l[1]>>>16)+(l[0]<<16|l[0]>>>16)|0,d[3]=l[3]+(l[2]<<8|l[2]>>>24)+l[1]|0,d[4]=l[4]+(l[3]<<16|l[3]>>>16)+(l[2]<<16|l[2]>>>16)|0,d[5]=l[5]+(l[4]<<8|l[4]>>>24)+l[3]|0,d[6]=l[6]+(l[5]<<16|l[5]>>>16)+(l[4]<<16|l[4]>>>16)|0,d[7]=l[7]+(l[6]<<8|l[6]>>>24)+l[5]|0}r.RabbitLegacy=i._createHelper(u)}(),a.RabbitLegacy})}(Ci)),Ci.exports}(function(e,t){(function(a,r,n){e.exports=r(Qe(),In(),Ul(),Ol(),ba(),Vl(),Sa(),Zi(),no(),Fl(),io(),Ml(),Kl(),Hl(),Ji(),zl(),oa(),Nt(),ql(),Gl(),Ql(),Wl(),jl(),Yl(),Xl(),Zl(),Jl(),$l(),ef(),tf(),rf(),af(),nf(),sf())})(Ue,function(a){return a})})(ao);var of=ao.exports;const so=ro(of);class Ga{constructor(){}static async isEmptyKey(){return(await(await fetch("/api/emptyKey",{method:"GET",credentials:"same-origin"})).json()).emptyKey}static async validateSession(){return console.log("validateSession"),(await(await fetch("/api/validateSession",{method:"GET",credentials:"same-origin"})).json()).valid}static async login(t){let a=await Ga.hashPassword(t);return(await(await fetch("/api/login",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:a})})).json()).success}static async hashPassword(t){t=t.trim()+"@";let a="";for(let r=0;r<t.length;r++)a+=Math.round(t.charCodeAt(r)/2).toString(16);return so.SHA512(t+a).toString()}}class at extends Error{constructor(){super("Invalid session"),this.name="InvalidSession"}}const ea=class ea{constructor(){Lt(this,"_severOptionHash","");Lt(this,"_serverOption",{key:"",adminPort:0,adminTls:!1,port:0,tls:!1,globalMemCacheLimit:512});Lt(this,"_tunnelingOptions",[])}static get instance(){return ea._instance||(ea._instance=new ea),ea._instance}getCachedServerOption(){return this._serverOption}async getServerOption(){let t=await fetch("/api/serverOption",{method:"GET",credentials:"same-origin"}),a=await t.json();if(!a||t.status==401)throw new at;return this._serverOption=a.serverOption,this._serverOption}async getTunnelingOption(){let t=await fetch("/api/tunnelingOption",{method:"GET",credentials:"same-origin"}),a=await t.json();if(!a||t.status==401)throw new at;return this._tunnelingOptions=a.tunnelingOptions,this._tunnelingOptions}async checkChangeServerOption(t,a){let r=this._severOptionHash;const n=12e4;let i=new Date().getTime();return new Promise(async(s,o)=>{let f=setInterval(async()=>{let l="";try{l=await this.getServerOptionHash(a.adminTls?"https":"http",a.adminPort)}catch(u){i+n<new Date().getTime()&&(clearInterval(f),o(u));try{l=await this.getServerOptionHash(t.adminTls?"https":"http",t.adminPort)}catch{l="",i+n<new Date().getTime()&&(clearInterval(f),o(u))}}l.length>0&&(clearInterval(f),s(l!=r))},1e3)})}async getServerOptionHash(t,a){let r=window.location.hostname,n=window.location.port;t||(t=window.location.protocol.replace(":","")),a&&(n=a.toString());let i=await fetch(`${t}://${r}:${n}/api/serverOptionHash`,{method:"GET",headers:{Connection:"close"}}),s=await i.json();if(!s||i.status==401)throw new at;let o=s.hash;if(!o)throw new Error("hash not found");return this._severOptionHash=o,o}async updateServerOption(t){let a=await fetch("/api/serverOption",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await a.json();if(!r||a.status==401)throw new at;return r}async updateTunnelingOption(t){let a=await fetch("/api/tunnelingOption",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await a.json();if(!r||a.status==401)throw new at;return r}async removeTunnelingOption(t){let a=await fetch("/api/tunnelingOption",{method:"DELETE",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await a.json();if(!r||a.status==401)throw new at;return r}async loadTunnelingStatus(){let t=await fetch("/api/externalServerStatuses",{method:"GET",credentials:"same-origin"}),a=await t.json();if(!a||t.status==401)throw new at;return{serverTime:a.serverTime,statuses:a.statuses}}async activeExternalPortServer(t,a,r){r=r??0;let n=await fetch(`/api/tunneling/active/${a}`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:t,timeout:r})}),i=await n.json();if(!i||n.status==401)throw new at;return i}static checkValidTunnelingOption(t){return!(t.tls==null||t.forwardPort==null||t.forwardPort<=0||t.forwardPort>65535||t.protocol==null||t.protocol!="tcp"&&t.protocol!="http"&&t.protocol!="https"||t.destinationAddress==null||t.destinationAddress.trim().length==0||t.destinationPort==null||t.destinationPort<=0||t.destinationPort>65535||t.protocol!="http"&&t.protocol!="https"&&t.protocol!="tcp"||(t.protocol=="http"||t.protocol=="https")&&(t.httpOption==null||t.httpOption.rewriteHostInTextBody==null||t.httpOption.customRequestHeaders==null||t.httpOption.customResponseHeaders==null||t.httpOption.bodyRewriteRules==null||t.httpOption.replaceAccessControlAllowOrigin==null))}};Lt(ea,"_instance");let Vt=ea;const ta=class ta{constructor(){}static get instance(){return ta._instance||(ta._instance=new ta),ta._instance}async updateAdminCert(t){let a=await fetch("/api/adminCert",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({certInfo:t})});if(a.status==401)throw new at;return await a.json()}async loadAdminCert(){let t=await fetch("/api/adminCert",{method:"GET",credentials:"same-origin"}),a=await t.json();if(t.status==401)throw new at;return a.certInfo}async loadExternalServerCert(t){let a=await fetch(`/api/externalCert/${t}`,{method:"GET",credentials:"same-origin"}),r=await a.json();if(a.status==401)throw new at;return r.certInfo}async updateExternalServerCert(t,a){let r=await fetch(`/api/externalCert/${t}`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({certInfo:a})});if(r.status==401)throw new at;return await r.json()}async deleteExternalServerCert(t){let a=await fetch(`/api/externalCert/${t}`,{method:"DELETE",credentials:"same-origin"});if(a.status==401)throw new at;return await a.json()}};Lt(ta,"_instance");let Or=ta;var Oe={options:{usePureJavaScript:!1}},$i={},lf=$i,ns={};$i.encode=function(e,t,a){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(a!==void 0&&typeof a!="number")throw new TypeError('"maxline" must be a number.');var r="";if(!(e instanceof Uint8Array))r=ff(e,t);else{var n=0,i=t.length,s=t.charAt(0),o=[0];for(n=0;n<e.length;++n){for(var f=0,l=e[n];f<o.length;++f)l+=o[f]<<8,o[f]=l%i,l=l/i|0;for(;l>0;)o.push(l%i),l=l/i|0}for(n=0;e[n]===0&&n<e.length-1;++n)r+=s;for(n=o.length-1;n>=0;--n)r+=t[o[n]]}if(a){var u=new RegExp(".{1,"+a+"}","g");r=r.match(u).join(`\r
`)}return r};$i.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var a=ns[t];if(!a){a=ns[t]=[];for(var r=0;r<t.length;++r)a[t.charCodeAt(r)]=r}e=e.replace(/\s/g,"");for(var n=t.length,i=t.charAt(0),s=[0],r=0;r<e.length;r++){var o=a[e.charCodeAt(r)];if(o===void 0)return;for(var f=0,l=o;f<s.length;++f)l+=s[f]*n,s[f]=l&255,l>>=8;for(;l>0;)s.push(l&255),l>>=8}for(var u=0;e[u]===i&&u<e.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function ff(e,t){var a=0,r=t.length,n=t.charAt(0),i=[0];for(a=0;a<e.length();++a){for(var s=0,o=e.at(a);s<i.length;++s)o+=i[s]<<8,i[s]=o%r,o=o/r|0;for(;o>0;)i.push(o%r),o=o/r|0}var f="";for(a=0;e.at(a)===0&&a<e.length()-1;++a)f+=n;for(a=i.length-1;a>=0;--a)f+=t[i[a]];return f}var is=Oe,ss=lf,F=is.util=is.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){F.nextTick=process.nextTick,typeof setImmediate=="function"?F.setImmediate=setImmediate:F.setImmediate=F.nextTick;return}if(typeof setImmediate=="function"){F.setImmediate=function(){return setImmediate.apply(void 0,arguments)},F.nextTick=function(o){return setImmediate(o)};return}if(F.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===e){f.stopPropagation();var l=t.slice();t.length=0,l.forEach(function(u){u()})}};var s=o,e="forge.setImmediate",t=[];F.setImmediate=function(f){t.push(f),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var a=Date.now(),r=!0,n=document.createElement("div"),t=[];new MutationObserver(function(){var f=t.slice();t.length=0,f.forEach(function(l){l()})}).observe(n,{attributes:!0});var i=F.setImmediate;F.setImmediate=function(f){Date.now()-a>15?(a=Date.now(),i(f)):(t.push(f),t.length===1&&n.setAttribute("a",r=!r))}}F.nextTick=F.setImmediate})();F.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;F.globalScope=function(){return F.isNodejs?Ue:typeof self>"u"?window:self}();F.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};F.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};F.isArrayBufferView=function(e){return e&&F.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Xa(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}F.ByteBuffer=e0;function e0(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(F.isArrayBuffer(e)||F.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var a=0;a<t.length;++a)this.putByte(t[a])}}else(e instanceof e0||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}F.ByteStringBuffer=e0;var uf=4096;F.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>uf&&(this.data.substr(0,1),this._constructedStringLength=0)};F.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};F.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};F.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};F.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var a=this.data;t>0;)t&1&&(a+=e),t>>>=1,t>0&&(e+=e);return this.data=a,this._optimizeConstructedString(t),this};F.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};F.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(F.encodeUtf8(e))};F.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};F.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};F.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};F.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};F.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};F.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};F.ByteStringBuffer.prototype.putInt=function(e,t){Xa(t);var a="";do t-=8,a+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(a)};F.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};F.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};F.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};F.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};F.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};F.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};F.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};F.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};F.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};F.ByteStringBuffer.prototype.getInt=function(e){Xa(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};F.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),a=2<<e-2;return t>=a&&(t-=a<<1),t};F.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};F.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};F.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};F.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};F.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};F.ByteStringBuffer.prototype.copy=function(){var e=F.createBuffer(this.data);return e.read=this.read,e};F.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};F.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};F.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};F.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var a=this.data.charCodeAt(t);a<16&&(e+="0"),e+=a.toString(16)}return e};F.ByteStringBuffer.prototype.toString=function(){return F.decodeUtf8(this.bytes())};function cf(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var a=F.isArrayBuffer(e),r=F.isArrayBufferView(e);if(a||r){a?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}F.DataBuffer=cf;F.DataBuffer.prototype.length=function(){return this.write-this.read};F.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};F.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var a=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(a),this.data=new DataView(r.buffer),this};F.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};F.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var a=0;a<t;++a)this.data.setUint8(e);return this};F.DataBuffer.prototype.putBytes=function(e,t){if(F.isArrayBufferView(e)){var a=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r=a.byteLength-a.byteOffset;this.accommodate(r);var n=new Uint8Array(this.data.buffer,this.write);return n.set(a),this.write+=r,this}if(F.isArrayBuffer(e)){var a=new Uint8Array(e);this.accommodate(a.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(a,this.write),this.write+=a.byteLength,this}if(e instanceof F.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&F.isArrayBufferView(e.data)){var a=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(a.byteLength);var n=new Uint8Array(e.data.byteLength,this.write);return n.set(a),this.write+=a.byteLength,this}if(e instanceof F.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var i;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=F.binary.hex.decode(e,i,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),i=new Uint8Array(this.data.buffer,this.write),this.write+=F.binary.base64.decode(e,i,this.write),this;if(t==="utf8"&&(e=F.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=F.binary.raw.decode(i),this;if(t==="utf16")return this.accommodate(e.length*2),i=new Uint16Array(this.data.buffer,this.write),this.write+=F.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};F.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};F.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};F.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};F.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};F.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};F.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};F.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};F.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};F.DataBuffer.prototype.putInt=function(e,t){Xa(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};F.DataBuffer.prototype.putSignedInt=function(e,t){return Xa(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};F.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};F.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};F.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};F.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};F.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};F.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};F.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};F.DataBuffer.prototype.getInt=function(e){Xa(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};F.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),a=2<<e-2;return t>=a&&(t-=a<<1),t};F.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};F.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};F.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};F.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};F.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};F.DataBuffer.prototype.copy=function(){return new F.DataBuffer(this)};F.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};F.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};F.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};F.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var a=this.data.getUint8(t);a<16&&(e+="0"),e+=a.toString(16)}return e};F.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return F.binary.raw.encode(t);if(e==="hex")return F.binary.hex.encode(t);if(e==="base64")return F.binary.base64.encode(t);if(e==="utf8")return F.text.utf8.decode(t);if(e==="utf16")return F.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};F.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=F.encodeUtf8(e)),new F.ByteBuffer(e)};F.fillString=function(e,t){for(var a="";t>0;)t&1&&(a+=e),t>>>=1,t>0&&(e+=e);return a};F.xorBytes=function(e,t,a){for(var r="",n="",i="",s=0,o=0;a>0;--a,++s)n=e.charCodeAt(s)^t.charCodeAt(s),o>=10&&(r+=i,i="",o=0),i+=String.fromCharCode(n),++o;return r+=i,r};F.hexToBytes=function(e){var t="",a=0;for(e.length&!0&&(a=1,t+=String.fromCharCode(parseInt(e[0],16)));a<e.length;a+=2)t+=String.fromCharCode(parseInt(e.substr(a,2),16));return t};F.bytesToHex=function(e){return F.createBuffer(e).toHex()};F.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var Vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Fr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],oo="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";F.encode64=function(e,t){for(var a="",r="",n,i,s,o=0;o<e.length;)n=e.charCodeAt(o++),i=e.charCodeAt(o++),s=e.charCodeAt(o++),a+=Vr.charAt(n>>2),a+=Vr.charAt((n&3)<<4|i>>4),isNaN(i)?a+="==":(a+=Vr.charAt((i&15)<<2|s>>6),a+=isNaN(s)?"=":Vr.charAt(s&63)),t&&a.length>t&&(r+=a.substr(0,t)+`\r
`,a=a.substr(t));return r+=a,r};F.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",a,r,n,i,s=0;s<e.length;)a=Fr[e.charCodeAt(s++)-43],r=Fr[e.charCodeAt(s++)-43],n=Fr[e.charCodeAt(s++)-43],i=Fr[e.charCodeAt(s++)-43],t+=String.fromCharCode(a<<2|r>>4),n!==64&&(t+=String.fromCharCode((r&15)<<4|n>>2),i!==64&&(t+=String.fromCharCode((n&3)<<6|i)));return t};F.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};F.decodeUtf8=function(e){return decodeURIComponent(escape(e))};F.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:ss.encode,decode:ss.decode}};F.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};F.binary.raw.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(e.length)),a=a||0;for(var n=a,i=0;i<e.length;++i)r[n++]=e.charCodeAt(i);return t?n-a:r};F.binary.hex.encode=F.bytesToHex;F.binary.hex.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2))),a=a||0;var n=0,i=a;for(e.length&1&&(n=1,r[i++]=parseInt(e[0],16));n<e.length;n+=2)r[i++]=parseInt(e.substr(n,2),16);return t?i-a:r};F.binary.base64.encode=function(e,t){for(var a="",r="",n,i,s,o=0;o<e.byteLength;)n=e[o++],i=e[o++],s=e[o++],a+=Vr.charAt(n>>2),a+=Vr.charAt((n&3)<<4|i>>4),isNaN(i)?a+="==":(a+=Vr.charAt((i&15)<<2|s>>6),a+=isNaN(s)?"=":Vr.charAt(s&63)),t&&a.length>t&&(r+=a.substr(0,t)+`\r
`,a=a.substr(t));return r+=a,r};F.binary.base64.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),a=a||0;for(var n,i,s,o,f=0,l=a;f<e.length;)n=Fr[e.charCodeAt(f++)-43],i=Fr[e.charCodeAt(f++)-43],s=Fr[e.charCodeAt(f++)-43],o=Fr[e.charCodeAt(f++)-43],r[l++]=n<<2|i>>4,s!==64&&(r[l++]=(i&15)<<4|s>>2,o!==64&&(r[l++]=(s&3)<<6|o));return t?l-a:r.subarray(0,l)};F.binary.base58.encode=function(e,t){return F.binary.baseN.encode(e,oo,t)};F.binary.base58.decode=function(e,t){return F.binary.baseN.decode(e,oo,t)};F.text={utf8:{},utf16:{}};F.text.utf8.encode=function(e,t,a){e=F.encodeUtf8(e);var r=t;r||(r=new Uint8Array(e.length)),a=a||0;for(var n=a,i=0;i<e.length;++i)r[n++]=e.charCodeAt(i);return t?n-a:r};F.text.utf8.decode=function(e){return F.decodeUtf8(String.fromCharCode.apply(null,e))};F.text.utf16.encode=function(e,t,a){var r=t;r||(r=new Uint8Array(e.length*2));var n=new Uint16Array(r.buffer);a=a||0;for(var i=a,s=a,o=0;o<e.length;++o)n[s++]=e.charCodeAt(o),i+=2;return t?i-a:r};F.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};F.deflate=function(e,t,a){if(t=F.decode64(e.deflate(F.encode64(t)).rval),a){var r=2,n=t.charCodeAt(1);n&32&&(r=6),t=t.substring(r,t.length-4)}return t};F.inflate=function(e,t,a){var r=e.inflate(F.encode64(t)).rval;return r===null?null:F.decode64(r)};var t0=function(e,t,a){if(!e)throw new Error("WebStorage not available.");var r;if(a===null?r=e.removeItem(t):(a=F.encode64(JSON.stringify(a)),r=e.setItem(t,a)),typeof r<"u"&&r.rval!==!0){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}},r0=function(e,t){if(!e)throw new Error("WebStorage not available.");var a=e.getItem(t);if(e.init)if(a.rval===null){if(a.error){var r=new Error(a.error.message);throw r.id=a.error.id,r.name=a.error.name,r}a=null}else a=a.rval;return a!==null&&(a=JSON.parse(F.decode64(a))),a},df=function(e,t,a,r){var n=r0(e,t);n===null&&(n={}),n[a]=r,t0(e,t,n)},hf=function(e,t,a){var r=r0(e,t);return r!==null&&(r=a in r?r[a]:null),r},pf=function(e,t,a){var r=r0(e,t);if(r!==null&&a in r){delete r[a];var n=!0;for(var i in r){n=!1;break}n&&(r=null),t0(e,t,r)}},vf=function(e,t){t0(e,t,null)},wn=function(e,t,a){var r=null;typeof a>"u"&&(a=["web","flash"]);var n,i=!1,s=null;for(var o in a){n=a[o];try{if(n==="flash"||n==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");r=e.apply(this,t),i=n==="flash"}(n==="web"||n==="both")&&(t[0]=localStorage,r=e.apply(this,t),i=!0)}catch(f){s=f}if(i)break}if(!i)throw s;return r};F.setItem=function(e,t,a,r,n){wn(df,arguments,n)};F.getItem=function(e,t,a,r){return wn(hf,arguments,r)};F.removeItem=function(e,t,a,r){wn(pf,arguments,r)};F.clearItems=function(e,t,a){wn(vf,arguments,a)};F.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};F.format=function(e){for(var t=/%./g,a,r,n=0,i=[],s=0;a=t.exec(e);){r=e.substring(s,t.lastIndex-2),r.length>0&&i.push(r),s=t.lastIndex;var o=a[0][1];switch(o){case"s":case"o":n<arguments.length?i.push(arguments[n+++1]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+o+"?>")}}return i.push(e.substring(s)),i.join("")};F.formatNumber=function(e,t,a,r){var n=e,i=isNaN(t=Math.abs(t))?2:t,s=a===void 0?",":a,o=r===void 0?".":r,f=n<0?"-":"",l=parseInt(n=Math.abs(+n||0).toFixed(i),10)+"",u=l.length>3?l.length%3:0;return f+(u?l.substr(0,u)+o:"")+l.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(i?s+Math.abs(n-l).toFixed(i).slice(2):"")};F.formatSize=function(e){return e>=1073741824?e=F.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=F.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=F.formatNumber(e/1024,0)+" KiB":e=F.formatNumber(e,0)+" bytes",e};F.bytesFromIP=function(e){return e.indexOf(".")!==-1?F.bytesFromIPv4(e):e.indexOf(":")!==-1?F.bytesFromIPv6(e):null};F.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=F.createBuffer(),a=0;a<e.length;++a){var r=parseInt(e[a],10);if(isNaN(r))return null;t.putByte(r)}return t.getBytes()};F.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(s){return s.length===0&&++t,!0});for(var a=(8-e.length+t)*2,r=F.createBuffer(),n=0;n<8;++n){if(!e[n]||e[n].length===0){r.fillWithByte(0,a),a=0;continue}var i=F.hexToBytes(e[n]);i.length<2&&r.putByte(0),r.putBytes(i)}return r.getBytes()};F.bytesToIP=function(e){return e.length===4?F.bytesToIPv4(e):e.length===16?F.bytesToIPv6(e):null};F.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],a=0;a<e.length;++a)t.push(e.charCodeAt(a));return t.join(".")};F.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],a=[],r=0,n=0;n<e.length;n+=2){for(var i=F.bytesToHex(e[n]+e[n+1]);i[0]==="0"&&i!=="0";)i=i.substr(1);if(i==="0"){var s=a[a.length-1],o=t.length;!s||o!==s.end+1?a.push({start:o,end:o}):(s.end=o,s.end-s.start>a[r].end-a[r].start&&(r=a.length-1))}t.push(i)}if(a.length>0){var f=a[r];f.end-f.start>0&&(t.splice(f.start,f.end-f.start+1,""),f.start===0&&t.unshift(""),f.end===7&&t.push(""))}return t.join(":")};F.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in F&&!e.update)return t(null,F.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return F.cores=navigator.hardwareConcurrency,t(null,F.cores);if(typeof Worker>"u")return F.cores=1,t(null,F.cores);if(typeof Blob>"u")return F.cores=2,t(null,F.cores);var a=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(s){var o=Date.now(),f=o+4;self.postMessage({st:o,et:f})})}).toString(),")()"],{type:"application/javascript"}));r([],5,16);function r(s,o,f){if(o===0){var l=Math.floor(s.reduce(function(u,c){return u+c},0)/s.length);return F.cores=Math.max(1,l),URL.revokeObjectURL(a),t(null,F.cores)}n(f,function(u,c){s.push(i(f,c)),r(s,o-1,f)})}function n(s,o){for(var f=[],l=[],u=0;u<s;++u){var c=new Worker(a);c.addEventListener("message",function(d){if(l.push(d.data),l.length===s){for(var h=0;h<s;++h)f[h].terminate();o(null,l)}}),f.push(c)}for(var u=0;u<s;++u)f[u].postMessage(u)}function i(s,o){for(var f=[],l=0;l<s;++l)for(var u=o[l],c=f[l]=[],d=0;d<s;++d)if(l!==d){var h=o[d];(u.st>h.st&&u.st<h.et||h.st>u.st&&h.st<u.et)&&c.push(d)}return f.reduce(function(p,v){return Math.max(p,v.length)},0)}};var At=Oe;At.cipher=At.cipher||{};At.cipher.algorithms=At.cipher.algorithms||{};At.cipher.createCipher=function(e,t){var a=e;if(typeof a=="string"&&(a=At.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+e);return new At.cipher.BlockCipher({algorithm:a,key:t,decrypt:!1})};At.cipher.createDecipher=function(e,t){var a=e;if(typeof a=="string"&&(a=At.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+e);return new At.cipher.BlockCipher({algorithm:a,key:t,decrypt:!0})};At.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),At.cipher.algorithms[e]=t};At.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in At.cipher.algorithms?At.cipher.algorithms[e]:null};var a0=At.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};a0.prototype.start=function(e){e=e||{};var t={};for(var a in e)t[a]=e[a];t.decrypt=this._decrypt,this._finish=!1,this._input=At.util.createBuffer(),this.output=e.output||At.util.createBuffer(),this.mode.start(t)};a0.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};a0.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(a){return e(this.blockSize,a,!1)},this.mode.unpad=function(a){return e(this.blockSize,a,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))};var Tt=Oe;Tt.cipher=Tt.cipher||{};var He=Tt.cipher.modes=Tt.cipher.modes||{};He.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};He.ecb.prototype.start=function(e){};He.ecb.prototype.encrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};He.ecb.prototype.decrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};He.ecb.prototype.pad=function(e,t){var a=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(a,a),!0};He.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var a=e.length(),r=e.at(a-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};He.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};He.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=kn(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};He.cbc.prototype.encrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r]);this._prev=this._outBlock};He.cbc.prototype.decrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)};He.cbc.prototype.pad=function(e,t){var a=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(a,a),!0};He.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var a=e.length(),r=e.at(a-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};He.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Tt.util.createBuffer(),this._partialBytes=0};He.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=kn(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};He.cfb.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32()^this._outBlock[n],t.putInt32(this._inBlock[n]);return}var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=e.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(i>0)e.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};He.cfb.prototype.decrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32(),t.putInt32(this._inBlock[n]^this._outBlock[n]);return}var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(i>0)e.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};He.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Tt.util.createBuffer(),this._partialBytes=0};He.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=kn(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};He.ofb.prototype.encrypt=function(e,t,a){var r=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)t.putInt32(e.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(e.getInt32()^this._outBlock[n]);if(i>0)e.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};He.ofb.prototype.decrypt=He.ofb.prototype.encrypt;He.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Tt.util.createBuffer(),this._partialBytes=0};He.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=kn(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};He.ctr.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize)for(var n=0;n<this._ints;++n)t.putInt32(e.getInt32()^this._outBlock[n]);else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(e.getInt32()^this._outBlock[n]);if(i>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}Nn(this._inBlock)};He.ctr.prototype.decrypt=He.ctr.prototype.encrypt;He.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Tt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};He.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Tt.util.createBuffer(e.iv);this._cipherLength=0;var a;if("additionalData"in e?a=Tt.util.createBuffer(e.additionalData):a=Tt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Tt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var r=t.length();if(r===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ni(r*8)))}this._inBlock=this._j0.slice(0),Nn(this._inBlock),this._partialBytes=0,a=Tt.util.createBuffer(a),this._aDataLength=Ni(a.length()*8);var n=a.length()%this.blockSize;for(n&&a.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];a.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[a.getInt32(),a.getInt32(),a.getInt32(),a.getInt32()])};He.gcm.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]^=e.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(e.getInt32()^this._outBlock[n]);if(i<=0||a){if(a){var s=r%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Nn(this._inBlock)};He.gcm.prototype.decrypt=function(e,t,a){var r=e.length();if(r<this.blockSize&&!(a&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Nn(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]^this._hashBlock[n]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize};He.gcm.prototype.afterFinish=function(e,t){var a=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Tt.util.createBuffer();var r=this._aDataLength.concat(Ni(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,r);var n=[];this.cipher.encrypt(this._j0,n);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^n[i]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(a=!1),a};He.gcm.prototype.multiply=function(e,t){for(var a=[0,0,0,0],r=t.slice(0),n=0;n<128;++n){var i=e[n/32|0]&1<<31-n%32;i&&(a[0]^=r[0],a[1]^=r[1],a[2]^=r[2],a[3]^=r[3]),this.pow(r,r)}return a};He.gcm.prototype.pow=function(e,t){for(var a=e[3]&1,r=3;r>0;--r)t[r]=e[r]>>>1|(e[r-1]&1)<<31;t[0]=e[0]>>>1,a&&(t[0]^=this._R)};He.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],a=0;a<32;++a){var r=a/8|0,n=e[r]>>>(7-a%8)*4&15,i=this._m[a][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t};He.gcm.prototype.ghash=function(e,t,a){return t[0]^=a[0],t[1]^=a[1],t[2]^=a[2],t[3]^=a[3],this.tableMultiply(t)};He.gcm.prototype.generateHashTable=function(e,t){for(var a=8/t,r=4*a,n=16*a,i=new Array(n),s=0;s<n;++s){var o=[0,0,0,0],f=s/r|0,l=(r-1-s%r)*t;o[f]=1<<t-1<<l,i[s]=this.generateSubHashTable(this.multiply(o,e),t)}return i};He.gcm.prototype.generateSubHashTable=function(e,t){var a=1<<t,r=a>>>1,n=new Array(a);n[r]=e.slice(0);for(var i=r>>>1;i>0;)this.pow(n[2*i],n[i]=[]),i>>=1;for(i=2;i<r;){for(var s=1;s<i;++s){var o=n[i],f=n[s];n[i+s]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}i*=2}for(n[0]=[0,0,0,0],i=r+1;i<a;++i){var l=n[i^r];n[i]=[e[0]^l[0],e[1]^l[1],e[2]^l[2],e[3]^l[3]]}return n};function kn(e,t){if(typeof e=="string"&&(e=Tt.util.createBuffer(e)),Tt.util.isArray(e)&&e.length>4){var a=e;e=Tt.util.createBuffer();for(var r=0;r<a.length;++r)e.putByte(a[r])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Tt.util.isArray(e)){for(var n=[],i=t/4,r=0;r<i;++r)n.push(e.getInt32());e=n}return e}function Nn(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Ni(e){return[e/4294967296|0,e&4294967295]}var nt=Oe;nt.aes=nt.aes||{};nt.aes.startEncrypting=function(e,t,a,r){var n=Rn({key:e,output:a,decrypt:!1,mode:r});return n.start(t),n};nt.aes.createEncryptionCipher=function(e,t){return Rn({key:e,output:null,decrypt:!1,mode:t})};nt.aes.startDecrypting=function(e,t,a,r){var n=Rn({key:e,output:a,decrypt:!0,mode:r});return n.start(t),n};nt.aes.createDecryptionCipher=function(e,t){return Rn({key:e,output:null,decrypt:!0,mode:t})};nt.aes.Algorithm=function(e,t){n0||fo();var a=this;a.name=e,a.mode=new t({blockSize:16,cipher:{encrypt:function(r,n){return Li(a._w,r,n,!1)},decrypt:function(r,n){return Li(a._w,r,n,!0)}}}),a._init=!1};nt.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,a;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=nt.util.createBuffer(t);else if(nt.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){a=t,t=nt.util.createBuffer();for(var r=0;r<a.length;++r)t.putByte(a[r])}if(!nt.util.isArray(t)){a=t,t=[];var n=a.length();if(n===16||n===24||n===32){n=n>>>2;for(var r=0;r<n;++r)t.push(a.getInt32())}}if(!nt.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var i=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(i)!==-1;this._w=uo(t,e.decrypt&&!s),this._init=!0}};nt.aes._expandKey=function(e,t){return n0||fo(),uo(e,t)};nt.aes._updateBlock=Li;Ta("AES-ECB",nt.cipher.modes.ecb);Ta("AES-CBC",nt.cipher.modes.cbc);Ta("AES-CFB",nt.cipher.modes.cfb);Ta("AES-OFB",nt.cipher.modes.ofb);Ta("AES-CTR",nt.cipher.modes.ctr);Ta("AES-GCM",nt.cipher.modes.gcm);function Ta(e,t){var a=function(){return new nt.aes.Algorithm(e,t)};nt.cipher.registerAlgorithm(e,a)}var n0=!1,da=4,Pt,Ri,lo,ia,lr;function fo(){n0=!0,lo=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;Pt=new Array(256),Ri=new Array(256),ia=new Array(4),lr=new Array(4);for(var t=0;t<4;++t)ia[t]=new Array(256),lr[t]=new Array(256);for(var a=0,r=0,n,i,s,o,f,l,u,t=0;t<256;++t){o=r^r<<1^r<<2^r<<3^r<<4,o=o>>8^o&255^99,Pt[a]=o,Ri[o]=a,f=e[o],n=e[a],i=e[n],s=e[i],l=f<<24^o<<16^o<<8^(o^f),u=(n^i^s)<<24^(a^s)<<16^(a^i^s)<<8^(a^n^s);for(var c=0;c<4;++c)ia[c][a]=l,lr[c][o]=u,l=l<<24|l>>>8,u=u<<24|u>>>8;a===0?a=r=1:(a=n^e[e[e[n^s]]],r^=e[e[r]])}}function uo(e,t){for(var a=e.slice(0),r,n=1,i=a.length,s=i+6+1,o=da*s,f=i;f<o;++f)r=a[f-1],f%i===0?(r=Pt[r>>>16&255]<<24^Pt[r>>>8&255]<<16^Pt[r&255]<<8^Pt[r>>>24]^lo[n]<<24,n++):i>6&&f%i===4&&(r=Pt[r>>>24]<<24^Pt[r>>>16&255]<<16^Pt[r>>>8&255]<<8^Pt[r&255]),a[f]=a[f-i]^r;if(t){var l,u=lr[0],c=lr[1],d=lr[2],h=lr[3],p=a.slice(0);o=a.length;for(var f=0,v=o-da;f<o;f+=da,v-=da)if(f===0||f===o-da)p[f]=a[v],p[f+1]=a[v+3],p[f+2]=a[v+2],p[f+3]=a[v+1];else for(var g=0;g<da;++g)l=a[v+g],p[f+(3&-g)]=u[Pt[l>>>24]]^c[Pt[l>>>16&255]]^d[Pt[l>>>8&255]]^h[Pt[l&255]];a=p}return a}function Li(e,t,a,r){var n=e.length/4-1,i,s,o,f,l;r?(i=lr[0],s=lr[1],o=lr[2],f=lr[3],l=Ri):(i=ia[0],s=ia[1],o=ia[2],f=ia[3],l=Pt);var u,c,d,h,p,v,g;u=t[0]^e[0],c=t[r?3:1]^e[1],d=t[2]^e[2],h=t[r?1:3]^e[3];for(var C=3,x=1;x<n;++x)p=i[u>>>24]^s[c>>>16&255]^o[d>>>8&255]^f[h&255]^e[++C],v=i[c>>>24]^s[d>>>16&255]^o[h>>>8&255]^f[u&255]^e[++C],g=i[d>>>24]^s[h>>>16&255]^o[u>>>8&255]^f[c&255]^e[++C],h=i[h>>>24]^s[u>>>16&255]^o[c>>>8&255]^f[d&255]^e[++C],u=p,c=v,d=g;a[0]=l[u>>>24]<<24^l[c>>>16&255]<<16^l[d>>>8&255]<<8^l[h&255]^e[++C],a[r?3:1]=l[c>>>24]<<24^l[d>>>16&255]<<16^l[h>>>8&255]<<8^l[u&255]^e[++C],a[2]=l[d>>>24]<<24^l[h>>>16&255]<<16^l[u>>>8&255]<<8^l[c&255]^e[++C],a[r?1:3]=l[h>>>24]<<24^l[u>>>16&255]<<16^l[c>>>8&255]<<8^l[d&255]^e[++C]}function Rn(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),a="AES-"+t,r;e.decrypt?r=nt.cipher.createDecipher(a,e.key):r=nt.cipher.createCipher(a,e.key);var n=r.start;return r.start=function(i,s){var o=null;s instanceof nt.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=i,n.call(r,s)},r}var Ma=Oe;Ma.pki=Ma.pki||{};var Di=Ma.pki.oids=Ma.oids=Ma.oids||{};function re(e,t){Di[e]=t,Di[t]=e}function Je(e,t){Di[e]=t}re("1.2.840.113549.1.1.1","rsaEncryption");re("1.2.840.113549.1.1.4","md5WithRSAEncryption");re("1.2.840.113549.1.1.5","sha1WithRSAEncryption");re("1.2.840.113549.1.1.7","RSAES-OAEP");re("1.2.840.113549.1.1.8","mgf1");re("1.2.840.113549.1.1.9","pSpecified");re("1.2.840.113549.1.1.10","RSASSA-PSS");re("1.2.840.113549.1.1.11","sha256WithRSAEncryption");re("1.2.840.113549.1.1.12","sha384WithRSAEncryption");re("1.2.840.113549.1.1.13","sha512WithRSAEncryption");re("1.3.101.112","EdDSA25519");re("1.2.840.10040.4.3","dsa-with-sha1");re("1.3.14.3.2.7","desCBC");re("1.3.14.3.2.26","sha1");re("1.3.14.3.2.29","sha1WithRSASignature");re("2.16.840.1.101.3.4.2.1","sha256");re("2.16.840.1.101.3.4.2.2","sha384");re("2.16.840.1.101.3.4.2.3","sha512");re("2.16.840.1.101.3.4.2.4","sha224");re("2.16.840.1.101.3.4.2.5","sha512-224");re("2.16.840.1.101.3.4.2.6","sha512-256");re("1.2.840.113549.2.2","md2");re("1.2.840.113549.2.5","md5");re("1.2.840.113549.1.7.1","data");re("1.2.840.113549.1.7.2","signedData");re("1.2.840.113549.1.7.3","envelopedData");re("1.2.840.113549.1.7.4","signedAndEnvelopedData");re("1.2.840.113549.1.7.5","digestedData");re("1.2.840.113549.1.7.6","encryptedData");re("1.2.840.113549.1.9.1","emailAddress");re("1.2.840.113549.1.9.2","unstructuredName");re("1.2.840.113549.1.9.3","contentType");re("1.2.840.113549.1.9.4","messageDigest");re("1.2.840.113549.1.9.5","signingTime");re("1.2.840.113549.1.9.6","counterSignature");re("1.2.840.113549.1.9.7","challengePassword");re("1.2.840.113549.1.9.8","unstructuredAddress");re("1.2.840.113549.1.9.14","extensionRequest");re("1.2.840.113549.1.9.20","friendlyName");re("1.2.840.113549.1.9.21","localKeyId");re("1.2.840.113549.1.9.22.1","x509Certificate");re("1.2.840.113549.1.12.10.1.1","keyBag");re("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");re("1.2.840.113549.1.12.10.1.3","certBag");re("1.2.840.113549.1.12.10.1.4","crlBag");re("1.2.840.113549.1.12.10.1.5","secretBag");re("1.2.840.113549.1.12.10.1.6","safeContentsBag");re("1.2.840.113549.1.5.13","pkcs5PBES2");re("1.2.840.113549.1.5.12","pkcs5PBKDF2");re("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");re("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");re("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");re("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");re("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");re("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");re("1.2.840.113549.2.7","hmacWithSHA1");re("1.2.840.113549.2.8","hmacWithSHA224");re("1.2.840.113549.2.9","hmacWithSHA256");re("1.2.840.113549.2.10","hmacWithSHA384");re("1.2.840.113549.2.11","hmacWithSHA512");re("1.2.840.113549.3.7","des-EDE3-CBC");re("2.16.840.1.101.3.4.1.2","aes128-CBC");re("2.16.840.1.101.3.4.1.22","aes192-CBC");re("2.16.840.1.101.3.4.1.42","aes256-CBC");re("2.5.4.3","commonName");re("2.5.4.4","surname");re("2.5.4.5","serialNumber");re("2.5.4.6","countryName");re("2.5.4.7","localityName");re("2.5.4.8","stateOrProvinceName");re("2.5.4.9","streetAddress");re("2.5.4.10","organizationName");re("2.5.4.11","organizationalUnitName");re("2.5.4.12","title");re("2.5.4.13","description");re("2.5.4.15","businessCategory");re("2.5.4.17","postalCode");re("2.5.4.42","givenName");re("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");re("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");re("2.16.840.1.113730.1.1","nsCertType");re("2.16.840.1.113730.1.13","nsComment");Je("2.5.29.1","authorityKeyIdentifier");Je("2.5.29.2","keyAttributes");Je("2.5.29.3","certificatePolicies");Je("2.5.29.4","keyUsageRestriction");Je("2.5.29.5","policyMapping");Je("2.5.29.6","subtreesConstraint");Je("2.5.29.7","subjectAltName");Je("2.5.29.8","issuerAltName");Je("2.5.29.9","subjectDirectoryAttributes");Je("2.5.29.10","basicConstraints");Je("2.5.29.11","nameConstraints");Je("2.5.29.12","policyConstraints");Je("2.5.29.13","basicConstraints");re("2.5.29.14","subjectKeyIdentifier");re("2.5.29.15","keyUsage");Je("2.5.29.16","privateKeyUsagePeriod");re("2.5.29.17","subjectAltName");re("2.5.29.18","issuerAltName");re("2.5.29.19","basicConstraints");Je("2.5.29.20","cRLNumber");Je("2.5.29.21","cRLReason");Je("2.5.29.22","expirationDate");Je("2.5.29.23","instructionCode");Je("2.5.29.24","invalidityDate");Je("2.5.29.25","cRLDistributionPoints");Je("2.5.29.26","issuingDistributionPoint");Je("2.5.29.27","deltaCRLIndicator");Je("2.5.29.28","issuingDistributionPoint");Je("2.5.29.29","certificateIssuer");Je("2.5.29.30","nameConstraints");re("2.5.29.31","cRLDistributionPoints");re("2.5.29.32","certificatePolicies");Je("2.5.29.33","policyMappings");Je("2.5.29.34","policyConstraints");re("2.5.29.35","authorityKeyIdentifier");Je("2.5.29.36","policyConstraints");re("2.5.29.37","extKeyUsage");Je("2.5.29.46","freshestCRL");Je("2.5.29.54","inhibitAnyPolicy");re("1.3.6.1.4.1.11129.2.4.2","timestampList");re("1.3.6.1.5.5.7.1.1","authorityInfoAccess");re("1.3.6.1.5.5.7.3.1","serverAuth");re("1.3.6.1.5.5.7.3.2","clientAuth");re("1.3.6.1.5.5.7.3.3","codeSigning");re("1.3.6.1.5.5.7.3.4","emailProtection");re("1.3.6.1.5.5.7.3.8","timeStamping");var it=Oe,ue=it.asn1=it.asn1||{};ue.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};ue.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};ue.create=function(e,t,a,r,n){if(it.util.isArray(r)){for(var i=[],s=0;s<r.length;++s)r[s]!==void 0&&i.push(r[s]);r=i}var o={tagClass:e,type:t,constructed:a,composed:a||it.util.isArray(r),value:r};return n&&"bitStringContents"in n&&(o.bitStringContents=n.bitStringContents,o.original=ue.copy(o)),o};ue.copy=function(e,t){var a;if(it.util.isArray(e)){a=[];for(var r=0;r<e.length;++r)a.push(ue.copy(e[r],t));return a}return typeof e=="string"?e:(a={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:ue.copy(e.value,t)},t&&!t.excludeBitStringContents&&(a.bitStringContents=e.bitStringContents),a)};ue.equals=function(e,t,a){if(it.util.isArray(e)){if(!it.util.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!ue.equals(e[r],t[r]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var n=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&ue.equals(e.value,t.value);return a&&a.includeBitStringContents&&(n=n&&e.bitStringContents===t.bitStringContents),n};ue.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var a,r=t&128;return r?a=e.getInt((t&127)<<3):a=t,a}};function Oa(e,t,a){if(a>t){var r=new Error("Too few bytes to parse DER.");throw r.available=e.length(),r.remaining=t,r.requested=a,r}}var gf=function(e,t){var a=e.getByte();if(t--,a!==128){var r,n=a&128;if(!n)r=a;else{var i=a&127;Oa(e,t,i),r=e.getInt(i<<3)}if(r<0)throw new Error("Negative length: "+r);return r}};ue.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=it.util.createBuffer(e));var a=e.length(),r=cn(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var n=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw n.byteCount=a,n.remaining=e.length(),n}return r};function cn(e,t,a,r){var n;Oa(e,t,2);var i=e.getByte();t--;var s=i&192,o=i&31;n=e.length();var f=gf(e,t);if(t-=n-e.length(),f!==void 0&&f>t){if(r.strict){var l=new Error("Too few bytes to read ASN.1 value.");throw l.available=e.length(),l.remaining=t,l.requested=f,l}f=t}var u,c,d=(i&32)===32;if(d)if(u=[],f===void 0)for(;;){if(Oa(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}n=e.length(),u.push(cn(e,t,a+1,r)),t-=n-e.length()}else for(;f>0;)n=e.length(),u.push(cn(e,f,a+1,r)),t-=n-e.length(),f-=n-e.length();if(u===void 0&&s===ue.Class.UNIVERSAL&&o===ue.Type.BITSTRING&&(c=e.bytes(f)),u===void 0&&r.decodeBitStrings&&s===ue.Class.UNIVERSAL&&o===ue.Type.BITSTRING&&f>1){var h=e.read,p=t,v=0;if(o===ue.Type.BITSTRING&&(Oa(e,t,1),v=e.getByte(),t--),v===0)try{n=e.length();var g={strict:!0,decodeBitStrings:!0},C=cn(e,t,a+1,g),x=n-e.length();t-=x,o==ue.Type.BITSTRING&&x++;var y=C.tagClass;x===f&&(y===ue.Class.UNIVERSAL||y===ue.Class.CONTEXT_SPECIFIC)&&(u=[C])}catch{}u===void 0&&(e.read=h,t=p)}if(u===void 0){if(f===void 0){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(o===ue.Type.BMPSTRING)for(u="";f>0;f-=2)Oa(e,t,2),u+=String.fromCharCode(e.getInt16()),t-=2;else u=e.getBytes(f),t-=f}var S=c===void 0?null:{bitStringContents:c};return ue.create(s,o,d,u,S)}ue.toDer=function(e){var t=it.util.createBuffer(),a=e.tagClass|e.type,r=it.util.createBuffer(),n=!1;if("bitStringContents"in e&&(n=!0,e.original&&(n=ue.equals(e,e.original))),n)r.putBytes(e.bitStringContents);else if(e.composed){e.constructed?a|=32:r.putByte(0);for(var i=0;i<e.value.length;++i)e.value[i]!==void 0&&r.putBuffer(ue.toDer(e.value[i]))}else if(e.type===ue.Type.BMPSTRING)for(var i=0;i<e.value.length;++i)r.putInt16(e.value.charCodeAt(i));else e.type===ue.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?r.putBytes(e.value.substr(1)):r.putBytes(e.value);if(t.putByte(a),r.length()<=127)t.putByte(r.length()&127);else{var s=r.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);t.putByte(o.length|128);for(var i=o.length-1;i>=0;--i)t.putByte(o.charCodeAt(i))}return t.putBuffer(r),t};ue.oidToDer=function(e){var t=e.split("."),a=it.util.createBuffer();a.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var r,n,i,s,o=2;o<t.length;++o){r=!0,n=[],i=parseInt(t[o],10);do s=i&127,i=i>>>7,r||(s|=128),n.push(s),r=!1;while(i>0);for(var f=n.length-1;f>=0;--f)a.putByte(n[f])}return a};ue.derToOid=function(e){var t;typeof e=="string"&&(e=it.util.createBuffer(e));var a=e.getByte();t=Math.floor(a/40)+"."+a%40;for(var r=0;e.length()>0;)a=e.getByte(),r=r<<7,a&128?r+=a&127:(t+="."+(r+a),r=0);return t};ue.utcTimeToDate=function(e){var t=new Date,a=parseInt(e.substr(0,2),10);a=a>=50?1900+a:2e3+a;var r=parseInt(e.substr(2,2),10)-1,n=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var f=e.charAt(10),l=10;f!=="+"&&f!=="-"&&(o=parseInt(e.substr(10,2),10),l+=2)}if(t.setUTCFullYear(a,r,n),t.setUTCHours(i,s,o,0),l&&(f=e.charAt(l),f==="+"||f==="-")){var u=parseInt(e.substr(l+1,2),10),c=parseInt(e.substr(l+4,2),10),d=u*60+c;d*=6e4,f==="+"?t.setTime(+t-d):t.setTime(+t+d)}return t};ue.generalizedTimeToDate=function(e){var t=new Date,a=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,n=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),f=0,l=0,u=!1;e.charAt(e.length-1)==="Z"&&(u=!0);var c=e.length-5,d=e.charAt(c);if(d==="+"||d==="-"){var h=parseInt(e.substr(c+1,2),10),p=parseInt(e.substr(c+4,2),10);l=h*60+p,l*=6e4,d==="+"&&(l*=-1),u=!0}return e.charAt(14)==="."&&(f=parseFloat(e.substr(14),10)*1e3),u?(t.setUTCFullYear(a,r,n),t.setUTCHours(i,s,o,f),t.setTime(+t+l)):(t.setFullYear(a,r,n),t.setHours(i,s,o,f)),t};ue.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",a=[];a.push((""+e.getUTCFullYear()).substr(2)),a.push(""+(e.getUTCMonth()+1)),a.push(""+e.getUTCDate()),a.push(""+e.getUTCHours()),a.push(""+e.getUTCMinutes()),a.push(""+e.getUTCSeconds());for(var r=0;r<a.length;++r)a[r].length<2&&(t+="0"),t+=a[r];return t+="Z",t};ue.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",a=[];a.push(""+e.getUTCFullYear()),a.push(""+(e.getUTCMonth()+1)),a.push(""+e.getUTCDate()),a.push(""+e.getUTCHours()),a.push(""+e.getUTCMinutes()),a.push(""+e.getUTCSeconds());for(var r=0;r<a.length;++r)a[r].length<2&&(t+="0"),t+=a[r];return t+="Z",t};ue.integerToDer=function(e){var t=it.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var a=new Error("Integer too large; max is 32-bits.");throw a.integer=e,a};ue.derToInteger=function(e){typeof e=="string"&&(e=it.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};ue.validate=function(e,t,a,r){var n=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(n=!0,t.value&&it.util.isArray(t.value))for(var i=0,s=0;n&&s<t.value.length;++s)n=t.value[s].optional||!1,e.value[i]&&(n=ue.validate(e.value[i],t.value[s],a,r),n?++i:t.value[s].optional&&(n=!0)),!n&&r&&r.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(n&&a&&(t.capture&&(a[t.capture]=e.value),t.captureAsn1&&(a[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(a[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e))if(e.bitStringContents.length<2)a[t.captureBitStringValue]="";else{var o=e.bitStringContents.charCodeAt(0);if(o!==0)throw new Error("captureBitStringValue only supported for zero unused bits");a[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else r&&r.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else r&&(e.tagClass!==t.tagClass&&r.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&r.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return n};var os=/[^\\u0000-\\u00ff]/;ue.prettyPrint=function(e,t,a){var r="";t=t||0,a=a||2,t>0&&(r+=`
`);for(var n="",i=0;i<t*a;++i)n+=" ";switch(r+=n+"Tag: ",e.tagClass){case ue.Class.UNIVERSAL:r+="Universal:";break;case ue.Class.APPLICATION:r+="Application:";break;case ue.Class.CONTEXT_SPECIFIC:r+="Context-Specific:";break;case ue.Class.PRIVATE:r+="Private:";break}if(e.tagClass===ue.Class.UNIVERSAL)switch(r+=e.type,e.type){case ue.Type.NONE:r+=" (None)";break;case ue.Type.BOOLEAN:r+=" (Boolean)";break;case ue.Type.INTEGER:r+=" (Integer)";break;case ue.Type.BITSTRING:r+=" (Bit string)";break;case ue.Type.OCTETSTRING:r+=" (Octet string)";break;case ue.Type.NULL:r+=" (Null)";break;case ue.Type.OID:r+=" (Object Identifier)";break;case ue.Type.ODESC:r+=" (Object Descriptor)";break;case ue.Type.EXTERNAL:r+=" (External or Instance of)";break;case ue.Type.REAL:r+=" (Real)";break;case ue.Type.ENUMERATED:r+=" (Enumerated)";break;case ue.Type.EMBEDDED:r+=" (Embedded PDV)";break;case ue.Type.UTF8:r+=" (UTF8)";break;case ue.Type.ROID:r+=" (Relative Object Identifier)";break;case ue.Type.SEQUENCE:r+=" (Sequence)";break;case ue.Type.SET:r+=" (Set)";break;case ue.Type.PRINTABLESTRING:r+=" (Printable String)";break;case ue.Type.IA5String:r+=" (IA5String (ASCII))";break;case ue.Type.UTCTIME:r+=" (UTC time)";break;case ue.Type.GENERALIZEDTIME:r+=" (Generalized time)";break;case ue.Type.BMPSTRING:r+=" (BMP String)";break}else r+=e.type;if(r+=`
`,r+=n+"Constructed: "+e.constructed+`
`,e.composed){for(var s=0,o="",i=0;i<e.value.length;++i)e.value[i]!==void 0&&(s+=1,o+=ue.prettyPrint(e.value[i],t+1,a),i+1<e.value.length&&(o+=","));r+=n+"Sub values: "+s+o}else{if(r+=n+"Value: ",e.type===ue.Type.OID){var f=ue.derToOid(e.value);r+=f,it.pki&&it.pki.oids&&f in it.pki.oids&&(r+=" ("+it.pki.oids[f]+") ")}if(e.type===ue.Type.INTEGER)try{r+=ue.derToInteger(e.value)}catch{r+="0x"+it.util.bytesToHex(e.value)}else if(e.type===ue.Type.BITSTRING){if(e.value.length>1?r+="0x"+it.util.bytesToHex(e.value.slice(1)):r+="(none)",e.value.length>0){var l=e.value.charCodeAt(0);l==1?r+=" (1 unused bit shown)":l>1&&(r+=" ("+l+" unused bits shown)")}}else if(e.type===ue.Type.OCTETSTRING)os.test(e.value)||(r+="("+e.value+") "),r+="0x"+it.util.bytesToHex(e.value);else if(e.type===ue.Type.UTF8)try{r+=it.util.decodeUtf8(e.value)}catch(u){if(u.message==="URI malformed")r+="0x"+it.util.bytesToHex(e.value)+" (malformed UTF8)";else throw u}else e.type===ue.Type.PRINTABLESTRING||e.type===ue.Type.IA5String?r+=e.value:os.test(e.value)?r+="0x"+it.util.bytesToHex(e.value):e.value.length===0?r+="[null]":r+=e.value}return r};var vn=Oe;vn.md=vn.md||{};vn.md.algorithms=vn.md.algorithms||{};var Br=Oe,yf=Br.hmac=Br.hmac||{};yf.create=function(){var e=null,t=null,a=null,r=null,n={};return n.start=function(i,s){if(i!==null)if(typeof i=="string")if(i=i.toLowerCase(),i in Br.md.algorithms)t=Br.md.algorithms[i].create();else throw new Error('Unknown hash algorithm "'+i+'"');else t=i;if(s===null)s=e;else{if(typeof s=="string")s=Br.util.createBuffer(s);else if(Br.util.isArray(s)){var o=s;s=Br.util.createBuffer();for(var f=0;f<o.length;++f)s.putByte(o[f])}var l=s.length();l>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),a=Br.util.createBuffer(),r=Br.util.createBuffer(),l=s.length();for(var f=0;f<l;++f){var o=s.at(f);a.putByte(54^o),r.putByte(92^o)}if(l<t.blockLength)for(var o=t.blockLength-l,f=0;f<o;++f)a.putByte(54),r.putByte(92);e=s,a=a.bytes(),r=r.bytes()}t.start(),t.update(a)},n.update=function(i){t.update(i)},n.getMac=function(){var i=t.digest().bytes();return t.start(),t.update(r),t.update(i),t.digest()},n.digest=n.getMac,n};var xr=Oe,co=xr.md5=xr.md5||{};xr.md.md5=xr.md.algorithms.md5=co;co.create=function(){ho||xf();var e=null,t=xr.util.createBuffer(),a=new Array(16),r={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var n=r.messageLengthSize/4,i=0;i<n;++i)r.fullMessageLength.push(0);return t=xr.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},r},r.start(),r.update=function(n,i){i==="utf8"&&(n=xr.util.encodeUtf8(n));var s=n.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=r.fullMessageLength.length-1;o>=0;--o)r.fullMessageLength[o]+=s[1],s[1]=s[0]+(r.fullMessageLength[o]/4294967296>>>0),r.fullMessageLength[o]=r.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(n),ls(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var n=xr.util.createBuffer();n.putBytes(t.bytes());var i=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=i&r.blockLength-1;n.putBytes(Pi.substr(0,r.blockLength-s));for(var o,f=0,l=r.fullMessageLength.length-1;l>=0;--l)o=r.fullMessageLength[l]*8+f,f=o/4294967296>>>0,n.putInt32Le(o>>>0);var u={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};ls(u,a,n);var c=xr.util.createBuffer();return c.putInt32Le(u.h0),c.putInt32Le(u.h1),c.putInt32Le(u.h2),c.putInt32Le(u.h3),c},r};var Pi=null,dn=null,Va=null,va=null,ho=!1;function xf(){Pi=String.fromCharCode(128),Pi+=xr.util.fillString(String.fromCharCode(0),64),dn=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],Va=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],va=new Array(64);for(var e=0;e<64;++e)va[e]=Math.floor(Math.abs(Math.sin(e+1))*4294967296);ho=!0}function ls(e,t,a){for(var r,n,i,s,o,f,l,u,c=a.length();c>=64;){for(n=e.h0,i=e.h1,s=e.h2,o=e.h3,u=0;u<16;++u)t[u]=a.getInt32Le(),f=o^i&(s^o),r=n+f+va[u]+t[u],l=Va[u],n=o,o=s,s=i,i+=r<<l|r>>>32-l;for(;u<32;++u)f=s^o&(i^s),r=n+f+va[u]+t[dn[u]],l=Va[u],n=o,o=s,s=i,i+=r<<l|r>>>32-l;for(;u<48;++u)f=i^s^o,r=n+f+va[u]+t[dn[u]],l=Va[u],n=o,o=s,s=i,i+=r<<l|r>>>32-l;for(;u<64;++u)f=s^(i|~o),r=n+f+va[u]+t[dn[u]],l=Va[u],n=o,o=s,s=i,i+=r<<l|r>>>32-l;e.h0=e.h0+n|0,e.h1=e.h1+i|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,c-=64}}var gn=Oe,po=gn.pem=gn.pem||{};po.encode=function(e,t){t=t||{};var a="-----BEGIN "+e.type+`-----\r
`,r;if(e.procType&&(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},a+=nn(r)),e.contentDomain&&(r={name:"Content-Domain",values:[e.contentDomain]},a+=nn(r)),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),a+=nn(r)),e.headers)for(var n=0;n<e.headers.length;++n)a+=nn(e.headers[n]);return e.procType&&(a+=`\r
`),a+=gn.util.encode64(e.body,t.maxline||64)+`\r
`,a+="-----END "+e.type+`-----\r
`,a};po.decode=function(e){for(var t=[],a=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,r=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,i;i=a.exec(e),!!i;){var s=i[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var o={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:gn.util.decode64(i[3])};if(t.push(o),!!i[2]){for(var f=i[2].split(n),l=0;i&&l<f.length;){for(var u=f[l].replace(/\s+$/,""),c=l+1;c<f.length;++c){var d=f[c];if(!/\s/.test(d[0]))break;u+=d,l=c}if(i=u.match(r),i){for(var h={name:i[1],values:[]},p=i[2].split(","),v=0;v<p.length;++v)h.values.push(mf(p[v]));if(o.procType)if(!o.contentDomain&&h.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&h.name==="DEK-Info"){if(h.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(h);else{if(h.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(h.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++l}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function nn(e){for(var t=e.name+": ",a=[],r=function(f,l){return" "+l},n=0;n<e.values.length;++n)a.push(e.values[n].replace(/^(\S+\r\n)/,r));t+=a.join(",")+`\r
`;for(var i=0,s=-1,n=0;n<t.length;++n,++i)if(i>65&&s!==-1){var o=t[s];o===","?(++s,t=t.substr(0,s)+`\r
 `+t.substr(s)):t=t.substr(0,s)+`\r
`+o+t.substr(s+1),i=n-s-1,s=-1,++n}else(t[n]===" "||t[n]==="	"||t[n]===",")&&(s=n);return t}function mf(e){return e.replace(/^\s+/,"")}var dt=Oe;dt.des=dt.des||{};dt.des.startEncrypting=function(e,t,a,r){var n=Ln({key:e,output:a,decrypt:!1,mode:r||(t===null?"ECB":"CBC")});return n.start(t),n};dt.des.createEncryptionCipher=function(e,t){return Ln({key:e,output:null,decrypt:!1,mode:t})};dt.des.startDecrypting=function(e,t,a,r){var n=Ln({key:e,output:a,decrypt:!0,mode:r||(t===null?"ECB":"CBC")});return n.start(t),n};dt.des.createDecryptionCipher=function(e,t){return Ln({key:e,output:null,decrypt:!0,mode:t})};dt.des.Algorithm=function(e,t){var a=this;a.name=e,a.mode=new t({blockSize:8,cipher:{encrypt:function(r,n){return fs(a._keys,r,n,!1)},decrypt:function(r,n){return fs(a._keys,r,n,!0)}}}),a._init=!1};dt.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=dt.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=If(t),this._init=!0}};_r("DES-ECB",dt.cipher.modes.ecb);_r("DES-CBC",dt.cipher.modes.cbc);_r("DES-CFB",dt.cipher.modes.cfb);_r("DES-OFB",dt.cipher.modes.ofb);_r("DES-CTR",dt.cipher.modes.ctr);_r("3DES-ECB",dt.cipher.modes.ecb);_r("3DES-CBC",dt.cipher.modes.cbc);_r("3DES-CFB",dt.cipher.modes.cfb);_r("3DES-OFB",dt.cipher.modes.ofb);_r("3DES-CTR",dt.cipher.modes.ctr);function _r(e,t){var a=function(){return new dt.des.Algorithm(e,t)};dt.cipher.registerAlgorithm(e,a)}var Cf=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Ef=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],_f=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],bf=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Sf=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Tf=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Af=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Bf=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function If(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],a=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],i=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],c=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],h=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],v=e.length()>8?3:1,g=[],C=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],x=0,y,S=0;S<v;S++){var T=e.getInt32(),A=e.getInt32();y=(T>>>4^A)&252645135,A^=y,T^=y<<4,y=(A>>>-16^T)&65535,T^=y,A^=y<<-16,y=(T>>>2^A)&858993459,A^=y,T^=y<<2,y=(A>>>-16^T)&65535,T^=y,A^=y<<-16,y=(T>>>1^A)&1431655765,A^=y,T^=y<<1,y=(A>>>8^T)&16711935,T^=y,A^=y<<8,y=(T>>>1^A)&1431655765,A^=y,T^=y<<1,y=T<<8|A>>>20&240,T=A<<24|A<<8&16711680|A>>>8&65280|A>>>24&240,A=y;for(var k=0;k<C.length;++k){C[k]?(T=T<<2|T>>>26,A=A<<2|A>>>26):(T=T<<1|T>>>27,A=A<<1|A>>>27),T&=-15,A&=-15;var B=t[T>>>28]|a[T>>>24&15]|r[T>>>20&15]|n[T>>>16&15]|i[T>>>12&15]|s[T>>>8&15]|o[T>>>4&15],O=f[A>>>28]|l[A>>>24&15]|u[A>>>20&15]|c[A>>>16&15]|d[A>>>12&15]|h[A>>>8&15]|p[A>>>4&15];y=(O>>>16^B)&65535,g[x++]=B^y,g[x++]=O^y<<16}}return g}function fs(e,t,a,r){var n=e.length===32?3:9,i;n===3?i=r?[30,-2,-2]:[0,32,2]:i=r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=t[0],f=t[1];s=(o>>>4^f)&252645135,f^=s,o^=s<<4,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var l=0;l<n;l+=3){for(var u=i[l+1],c=i[l+2],d=i[l];d!=u;d+=c){var h=f^e[d],p=(f>>>4|f<<28)^e[d+1];s=o,o=f,f=s^(Ef[h>>>24&63]|bf[h>>>16&63]|Tf[h>>>8&63]|Bf[h&63]|Cf[p>>>24&63]|_f[p>>>16&63]|Sf[p>>>8&63]|Af[p&63])}s=o,o=f,f=s}o=o>>>1|o<<31,f=f>>>1|f<<31,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(o>>>4^f)&252645135,f^=s,o^=s<<4,a[0]=o,a[1]=f}function Ln(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),a="DES-"+t,r;e.decrypt?r=dt.cipher.createDecipher(a,e.key):r=dt.cipher.createCipher(a,e.key);var n=r.start;return r.start=function(i,s){var o=null;s instanceof dt.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=i,n.call(r,s)},r}var Ut=Oe,wf=Ut.pkcs5=Ut.pkcs5||{},Ar;Ut.util.isNodejs&&!Ut.options.usePureJavaScript&&(Ar=Bn);Ut.pbkdf2=wf.pbkdf2=function(e,t,a,r,n,i){if(typeof n=="function"&&(i=n,n=null),Ut.util.isNodejs&&!Ut.options.usePureJavaScript&&Ar.pbkdf2&&(n===null||typeof n!="object")&&(Ar.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),i?Ar.pbkdf2Sync.length===4?Ar.pbkdf2(e,t,a,r,function(y,S){if(y)return i(y);i(null,S.toString("binary"))}):Ar.pbkdf2(e,t,a,r,n,function(y,S){if(y)return i(y);i(null,S.toString("binary"))}):Ar.pbkdf2Sync.length===4?Ar.pbkdf2Sync(e,t,a,r).toString("binary"):Ar.pbkdf2Sync(e,t,a,r,n).toString("binary");if((typeof n>"u"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in Ut.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=Ut.md[n].create()}var s=n.digestLength;if(r>4294967295*s){var o=new Error("Derived key is too long.");if(i)return i(o);throw o}var f=Math.ceil(r/s),l=r-(f-1)*s,u=Ut.hmac.create();u.start(n,e);var c="",d,h,p;if(!i){for(var v=1;v<=f;++v){u.start(null,null),u.update(t),u.update(Ut.util.int32ToBytes(v)),d=p=u.digest().getBytes();for(var g=2;g<=a;++g)u.start(null,null),u.update(p),h=u.digest().getBytes(),d=Ut.util.xorBytes(d,h,s),p=h;c+=v<f?d:d.substr(0,l)}return c}var v=1,g;function C(){if(v>f)return i(null,c);u.start(null,null),u.update(t),u.update(Ut.util.int32ToBytes(v)),d=p=u.digest().getBytes(),g=2,x()}function x(){if(g<=a)return u.start(null,null),u.update(p),h=u.digest().getBytes(),d=Ut.util.xorBytes(d,h,s),p=h,++g,Ut.util.setImmediate(x);c+=v<f?d:d.substr(0,l),++v,C()}C()};var mr=Oe,vo=mr.sha256=mr.sha256||{};mr.md.sha256=mr.md.algorithms.sha256=vo;vo.create=function(){go||kf();var e=null,t=mr.util.createBuffer(),a=new Array(64),r={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var n=r.messageLengthSize/4,i=0;i<n;++i)r.fullMessageLength.push(0);return t=mr.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},r},r.start(),r.update=function(n,i){i==="utf8"&&(n=mr.util.encodeUtf8(n));var s=n.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=r.fullMessageLength.length-1;o>=0;--o)r.fullMessageLength[o]+=s[1],s[1]=s[0]+(r.fullMessageLength[o]/4294967296>>>0),r.fullMessageLength[o]=r.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(n),us(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var n=mr.util.createBuffer();n.putBytes(t.bytes());var i=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=i&r.blockLength-1;n.putBytes(Ui.substr(0,r.blockLength-s));for(var o,f,l=r.fullMessageLength[0]*8,u=0;u<r.fullMessageLength.length-1;++u)o=r.fullMessageLength[u+1]*8,f=o/4294967296>>>0,l+=f,n.putInt32(l>>>0),l=o>>>0;n.putInt32(l);var c={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};us(c,a,n);var d=mr.util.createBuffer();return d.putInt32(c.h0),d.putInt32(c.h1),d.putInt32(c.h2),d.putInt32(c.h3),d.putInt32(c.h4),d.putInt32(c.h5),d.putInt32(c.h6),d.putInt32(c.h7),d},r};var Ui=null,go=!1,yo=null;function kf(){Ui=String.fromCharCode(128),Ui+=mr.util.fillString(String.fromCharCode(0),64),yo=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],go=!0}function us(e,t,a){for(var r,n,i,s,o,f,l,u,c,d,h,p,v,g,C,x=a.length();x>=64;){for(l=0;l<16;++l)t[l]=a.getInt32();for(;l<64;++l)r=t[l-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,n=t[l-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,t[l]=r+t[l-7]+n+t[l-16]|0;for(u=e.h0,c=e.h1,d=e.h2,h=e.h3,p=e.h4,v=e.h5,g=e.h6,C=e.h7,l=0;l<64;++l)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=g^p&(v^g),i=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&c|d&(u^c),r=C+s+o+yo[l]+t[l],n=i+f,C=g,g=v,v=p,p=h+r>>>0,h=d,d=c,c=u,u=r+n>>>0;e.h0=e.h0+u|0,e.h1=e.h1+c|0,e.h2=e.h2+d|0,e.h3=e.h3+h|0,e.h4=e.h4+p|0,e.h5=e.h5+v|0,e.h6=e.h6+g|0,e.h7=e.h7+C|0,x-=64}}var gr=Oe,hn=null;gr.util.isNodejs&&!gr.options.usePureJavaScript&&!process.versions["node-webkit"]&&(hn=Bn);var Nf=gr.prng=gr.prng||{};Nf.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},a=e.md,r=new Array(32),n=0;n<32;++n)r[n]=a.create();t.pools=r,t.pool=0,t.generate=function(l,u){if(!u)return t.generateSync(l);var c=t.plugin.cipher,d=t.plugin.increment,h=t.plugin.formatKey,p=t.plugin.formatSeed,v=gr.util.createBuffer();t.key=null,g();function g(C){if(C)return u(C);if(v.length()>=l)return u(null,v.getBytes(l));if(t.generated>1048575&&(t.key=null),t.key===null)return gr.util.nextTick(function(){i(g)});var x=c(t.key,t.seed);t.generated+=x.length,v.putBytes(x),t.key=h(c(t.key,d(t.seed))),t.seed=p(c(t.key,t.seed)),gr.util.setImmediate(g)}},t.generateSync=function(l){var u=t.plugin.cipher,c=t.plugin.increment,d=t.plugin.formatKey,h=t.plugin.formatSeed;t.key=null;for(var p=gr.util.createBuffer();p.length()<l;){t.generated>1048575&&(t.key=null),t.key===null&&s();var v=u(t.key,t.seed);t.generated+=v.length,p.putBytes(v),t.key=d(u(t.key,c(t.seed))),t.seed=h(u(t.key,t.seed))}return p.getBytes(l)};function i(l){if(t.pools[0].messageLength>=32)return o(),l();var u=32-t.pools[0].messageLength<<5;t.seedFile(u,function(c,d){if(c)return l(c);t.collect(d),o(),l()})}function s(){if(t.pools[0].messageLength>=32)return o();var l=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(l)),o()}function o(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var l=t.plugin.md.create();l.update(t.keyBytes);for(var u=1,c=0;c<32;++c)t.reseeds%u===0&&(l.update(t.pools[c].digest().getBytes()),t.pools[c].start()),u=u<<1;t.keyBytes=l.digest().getBytes(),l.start(),l.update(t.keyBytes);var d=l.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(d),t.generated=0}function f(l){var u=null,c=gr.util.globalScope,d=c.crypto||c.msCrypto;d&&d.getRandomValues&&(u=function(T){return d.getRandomValues(T)});var h=gr.util.createBuffer();if(u)for(;h.length()<l;){var p=Math.max(1,Math.min(l-h.length(),65536)/4),v=new Uint32Array(Math.floor(p));try{u(v);for(var g=0;g<v.length;++g)h.putInt32(v[g])}catch(T){if(!(typeof QuotaExceededError<"u"&&T instanceof QuotaExceededError))throw T}}if(h.length()<l)for(var C,x,y,S=Math.floor(Math.random()*65536);h.length()<l;){x=16807*(S&65535),C=16807*(S>>16),x+=(C&32767)<<16,x+=C>>15,x=(x&2147483647)+(x>>31),S=x&4294967295;for(var g=0;g<3;++g)y=S>>>(g<<3),y^=Math.floor(Math.random()*256),h.putByte(y&255)}return h.getBytes(l)}return hn?(t.seedFile=function(l,u){hn.randomBytes(l,function(c,d){if(c)return u(c);u(null,d.toString())})},t.seedFileSync=function(l){return hn.randomBytes(l).toString()}):(t.seedFile=function(l,u){try{u(null,f(l))}catch(c){u(c)}},t.seedFileSync=f),t.collect=function(l){for(var u=l.length,c=0;c<u;++c)t.pools[t.pool].update(l.substr(c,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(l,u){for(var c="",d=0;d<u;d+=8)c+=String.fromCharCode(l>>d&255);t.collect(c)},t.registerWorker=function(l){if(l===self)t.seedFile=function(c,d){function h(p){var v=p.data;v.forge&&v.forge.prng&&(self.removeEventListener("message",h),d(v.forge.prng.err,v.forge.prng.bytes))}self.addEventListener("message",h),self.postMessage({forge:{prng:{needed:c}}})};else{var u=function(c){var d=c.data;d.forge&&d.forge.prng&&t.seedFile(d.forge.prng.needed,function(h,p){l.postMessage({forge:{prng:{err:h,bytes:p}}})})};l.addEventListener("message",u)}},t};var bt=Oe;(function(){if(bt.random&&bt.random.getBytes){bt.random;return}(function(e){var t={},a=new Array(4),r=bt.util.createBuffer();t.formatKey=function(c){var d=bt.util.createBuffer(c);return c=new Array(4),c[0]=d.getInt32(),c[1]=d.getInt32(),c[2]=d.getInt32(),c[3]=d.getInt32(),bt.aes._expandKey(c,!1)},t.formatSeed=function(c){var d=bt.util.createBuffer(c);return c=new Array(4),c[0]=d.getInt32(),c[1]=d.getInt32(),c[2]=d.getInt32(),c[3]=d.getInt32(),c},t.cipher=function(c,d){return bt.aes._updateBlock(c,d,a,!1),r.putInt32(a[0]),r.putInt32(a[1]),r.putInt32(a[2]),r.putInt32(a[3]),r.getBytes()},t.increment=function(c){return++c[3],c},t.md=bt.md.sha256;function n(){var c=bt.prng.create(t);return c.getBytes=function(d,h){return c.generate(d,h)},c.getBytesSync=function(d){return c.generate(d)},c}var i=n(),s=null,o=bt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(s=function(c){return f.getRandomValues(c)}),bt.options.usePureJavaScript||!bt.util.isNodejs&&!s){if(i.collectInt(+new Date,32),typeof navigator<"u"){var l="";for(var u in navigator)try{typeof navigator[u]=="string"&&(l+=navigator[u])}catch{}i.collect(l),l=null}e&&(e().mousemove(function(c){i.collectInt(c.clientX,16),i.collectInt(c.clientY,16)}),e().keypress(function(c){i.collectInt(c.charCode,8)}))}if(!bt.random)bt.random=i;else for(var u in i)bt.random[u]=i[u];bt.random.createInstance=n,bt.random})(typeof jQuery<"u"?jQuery:null)})();var zt=Oe,Ei=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],cs=[1,2,3,5],Rf=function(e,t){return e<<t&65535|(e&65535)>>16-t},Lf=function(e,t){return(e&65535)>>t|e<<16-t&65535};zt.rc2=zt.rc2||{};zt.rc2.expandKey=function(e,t){typeof e=="string"&&(e=zt.util.createBuffer(e)),t=t||128;var a=e,r=e.length(),n=t,i=Math.ceil(n/8),s=255>>(n&7),o;for(o=r;o<128;o++)a.putByte(Ei[a.at(o-1)+a.at(o-r)&255]);for(a.setAt(128-i,Ei[a.at(128-i)&s]),o=127-i;o>=0;o--)a.setAt(o,Ei[a.at(o+1)^a.at(o+i)]);return a};var xo=function(e,t,a){var r=!1,n=null,i=null,s=null,o,f,l,u,c=[];for(e=zt.rc2.expandKey(e,t),l=0;l<64;l++)c.push(e.getInt16Le());a?(o=function(p){for(l=0;l<4;l++)p[l]+=c[u]+(p[(l+3)%4]&p[(l+2)%4])+(~p[(l+3)%4]&p[(l+1)%4]),p[l]=Rf(p[l],cs[l]),u++},f=function(p){for(l=0;l<4;l++)p[l]+=c[p[(l+3)%4]&63]}):(o=function(p){for(l=3;l>=0;l--)p[l]=Lf(p[l],cs[l]),p[l]-=c[u]+(p[(l+3)%4]&p[(l+2)%4])+(~p[(l+3)%4]&p[(l+1)%4]),u--},f=function(p){for(l=3;l>=0;l--)p[l]-=c[p[(l+3)%4]&63]});var d=function(p){var v=[];for(l=0;l<4;l++){var g=n.getInt16Le();s!==null&&(a?g^=s.getInt16Le():s.putInt16Le(g)),v.push(g&65535)}u=a?0:63;for(var C=0;C<p.length;C++)for(var x=0;x<p[C][0];x++)p[C][1](v);for(l=0;l<4;l++)s!==null&&(a?s.putInt16Le(v[l]):v[l]^=s.getInt16Le()),i.putInt16Le(v[l])},h=null;return h={start:function(p,v){p&&typeof p=="string"&&(p=zt.util.createBuffer(p)),r=!1,n=zt.util.createBuffer(),i=v||new zt.util.createBuffer,s=p,h.output=i},update:function(p){for(r||n.putBuffer(p);n.length()>=8;)d([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var v=!0;if(a)if(p)v=p(8,n,!a);else{var g=n.length()===8?8:8-n.length();n.fillWithByte(g,g)}if(v&&(r=!0,h.update()),!a&&(v=n.length()===0,v))if(p)v=p(8,i,!a);else{var C=i.length(),x=i.at(C-1);x>C?v=!1:i.truncate(x)}return v}},h};zt.rc2.startEncrypting=function(e,t,a){var r=zt.rc2.createEncryptionCipher(e,128);return r.start(t,a),r};zt.rc2.createEncryptionCipher=function(e,t){return xo(e,t,!0)};zt.rc2.startDecrypting=function(e,t,a){var r=zt.rc2.createDecryptionCipher(e,128);return r.start(t,a),r};zt.rc2.createDecryptionCipher=function(e,t){return xo(e,t,!1)};var Oi=Oe;Oi.jsbn=Oi.jsbn||{};var Ir;function te(e,t,a){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,a):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Oi.jsbn.BigInteger=te;function je(){return new te(null)}function Df(e,t,a,r,n,i){for(;--i>=0;){var s=t*this.data[e++]+a.data[r]+n;n=Math.floor(s/67108864),a.data[r++]=s&67108863}return n}function Pf(e,t,a,r,n,i){for(var s=t&32767,o=t>>15;--i>=0;){var f=this.data[e]&32767,l=this.data[e++]>>15,u=o*f+l*s;f=s*f+((u&32767)<<15)+a.data[r]+(n&1073741823),n=(f>>>30)+(u>>>15)+o*l+(n>>>30),a.data[r++]=f&1073741823}return n}function ds(e,t,a,r,n,i){for(var s=t&16383,o=t>>14;--i>=0;){var f=this.data[e]&16383,l=this.data[e++]>>14,u=o*f+l*s;f=s*f+((u&16383)<<14)+a.data[r]+n,n=(f>>28)+(u>>14)+o*l,a.data[r++]=f&268435455}return n}typeof navigator>"u"?(te.prototype.am=ds,Ir=28):navigator.appName=="Microsoft Internet Explorer"?(te.prototype.am=Pf,Ir=30):navigator.appName!="Netscape"?(te.prototype.am=Df,Ir=26):(te.prototype.am=ds,Ir=28);te.prototype.DB=Ir;te.prototype.DM=(1<<Ir)-1;te.prototype.DV=1<<Ir;var i0=52;te.prototype.FV=Math.pow(2,i0);te.prototype.F1=i0-Ir;te.prototype.F2=2*Ir-i0;var Uf="0123456789abcdefghijklmnopqrstuvwxyz",Dn=new Array,Aa,$t;Aa="0".charCodeAt(0);for($t=0;$t<=9;++$t)Dn[Aa++]=$t;Aa="a".charCodeAt(0);for($t=10;$t<36;++$t)Dn[Aa++]=$t;Aa="A".charCodeAt(0);for($t=10;$t<36;++$t)Dn[Aa++]=$t;function hs(e){return Uf.charAt(e)}function mo(e,t){var a=Dn[e.charCodeAt(t)];return a??-1}function Of(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function Vf(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function Mr(e){var t=je();return t.fromInt(e),t}function Ff(e,t){var a;if(t==16)a=4;else if(t==8)a=3;else if(t==256)a=8;else if(t==2)a=1;else if(t==32)a=5;else if(t==4)a=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var r=e.length,n=!1,i=0;--r>=0;){var s=a==8?e[r]&255:mo(e,r);if(s<0){e.charAt(r)=="-"&&(n=!0);continue}n=!1,i==0?this.data[this.t++]=s:i+a>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-i)-1)<<i,this.data[this.t++]=s>>this.DB-i):this.data[this.t-1]|=s<<i,i+=a,i>=this.DB&&(i-=this.DB)}a==8&&e[0]&128&&(this.s=-1,i>0&&(this.data[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),n&&te.ZERO.subTo(this,this)}function Mf(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function Kf(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var a=(1<<t)-1,r,n=!1,i="",s=this.t,o=this.DB-s*this.DB%t;if(s-- >0)for(o<this.DB&&(r=this.data[s]>>o)>0&&(n=!0,i=hs(r));s>=0;)o<t?(r=(this.data[s]&(1<<o)-1)<<t-o,r|=this.data[--s]>>(o+=this.DB-t)):(r=this.data[s]>>(o-=t)&a,o<=0&&(o+=this.DB,--s)),r>0&&(n=!0),n&&(i+=hs(r));return n?i:"0"}function Hf(){var e=je();return te.ZERO.subTo(this,e),e}function zf(){return this.s<0?this.negate():this}function qf(e){var t=this.s-e.s;if(t!=0)return t;var a=this.t;if(t=a-e.t,t!=0)return this.s<0?-t:t;for(;--a>=0;)if((t=this.data[a]-e.data[a])!=0)return t;return 0}function Pn(e){var t=1,a;return(a=e>>>16)!=0&&(e=a,t+=16),(a=e>>8)!=0&&(e=a,t+=8),(a=e>>4)!=0&&(e=a,t+=4),(a=e>>2)!=0&&(e=a,t+=2),(a=e>>1)!=0&&(e=a,t+=1),t}function Gf(){return this.t<=0?0:this.DB*(this.t-1)+Pn(this.data[this.t-1]^this.s&this.DM)}function Qf(e,t){var a;for(a=this.t-1;a>=0;--a)t.data[a+e]=this.data[a];for(a=e-1;a>=0;--a)t.data[a]=0;t.t=this.t+e,t.s=this.s}function Wf(e,t){for(var a=e;a<this.t;++a)t.data[a-e]=this.data[a];t.t=Math.max(this.t-e,0),t.s=this.s}function jf(e,t){var a=e%this.DB,r=this.DB-a,n=(1<<r)-1,i=Math.floor(e/this.DB),s=this.s<<a&this.DM,o;for(o=this.t-1;o>=0;--o)t.data[o+i+1]=this.data[o]>>r|s,s=(this.data[o]&n)<<a;for(o=i-1;o>=0;--o)t.data[o]=0;t.data[i]=s,t.t=this.t+i+1,t.s=this.s,t.clamp()}function Yf(e,t){t.s=this.s;var a=Math.floor(e/this.DB);if(a>=this.t){t.t=0;return}var r=e%this.DB,n=this.DB-r,i=(1<<r)-1;t.data[0]=this.data[a]>>r;for(var s=a+1;s<this.t;++s)t.data[s-a-1]|=(this.data[s]&i)<<n,t.data[s-a]=this.data[s]>>r;r>0&&(t.data[this.t-a-1]|=(this.s&i)<<n),t.t=this.t-a,t.clamp()}function Xf(e,t){for(var a=0,r=0,n=Math.min(e.t,this.t);a<n;)r+=this.data[a]-e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;a<this.t;)r+=this.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<e.t;)r-=e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t.data[a++]=this.DV+r:r>0&&(t.data[a++]=r),t.t=a,t.clamp()}function Zf(e,t){var a=this.abs(),r=e.abs(),n=a.t;for(t.t=n+r.t;--n>=0;)t.data[n]=0;for(n=0;n<r.t;++n)t.data[n+a.t]=a.am(0,r.data[n],t,n,0,a.t);t.s=0,t.clamp(),this.s!=e.s&&te.ZERO.subTo(t,t)}function Jf(e){for(var t=this.abs(),a=e.t=2*t.t;--a>=0;)e.data[a]=0;for(a=0;a<t.t-1;++a){var r=t.am(a,t.data[a],e,2*a,0,1);(e.data[a+t.t]+=t.am(a+1,2*t.data[a],e,2*a+1,r,t.t-a-1))>=t.DV&&(e.data[a+t.t]-=t.DV,e.data[a+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(a,t.data[a],e,2*a,0,1)),e.s=0,e.clamp()}function $f(e,t,a){var r=e.abs();if(!(r.t<=0)){var n=this.abs();if(n.t<r.t){t!=null&&t.fromInt(0),a!=null&&this.copyTo(a);return}a==null&&(a=je());var i=je(),s=this.s,o=e.s,f=this.DB-Pn(r.data[r.t-1]);f>0?(r.lShiftTo(f,i),n.lShiftTo(f,a)):(r.copyTo(i),n.copyTo(a));var l=i.t,u=i.data[l-1];if(u!=0){var c=u*(1<<this.F1)+(l>1?i.data[l-2]>>this.F2:0),d=this.FV/c,h=(1<<this.F1)/c,p=1<<this.F2,v=a.t,g=v-l,C=t??je();for(i.dlShiftTo(g,C),a.compareTo(C)>=0&&(a.data[a.t++]=1,a.subTo(C,a)),te.ONE.dlShiftTo(l,C),C.subTo(i,i);i.t<l;)i.data[i.t++]=0;for(;--g>=0;){var x=a.data[--v]==u?this.DM:Math.floor(a.data[v]*d+(a.data[v-1]+p)*h);if((a.data[v]+=i.am(0,x,a,g,0,l))<x)for(i.dlShiftTo(g,C),a.subTo(C,a);a.data[v]<--x;)a.subTo(C,a)}t!=null&&(a.drShiftTo(l,t),s!=o&&te.ZERO.subTo(t,t)),a.t=l,a.clamp(),f>0&&a.rShiftTo(f,a),s<0&&te.ZERO.subTo(a,a)}}}function eu(e){var t=je();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(te.ZERO)>0&&e.subTo(t,t),t}function la(e){this.m=e}function tu(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function ru(e){return e}function au(e){e.divRemTo(this.m,null,e)}function nu(e,t,a){e.multiplyTo(t,a),this.reduce(a)}function iu(e,t){e.squareTo(t),this.reduce(t)}la.prototype.convert=tu;la.prototype.revert=ru;la.prototype.reduce=au;la.prototype.mulTo=nu;la.prototype.sqrTo=iu;function su(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function fa(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function ou(e){var t=je();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(te.ZERO)>0&&this.m.subTo(t,t),t}function lu(e){var t=je();return e.copyTo(t),this.reduce(t),t}function fu(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var a=e.data[t]&32767,r=a*this.mpl+((a*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(a=t+this.m.t,e.data[a]+=this.m.am(0,r,e,t,0,this.m.t);e.data[a]>=e.DV;)e.data[a]-=e.DV,e.data[++a]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function uu(e,t){e.squareTo(t),this.reduce(t)}function cu(e,t,a){e.multiplyTo(t,a),this.reduce(a)}fa.prototype.convert=ou;fa.prototype.revert=lu;fa.prototype.reduce=fu;fa.prototype.mulTo=cu;fa.prototype.sqrTo=uu;function du(){return(this.t>0?this.data[0]&1:this.s)==0}function hu(e,t){if(e>4294967295||e<1)return te.ONE;var a=je(),r=je(),n=t.convert(this),i=Pn(e)-1;for(n.copyTo(a);--i>=0;)if(t.sqrTo(a,r),(e&1<<i)>0)t.mulTo(r,n,a);else{var s=a;a=r,r=s}return t.revert(a)}function pu(e,t){var a;return e<256||t.isEven()?a=new la(t):a=new fa(t),this.exp(e,a)}te.prototype.copyTo=Of;te.prototype.fromInt=Vf;te.prototype.fromString=Ff;te.prototype.clamp=Mf;te.prototype.dlShiftTo=Qf;te.prototype.drShiftTo=Wf;te.prototype.lShiftTo=jf;te.prototype.rShiftTo=Yf;te.prototype.subTo=Xf;te.prototype.multiplyTo=Zf;te.prototype.squareTo=Jf;te.prototype.divRemTo=$f;te.prototype.invDigit=su;te.prototype.isEven=du;te.prototype.exp=hu;te.prototype.toString=Kf;te.prototype.negate=Hf;te.prototype.abs=zf;te.prototype.compareTo=qf;te.prototype.bitLength=Gf;te.prototype.mod=eu;te.prototype.modPowInt=pu;te.ZERO=Mr(0);te.ONE=Mr(1);function vu(){var e=je();return this.copyTo(e),e}function gu(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function yu(){return this.t==0?this.s:this.data[0]<<24>>24}function xu(){return this.t==0?this.s:this.data[0]<<16>>16}function mu(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Cu(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Eu(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),a=Math.pow(e,t),r=Mr(a),n=je(),i=je(),s="";for(this.divRemTo(r,n,i);n.signum()>0;)s=(a+i.intValue()).toString(e).substr(1)+s,n.divRemTo(r,n,i);return i.intValue().toString(e)+s}function _u(e,t){this.fromInt(0),t==null&&(t=10);for(var a=this.chunkSize(t),r=Math.pow(t,a),n=!1,i=0,s=0,o=0;o<e.length;++o){var f=mo(e,o);if(f<0){e.charAt(o)=="-"&&this.signum()==0&&(n=!0);continue}s=t*s+f,++i>=a&&(this.dMultiply(r),this.dAddOffset(s,0),i=0,s=0)}i>0&&(this.dMultiply(Math.pow(t,i)),this.dAddOffset(s,0)),n&&te.ZERO.subTo(this,this)}function bu(e,t,a){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,a),this.testBit(e-1)||this.bitwiseTo(te.ONE.shiftLeft(e-1),s0,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(te.ONE.shiftLeft(e-1),this);else{var r=new Array,n=e&7;r.length=(e>>3)+1,t.nextBytes(r),n>0?r[0]&=(1<<n)-1:r[0]=0,this.fromString(r,256)}}function Su(){var e=this.t,t=new Array;t[0]=this.s;var a=this.DB-e*this.DB%8,r,n=0;if(e-- >0)for(a<this.DB&&(r=this.data[e]>>a)!=(this.s&this.DM)>>a&&(t[n++]=r|this.s<<this.DB-a);e>=0;)a<8?(r=(this.data[e]&(1<<a)-1)<<8-a,r|=this.data[--e]>>(a+=this.DB-8)):(r=this.data[e]>>(a-=8)&255,a<=0&&(a+=this.DB,--e)),r&128&&(r|=-256),n==0&&(this.s&128)!=(r&128)&&++n,(n>0||r!=this.s)&&(t[n++]=r);return t}function Tu(e){return this.compareTo(e)==0}function Au(e){return this.compareTo(e)<0?this:e}function Bu(e){return this.compareTo(e)>0?this:e}function Iu(e,t,a){var r,n,i=Math.min(e.t,this.t);for(r=0;r<i;++r)a.data[r]=t(this.data[r],e.data[r]);if(e.t<this.t){for(n=e.s&this.DM,r=i;r<this.t;++r)a.data[r]=t(this.data[r],n);a.t=this.t}else{for(n=this.s&this.DM,r=i;r<e.t;++r)a.data[r]=t(n,e.data[r]);a.t=e.t}a.s=t(this.s,e.s),a.clamp()}function wu(e,t){return e&t}function ku(e){var t=je();return this.bitwiseTo(e,wu,t),t}function s0(e,t){return e|t}function Nu(e){var t=je();return this.bitwiseTo(e,s0,t),t}function Co(e,t){return e^t}function Ru(e){var t=je();return this.bitwiseTo(e,Co,t),t}function Eo(e,t){return e&~t}function Lu(e){var t=je();return this.bitwiseTo(e,Eo,t),t}function Du(){for(var e=je(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function Pu(e){var t=je();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Uu(e){var t=je();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Ou(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function Vu(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+Ou(this.data[e]);return this.s<0?this.t*this.DB:-1}function Fu(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Mu(){for(var e=0,t=this.s&this.DM,a=0;a<this.t;++a)e+=Fu(this.data[a]^t);return e}function Ku(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function Hu(e,t){var a=te.ONE.shiftLeft(e);return this.bitwiseTo(a,t,a),a}function zu(e){return this.changeBit(e,s0)}function qu(e){return this.changeBit(e,Eo)}function Gu(e){return this.changeBit(e,Co)}function Qu(e,t){for(var a=0,r=0,n=Math.min(e.t,this.t);a<n;)r+=this.data[a]+e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;a<this.t;)r+=this.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<e.t;)r+=e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t.data[a++]=r:r<-1&&(t.data[a++]=this.DV+r),t.t=a,t.clamp()}function Wu(e){var t=je();return this.addTo(e,t),t}function ju(e){var t=je();return this.subTo(e,t),t}function Yu(e){var t=je();return this.multiplyTo(e,t),t}function Xu(e){var t=je();return this.divRemTo(e,t,null),t}function Zu(e){var t=je();return this.divRemTo(e,null,t),t}function Ju(e){var t=je(),a=je();return this.divRemTo(e,t,a),new Array(t,a)}function $u(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function ec(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Za(){}function _o(e){return e}function tc(e,t,a){e.multiplyTo(t,a)}function rc(e,t){e.squareTo(t)}Za.prototype.convert=_o;Za.prototype.revert=_o;Za.prototype.mulTo=tc;Za.prototype.sqrTo=rc;function ac(e){return this.exp(e,new Za)}function nc(e,t,a){var r=Math.min(this.t+e.t,t);for(a.s=0,a.t=r;r>0;)a.data[--r]=0;var n;for(n=a.t-this.t;r<n;++r)a.data[r+this.t]=this.am(0,e.data[r],a,r,0,this.t);for(n=Math.min(e.t,t);r<n;++r)this.am(0,e.data[r],a,r,0,t-r);a.clamp()}function ic(e,t,a){--t;var r=a.t=this.t+e.t-t;for(a.s=0;--r>=0;)a.data[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)a.data[this.t+r-t]=this.am(t-r,e.data[r],a,0,0,this.t+r-t);a.clamp(),a.drShiftTo(1,a)}function Ba(e){this.r2=je(),this.q3=je(),te.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function sc(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=je();return e.copyTo(t),this.reduce(t),t}function oc(e){return e}function lc(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function fc(e,t){e.squareTo(t),this.reduce(t)}function uc(e,t,a){e.multiplyTo(t,a),this.reduce(a)}Ba.prototype.convert=sc;Ba.prototype.revert=oc;Ba.prototype.reduce=lc;Ba.prototype.mulTo=uc;Ba.prototype.sqrTo=fc;function cc(e,t){var a=e.bitLength(),r,n=Mr(1),i;if(a<=0)return n;a<18?r=1:a<48?r=3:a<144?r=4:a<768?r=5:r=6,a<8?i=new la(t):t.isEven()?i=new Ba(t):i=new fa(t);var s=new Array,o=3,f=r-1,l=(1<<r)-1;if(s[1]=i.convert(this),r>1){var u=je();for(i.sqrTo(s[1],u);o<=l;)s[o]=je(),i.mulTo(u,s[o-2],s[o]),o+=2}var c=e.t-1,d,h=!0,p=je(),v;for(a=Pn(e.data[c])-1;c>=0;){for(a>=f?d=e.data[c]>>a-f&l:(d=(e.data[c]&(1<<a+1)-1)<<f-a,c>0&&(d|=e.data[c-1]>>this.DB+a-f)),o=r;!(d&1);)d>>=1,--o;if((a-=o)<0&&(a+=this.DB,--c),h)s[d].copyTo(n),h=!1;else{for(;o>1;)i.sqrTo(n,p),i.sqrTo(p,n),o-=2;o>0?i.sqrTo(n,p):(v=n,n=p,p=v),i.mulTo(p,s[d],n)}for(;c>=0&&!(e.data[c]&1<<a);)i.sqrTo(n,p),v=n,n=p,p=v,--a<0&&(a=this.DB-1,--c)}return i.revert(n)}function dc(e){var t=this.s<0?this.negate():this.clone(),a=e.s<0?e.negate():e.clone();if(t.compareTo(a)<0){var r=t;t=a,a=r}var n=t.getLowestSetBit(),i=a.getLowestSetBit();if(i<0)return t;for(n<i&&(i=n),i>0&&(t.rShiftTo(i,t),a.rShiftTo(i,a));t.signum()>0;)(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),(n=a.getLowestSetBit())>0&&a.rShiftTo(n,a),t.compareTo(a)>=0?(t.subTo(a,t),t.rShiftTo(1,t)):(a.subTo(t,a),a.rShiftTo(1,a));return i>0&&a.lShiftTo(i,a),a}function hc(e){if(e<=0)return 0;var t=this.DV%e,a=this.s<0?e-1:0;if(this.t>0)if(t==0)a=this.data[0]%e;else for(var r=this.t-1;r>=0;--r)a=(t*a+this.data[r])%e;return a}function pc(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return te.ZERO;for(var a=e.clone(),r=this.clone(),n=Mr(1),i=Mr(0),s=Mr(0),o=Mr(1);a.signum()!=0;){for(;a.isEven();)a.rShiftTo(1,a),t?((!n.isEven()||!i.isEven())&&(n.addTo(this,n),i.subTo(e,i)),n.rShiftTo(1,n)):i.isEven()||i.subTo(e,i),i.rShiftTo(1,i);for(;r.isEven();)r.rShiftTo(1,r),t?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);a.compareTo(r)>=0?(a.subTo(r,a),t&&n.subTo(s,n),i.subTo(o,i)):(r.subTo(a,r),t&&s.subTo(n,s),o.subTo(i,o))}if(r.compareTo(te.ONE)!=0)return te.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var or=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],vc=(1<<26)/or[or.length-1];function gc(e){var t,a=this.abs();if(a.t==1&&a.data[0]<=or[or.length-1]){for(t=0;t<or.length;++t)if(a.data[0]==or[t])return!0;return!1}if(a.isEven())return!1;for(t=1;t<or.length;){for(var r=or[t],n=t+1;n<or.length&&r<vc;)r*=or[n++];for(r=a.modInt(r);t<n;)if(r%or[t++]==0)return!1}return a.millerRabin(e)}function yc(e){var t=this.subtract(te.ONE),a=t.getLowestSetBit();if(a<=0)return!1;for(var r=t.shiftRight(a),n=xc(),i,s=0;s<e;++s){do i=new te(this.bitLength(),n);while(i.compareTo(te.ONE)<=0||i.compareTo(t)>=0);var o=i.modPow(r,this);if(o.compareTo(te.ONE)!=0&&o.compareTo(t)!=0){for(var f=1;f++<a&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(te.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}function xc(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}te.prototype.chunkSize=mu;te.prototype.toRadix=Eu;te.prototype.fromRadix=_u;te.prototype.fromNumber=bu;te.prototype.bitwiseTo=Iu;te.prototype.changeBit=Hu;te.prototype.addTo=Qu;te.prototype.dMultiply=$u;te.prototype.dAddOffset=ec;te.prototype.multiplyLowerTo=nc;te.prototype.multiplyUpperTo=ic;te.prototype.modInt=hc;te.prototype.millerRabin=yc;te.prototype.clone=vu;te.prototype.intValue=gu;te.prototype.byteValue=yu;te.prototype.shortValue=xu;te.prototype.signum=Cu;te.prototype.toByteArray=Su;te.prototype.equals=Tu;te.prototype.min=Au;te.prototype.max=Bu;te.prototype.and=ku;te.prototype.or=Nu;te.prototype.xor=Ru;te.prototype.andNot=Lu;te.prototype.not=Du;te.prototype.shiftLeft=Pu;te.prototype.shiftRight=Uu;te.prototype.getLowestSetBit=Vu;te.prototype.bitCount=Mu;te.prototype.testBit=Ku;te.prototype.setBit=zu;te.prototype.clearBit=qu;te.prototype.flipBit=Gu;te.prototype.add=Wu;te.prototype.subtract=ju;te.prototype.multiply=Yu;te.prototype.divide=Xu;te.prototype.remainder=Zu;te.prototype.divideAndRemainder=Ju;te.prototype.modPow=cc;te.prototype.modInverse=pc;te.prototype.pow=ac;te.prototype.gcd=dc;te.prototype.isProbablePrime=gc;var Cr=Oe,bo=Cr.sha1=Cr.sha1||{};Cr.md.sha1=Cr.md.algorithms.sha1=bo;bo.create=function(){So||mc();var e=null,t=Cr.util.createBuffer(),a=new Array(80),r={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var n=r.messageLengthSize/4,i=0;i<n;++i)r.fullMessageLength.push(0);return t=Cr.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},r},r.start(),r.update=function(n,i){i==="utf8"&&(n=Cr.util.encodeUtf8(n));var s=n.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=r.fullMessageLength.length-1;o>=0;--o)r.fullMessageLength[o]+=s[1],s[1]=s[0]+(r.fullMessageLength[o]/4294967296>>>0),r.fullMessageLength[o]=r.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(n),ps(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var n=Cr.util.createBuffer();n.putBytes(t.bytes());var i=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=i&r.blockLength-1;n.putBytes(Vi.substr(0,r.blockLength-s));for(var o,f,l=r.fullMessageLength[0]*8,u=0;u<r.fullMessageLength.length-1;++u)o=r.fullMessageLength[u+1]*8,f=o/4294967296>>>0,l+=f,n.putInt32(l>>>0),l=o>>>0;n.putInt32(l);var c={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};ps(c,a,n);var d=Cr.util.createBuffer();return d.putInt32(c.h0),d.putInt32(c.h1),d.putInt32(c.h2),d.putInt32(c.h3),d.putInt32(c.h4),d},r};var Vi=null,So=!1;function mc(){Vi=String.fromCharCode(128),Vi+=Cr.util.fillString(String.fromCharCode(0),64),So=!0}function ps(e,t,a){for(var r,n,i,s,o,f,l,u,c=a.length();c>=64;){for(n=e.h0,i=e.h1,s=e.h2,o=e.h3,f=e.h4,u=0;u<16;++u)r=a.getInt32(),t[u]=r,l=o^i&(s^o),r=(n<<5|n>>>27)+l+f+1518500249+r,f=o,o=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;u<20;++u)r=t[u-3]^t[u-8]^t[u-14]^t[u-16],r=r<<1|r>>>31,t[u]=r,l=o^i&(s^o),r=(n<<5|n>>>27)+l+f+1518500249+r,f=o,o=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;u<32;++u)r=t[u-3]^t[u-8]^t[u-14]^t[u-16],r=r<<1|r>>>31,t[u]=r,l=i^s^o,r=(n<<5|n>>>27)+l+f+1859775393+r,f=o,o=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;u<40;++u)r=t[u-6]^t[u-16]^t[u-28]^t[u-32],r=r<<2|r>>>30,t[u]=r,l=i^s^o,r=(n<<5|n>>>27)+l+f+1859775393+r,f=o,o=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;u<60;++u)r=t[u-6]^t[u-16]^t[u-28]^t[u-32],r=r<<2|r>>>30,t[u]=r,l=i&s|o&(i^s),r=(n<<5|n>>>27)+l+f+2400959708+r,f=o,o=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;u<80;++u)r=t[u-6]^t[u-16]^t[u-28]^t[u-32],r=r<<2|r>>>30,t[u]=r,l=i^s^o,r=(n<<5|n>>>27)+l+f+3395469782+r,f=o,o=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;e.h0=e.h0+n|0,e.h1=e.h1+i|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,e.h4=e.h4+f|0,c-=64}}var Er=Oe,To=Er.pkcs1=Er.pkcs1||{};To.encode_rsa_oaep=function(e,t,a){var r,n,i,s;typeof a=="string"?(r=a,n=arguments[3]||void 0,i=arguments[4]||void 0):a&&(r=a.label||void 0,n=a.seed||void 0,i=a.md||void 0,a.mgf1&&a.mgf1.md&&(s=a.mgf1.md)),i?i.start():i=Er.md.sha1.create(),s||(s=i);var o=Math.ceil(e.n.bitLength()/8),f=o-2*i.digestLength-2;if(t.length>f){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=t.length,l.maxLength=f,l}r||(r=""),i.update(r,"raw");for(var u=i.digest(),c="",d=f-t.length,h=0;h<d;h++)c+="\0";var p=u.getBytes()+c+""+t;if(!n)n=Er.random.getBytes(i.digestLength);else if(n.length!==i.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=n.length,l.digestLength=i.digestLength,l}var v=yn(n,o-i.digestLength-1,s),g=Er.util.xorBytes(p,v,p.length),C=yn(g,i.digestLength,s),x=Er.util.xorBytes(n,C,n.length);return"\0"+x+g};To.decode_rsa_oaep=function(e,t,a){var r,n,i;typeof a=="string"?(r=a,n=arguments[3]||void 0):a&&(r=a.label||void 0,n=a.md||void 0,a.mgf1&&a.mgf1.md&&(i=a.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var g=new Error("RSAES-OAEP encoded message length is invalid.");throw g.length=t.length,g.expectedLength=s,g}if(n===void 0?n=Er.md.sha1.create():n.start(),i||(i=n),s<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");r||(r=""),n.update(r,"raw");for(var o=n.digest().getBytes(),f=t.charAt(0),l=t.substring(1,n.digestLength+1),u=t.substring(1+n.digestLength),c=yn(u,n.digestLength,i),d=Er.util.xorBytes(l,c,l.length),h=yn(d,s-n.digestLength-1,i),p=Er.util.xorBytes(u,h,u.length),v=p.substring(0,n.digestLength),g=f!=="\0",C=0;C<n.digestLength;++C)g|=o.charAt(C)!==v.charAt(C);for(var x=1,y=n.digestLength,S=n.digestLength;S<p.length;S++){var T=p.charCodeAt(S),A=T&1^1,k=x?65534:0;g|=T&k,x=x&A,y+=x}if(g||p.charCodeAt(y)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(y+1)};function yn(e,t,a){a||(a=Er.md.sha1.create());for(var r="",n=Math.ceil(t/a.digestLength),i=0;i<n;++i){var s=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255);a.start(),a.update(e+s),r+=a.digest().getBytes()}return r.substring(0,t)}var Dr=Oe;(function(){if(Dr.prime){Dr.prime;return}var e=Dr.prime=Dr.prime||{},t=Dr.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],r=new t(null);r.fromInt(30);var n=function(c,d){return c|d};e.generateProbablePrime=function(c,d,h){typeof d=="function"&&(h=d,d={}),d=d||{};var p=d.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var v=d.prng||Dr.random,g={nextBytes:function(C){for(var x=v.getBytesSync(C.length),y=0;y<C.length;++y)C[y]=x.charCodeAt(y)}};if(p.name==="PRIMEINC")return i(c,g,p.options,h);throw new Error("Invalid prime generation algorithm: "+p.name)};function i(c,d,h,p){return"workers"in h?f(c,d,h,p):s(c,d,h,p)}function s(c,d,h,p){var v=l(c,d),g=0,C=u(v.bitLength());"millerRabinTests"in h&&(C=h.millerRabinTests);var x=10;"maxBlockTime"in h&&(x=h.maxBlockTime),o(v,c,d,g,C,x,p)}function o(c,d,h,p,v,g,C){var x=+new Date;do{if(c.bitLength()>d&&(c=l(d,h)),c.isProbablePrime(v))return C(null,c);c.dAddOffset(a[p++%8],0)}while(g<0||+new Date-x<g);Dr.util.setImmediate(function(){o(c,d,h,p,v,g,C)})}function f(c,d,h,p){if(typeof Worker>"u")return s(c,d,h,p);var v=l(c,d),g=h.workers,C=h.workLoad||100,x=C*30/8,y=h.workerScript||"forge/prime.worker.js";if(g===-1)return Dr.util.estimateCores(function(T,A){T&&(A=2),g=A-1,S()});S();function S(){g=Math.max(1,g);for(var T=[],A=0;A<g;++A)T[A]=new Worker(y);for(var A=0;A<g;++A)T[A].addEventListener("message",B);var k=!1;function B(O){if(!k){var I=O.data;if(I.found){for(var w=0;w<T.length;++w)T[w].terminate();return k=!0,p(null,new t(I.prime,16))}v.bitLength()>c&&(v=l(c,d));var P=v.toString(16);O.target.postMessage({hex:P,workLoad:C}),v.dAddOffset(x,0)}}}}function l(c,d){var h=new t(c,d),p=c-1;return h.testBit(p)||h.bitwiseTo(t.ONE.shiftLeft(p),n,h),h.dAddOffset(31-h.mod(r).byteValue(),0),h}function u(c){return c<=100?27:c<=150?18:c<=200?15:c<=250?12:c<=300?9:c<=350?8:c<=400?7:c<=500?6:c<=600?5:c<=800?4:c<=1250?3:2}})();var Ce=Oe;if(typeof We>"u")var We=Ce.jsbn.BigInteger;var Fi=Ce.util.isNodejs?Bn:null,z=Ce.asn1,er=Ce.util;Ce.pki=Ce.pki||{};Ce.pki.rsa=Ce.rsa=Ce.rsa||{};var Ne=Ce.pki,Cc=[6,4,2,4,2,4,6,2],Ec={name:"PrivateKeyInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},_c={name:"RSAPrivateKey",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},bc={name:"RSAPublicKey",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Sc=Ce.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:z.Class.UNIVERSAL,type:z.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Tc={name:"DigestInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:z.Class.UNIVERSAL,type:z.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Ac=function(e){var t;if(e.algorithm in Ne.oids)t=Ne.oids[e.algorithm];else{var a=new Error("Unknown message digest algorithm.");throw a.algorithm=e.algorithm,a}var r=z.oidToDer(t).getBytes(),n=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[]),i=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[]);i.value.push(z.create(z.Class.UNIVERSAL,z.Type.OID,!1,r)),i.value.push(z.create(z.Class.UNIVERSAL,z.Type.NULL,!1,""));var s=z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,e.digest().getBytes());return n.value.push(i),n.value.push(s),z.toDer(n).getBytes()},Ao=function(e,t,a){if(a)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(We.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(We.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var r;do r=new We(Ce.util.bytesToHex(Ce.random.getBytes(t.n.bitLength()/8)),16);while(r.compareTo(t.n)>=0||!r.gcd(t.n).equals(We.ONE));e=e.multiply(r.modPow(t.e,t.n)).mod(t.n);for(var n=e.mod(t.p).modPow(t.dP,t.p),i=e.mod(t.q).modPow(t.dQ,t.q);n.compareTo(i)<0;)n=n.add(t.p);var s=n.subtract(i).multiply(t.qInv).mod(t.p).multiply(t.q).add(i);return s=s.multiply(r.modInverse(t.n)).mod(t.n),s};Ne.rsa.encrypt=function(e,t,a){var r=a,n,i=Math.ceil(t.n.bitLength()/8);a!==!1&&a!==!0?(r=a===2,n=Bo(e,t,a)):(n=Ce.util.createBuffer(),n.putBytes(e));for(var s=new We(n.toHex(),16),o=Ao(s,t,r),f=o.toString(16),l=Ce.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)l.putByte(0),--u;return l.putBytes(Ce.util.hexToBytes(f)),l.getBytes()};Ne.rsa.decrypt=function(e,t,a,r){var n=Math.ceil(t.n.bitLength()/8);if(e.length!==n){var i=new Error("Encrypted message length is invalid.");throw i.length=e.length,i.expected=n,i}var s=new We(Ce.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=Ao(s,t,a),f=o.toString(16),l=Ce.util.createBuffer(),u=n-Math.ceil(f.length/2);u>0;)l.putByte(0),--u;return l.putBytes(Ce.util.hexToBytes(f)),r!==!1?xn(l.getBytes(),t,a):l.getBytes()};Ne.rsa.createKeyPairGenerationState=function(e,t,a){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,a=a||{};var r=a.prng||Ce.random,n={nextBytes:function(o){for(var f=r.getBytesSync(o.length),l=0;l<o.length;++l)o[l]=f.charCodeAt(l)}},i=a.algorithm||"PRIMEINC",s;if(i==="PRIMEINC")s={algorithm:i,state:0,bits:e,rng:n,eInt:t||65537,e:new We(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+i);return s};Ne.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var a=new We(null);a.fromInt(30);for(var r=0,n=function(c,d){return c|d},i=+new Date,s,o=0;e.keys===null&&(t<=0||o<t);){if(e.state===0){var f=e.p===null?e.pBits:e.qBits,l=f-1;e.pqState===0?(e.num=new We(f,e.rng),e.num.testBit(l)||e.num.bitwiseTo(We.ONE.shiftLeft(l),n,e.num),e.num.dAddOffset(31-e.num.mod(a).byteValue(),0),r=0,++e.pqState):e.pqState===1?e.num.bitLength()>f?e.pqState=0:e.num.isProbablePrime(Ic(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(Cc[r++%8],0):e.pqState===2?e.pqState=e.num.subtract(We.ONE).gcd(e.e).compareTo(We.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(We.ONE),e.q1=e.q.subtract(We.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(We.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var u=e.e.modInverse(e.phi);e.keys={privateKey:Ne.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:Ne.rsa.setPublicKey(e.n,e.e)}}s=+new Date,o+=s-i,i=s}return e.keys!==null};Ne.rsa.generateKeyPair=function(e,t,a,r){if(arguments.length===1?typeof e=="object"?(a=e,e=void 0):typeof e=="function"&&(r=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(r=t,t=void 0):typeof t!="number"&&(a=t,t=void 0):(a=e,r=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof a=="function"&&(r=a,a=void 0):(r=a,a=t,t=void 0)),a=a||{},e===void 0&&(e=a.bits||2048),t===void 0&&(t=a.e||65537),!Ce.options.usePureJavaScript&&!a.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(r){if(vs("generateKeyPair"))return Fi.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,l){if(o)return r(o);r(null,{privateKey:Ne.privateKeyFromPem(l),publicKey:Ne.publicKeyFromPem(f)})});if(gs("generateKey")&&gs("exportKey"))return er.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:xs(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return er.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){r(o)}).then(function(o){if(o){var f=Ne.privateKeyFromAsn1(z.fromDer(Ce.util.createBuffer(o)));r(null,{privateKey:f,publicKey:Ne.setRsaPublicKey(f.n,f.e)})}});if(ys("generateKey")&&ys("exportKey")){var n=er.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:xs(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(o){var f=o.target.result,l=er.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);l.oncomplete=function(u){var c=u.target.result,d=Ne.privateKeyFromAsn1(z.fromDer(Ce.util.createBuffer(c)));r(null,{privateKey:d,publicKey:Ne.setRsaPublicKey(d.n,d.e)})},l.onerror=function(u){r(u)}},n.onerror=function(o){r(o)};return}}else if(vs("generateKeyPairSync")){var i=Fi.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Ne.privateKeyFromPem(i.privateKey),publicKey:Ne.publicKeyFromPem(i.publicKey)}}}var s=Ne.rsa.createKeyPairGenerationState(e,t,a);if(!r)return Ne.rsa.stepKeyPairGenerationState(s,0),s.keys;Bc(s,a,r)};Ne.setRsaPublicKey=Ne.rsa.setPublicKey=function(e,t){var a={n:e,e:t};return a.encrypt=function(r,n,i){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(o,f,l){return Bo(o,f,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(o,f){return Ce.pkcs1.encode_rsa_oaep(f,o,i)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(o){return o}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var s=n.encode(r,a,!0);return Ne.rsa.encrypt(s,a,!0)},a.verify=function(r,n,i,s){typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),i==="RSASSA-PKCS1-V1_5"?i={verify:function(f,l){l=xn(l,a,!0);var u=z.fromDer(l,{parseAllBytes:s._parseAllDigestBytes}),c={},d=[];if(!z.validate(u,Tc,c,d)){var h=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw h.errors=d,h}var p=z.derToOid(c.algorithmIdentifier);if(!(p===Ce.oids.md2||p===Ce.oids.md5||p===Ce.oids.sha1||p===Ce.oids.sha224||p===Ce.oids.sha256||p===Ce.oids.sha384||p===Ce.oids.sha512||p===Ce.oids["sha512-224"]||p===Ce.oids["sha512-256"])){var h=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw h.oid=p,h}if((p===Ce.oids.md2||p===Ce.oids.md5)&&!("parameters"in c))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===c.digest}}:(i==="NONE"||i==="NULL"||i===null)&&(i={verify:function(f,l){return l=xn(l,a,!0),f===l}});var o=Ne.rsa.decrypt(n,a,!0,!1);return i.verify(r,o,a.n.bitLength())},a};Ne.setRsaPrivateKey=Ne.rsa.setPrivateKey=function(e,t,a,r,n,i,s,o){var f={n:e,e:t,d:a,p:r,q:n,dP:i,dQ:s,qInv:o};return f.decrypt=function(l,u,c){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var d=Ne.rsa.decrypt(l,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:xn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(h,p){return Ce.pkcs1.decode_rsa_oaep(p,h,c)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(h){return h}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(d,f,!1)},f.sign=function(l,u){var c=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Ac},c=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return l}},c=1);var d=u.encode(l,f.n.bitLength());return Ne.rsa.encrypt(d,f,c)},f};Ne.wrapRsaPrivateKey=function(e){return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,z.integerToDer(0).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Ne.oids.rsaEncryption).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.NULL,!1,"")]),z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(e).getBytes())])};Ne.privateKeyFromAsn1=function(e){var t={},a=[];if(z.validate(e,Ec,t,a)&&(e=z.fromDer(Ce.util.createBuffer(t.privateKey))),t={},a=[],!z.validate(e,_c,t,a)){var r=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw r.errors=a,r}var n,i,s,o,f,l,u,c;return n=Ce.util.createBuffer(t.privateKeyModulus).toHex(),i=Ce.util.createBuffer(t.privateKeyPublicExponent).toHex(),s=Ce.util.createBuffer(t.privateKeyPrivateExponent).toHex(),o=Ce.util.createBuffer(t.privateKeyPrime1).toHex(),f=Ce.util.createBuffer(t.privateKeyPrime2).toHex(),l=Ce.util.createBuffer(t.privateKeyExponent1).toHex(),u=Ce.util.createBuffer(t.privateKeyExponent2).toHex(),c=Ce.util.createBuffer(t.privateKeyCoefficient).toHex(),Ne.setRsaPrivateKey(new We(n,16),new We(i,16),new We(s,16),new We(o,16),new We(f,16),new We(l,16),new We(u,16),new We(c,16))};Ne.privateKeyToAsn1=Ne.privateKeyToRSAPrivateKey=function(e){return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,z.integerToDer(0).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.n)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.e)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.d)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.p)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.q)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.dP)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.dQ)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.qInv))])};Ne.publicKeyFromAsn1=function(e){var t={},a=[];if(z.validate(e,Sc,t,a)){var r=z.derToOid(t.publicKeyOid);if(r!==Ne.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=r,n}e=t.rsaPublicKey}if(a=[],!z.validate(e,bc,t,a)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=a,n}var i=Ce.util.createBuffer(t.publicKeyModulus).toHex(),s=Ce.util.createBuffer(t.publicKeyExponent).toHex();return Ne.setRsaPublicKey(new We(i,16),new We(s,16))};Ne.publicKeyToAsn1=Ne.publicKeyToSubjectPublicKeyInfo=function(e){return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Ne.oids.rsaEncryption).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.NULL,!1,"")]),z.create(z.Class.UNIVERSAL,z.Type.BITSTRING,!1,[Ne.publicKeyToRSAPublicKey(e)])])};Ne.publicKeyToRSAPublicKey=function(e){return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.n)),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,hr(e.e))])};function Bo(e,t,a){var r=Ce.util.createBuffer(),n=Math.ceil(t.n.bitLength()/8);if(e.length>n-11){var i=new Error("Message is too long for PKCS#1 v1.5 padding.");throw i.length=e.length,i.max=n-11,i}r.putByte(0),r.putByte(a);var s=n-3-e.length,o;if(a===0||a===1){o=a===0?0:255;for(var f=0;f<s;++f)r.putByte(o)}else for(;s>0;){for(var l=0,u=Ce.random.getBytes(s),f=0;f<s;++f)o=u.charCodeAt(f),o===0?++l:r.putByte(o);s=l}return r.putByte(0),r.putBytes(e),r}function xn(e,t,a,r){var n=Math.ceil(t.n.bitLength()/8),i=Ce.util.createBuffer(e),s=i.getByte(),o=i.getByte();if(s!==0||a&&o!==0&&o!==1||!a&&o!=2||a&&o===0&&typeof r>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=n-3-r;for(var l=0;l<f;++l)if(i.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;i.length()>1;){if(i.getByte()!==255){--i.read;break}++f}else if(o===2)for(f=0;i.length()>1;){if(i.getByte()===0){--i.read;break}++f}var u=i.getByte();if(u!==0||f!==n-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function Bc(e,t,a){typeof t=="function"&&(a=t,t={}),t=t||{};var r={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(r.prng=t.prng),n();function n(){i(e.pBits,function(o,f){if(o)return a(o);if(e.p=f,e.q!==null)return s(o,e.q);i(e.qBits,s)})}function i(o,f){Ce.prime.generateProbablePrime(o,r,f)}function s(o,f){if(o)return a(o);if(e.q=f,e.p.compareTo(e.q)<0){var l=e.p;e.p=e.q,e.q=l}if(e.p.subtract(We.ONE).gcd(e.e).compareTo(We.ONE)!==0){e.p=null,n();return}if(e.q.subtract(We.ONE).gcd(e.e).compareTo(We.ONE)!==0){e.q=null,i(e.qBits,s);return}if(e.p1=e.p.subtract(We.ONE),e.q1=e.q.subtract(We.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(We.ONE)!==0){e.p=e.q=null,n();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,i(e.qBits,s);return}var u=e.e.modInverse(e.phi);e.keys={privateKey:Ne.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:Ne.rsa.setPublicKey(e.n,e.e)},a(null,e.keys)}}function hr(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var a=Ce.util.hexToBytes(t);return a.length>1&&(a.charCodeAt(0)===0&&!(a.charCodeAt(1)&128)||a.charCodeAt(0)===255&&(a.charCodeAt(1)&128)===128)?a.substr(1):a}function Ic(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function vs(e){return Ce.util.isNodejs&&typeof Fi[e]=="function"}function gs(e){return typeof er.globalScope<"u"&&typeof er.globalScope.crypto=="object"&&typeof er.globalScope.crypto.subtle=="object"&&typeof er.globalScope.crypto.subtle[e]=="function"}function ys(e){return typeof er.globalScope<"u"&&typeof er.globalScope.msCrypto=="object"&&typeof er.globalScope.msCrypto.subtle=="object"&&typeof er.globalScope.msCrypto.subtle[e]=="function"}function xs(e){for(var t=Ce.util.hexToBytes(e.toString(16)),a=new Uint8Array(t.length),r=0;r<t.length;++r)a[r]=t.charCodeAt(r);return a}var pe=Oe;if(typeof wc>"u")var wc=pe.jsbn.BigInteger;var Z=pe.asn1,Le=pe.pki=pe.pki||{};Le.pbe=pe.pbe=pe.pbe||{};var Xr=Le.oids,kc={name:"EncryptedPrivateKeyInfo",tagClass:Z.Class.UNIVERSAL,type:Z.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:Z.Class.UNIVERSAL,type:Z.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Z.Class.UNIVERSAL,type:Z.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:Z.Class.UNIVERSAL,type:Z.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:Z.Class.UNIVERSAL,type:Z.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Nc={name:"PBES2Algorithms",tagClass:Z.Class.UNIVERSAL,type:Z.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:Z.Class.UNIVERSAL,type:Z.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:Z.Class.UNIVERSAL,type:Z.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:Z.Class.UNIVERSAL,type:Z.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:Z.Class.UNIVERSAL,type:Z.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:Z.Class.UNIVERSAL,type:Z.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:Z.Class.UNIVERSAL,type:Z.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:Z.Class.UNIVERSAL,type:Z.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:Z.Class.UNIVERSAL,type:Z.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:Z.Class.UNIVERSAL,type:Z.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:Z.Class.UNIVERSAL,type:Z.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:Z.Class.UNIVERSAL,type:Z.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Rc={name:"pkcs-12PbeParams",tagClass:Z.Class.UNIVERSAL,type:Z.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:Z.Class.UNIVERSAL,type:Z.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:Z.Class.UNIVERSAL,type:Z.Type.INTEGER,constructed:!1,capture:"iterations"}]};Le.encryptPrivateKeyInfo=function(e,t,a){a=a||{},a.saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||"aes128",a.prfAlgorithm=a.prfAlgorithm||"sha1";var r=pe.random.getBytesSync(a.saltSize),n=a.count,i=Z.integerToDer(n),s,o,f;if(a.algorithm.indexOf("aes")===0||a.algorithm==="des"){var l,u,c;switch(a.algorithm){case"aes128":s=16,l=16,u=Xr["aes128-CBC"],c=pe.aes.createEncryptionCipher;break;case"aes192":s=24,l=16,u=Xr["aes192-CBC"],c=pe.aes.createEncryptionCipher;break;case"aes256":s=32,l=16,u=Xr["aes256-CBC"],c=pe.aes.createEncryptionCipher;break;case"des":s=8,l=8,u=Xr.desCBC,c=pe.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=a.algorithm,d}var h="hmacWith"+a.prfAlgorithm.toUpperCase(),p=wo(h),v=pe.pkcs5.pbkdf2(t,r,n,s,p),g=pe.random.getBytesSync(l),C=c(v);C.start(g),C.update(Z.toDer(e)),C.finish(),f=C.output.getBytes();var x=Lc(r,i,s,h);o=Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(Xr.pkcs5PBES2).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(Xr.pkcs5PBKDF2).getBytes()),x]),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(u).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,g)])])])}else if(a.algorithm==="3des"){s=24;var y=new pe.util.ByteBuffer(r),v=Le.pbe.generatePkcs12Key(t,y,1,n,s),g=Le.pbe.generatePkcs12Key(t,y,2,n,s),C=pe.des.createEncryptionCipher(v);C.start(g),C.update(Z.toDer(e)),C.finish(),f=C.output.getBytes(),o=Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(Xr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,r),Z.create(Z.Class.UNIVERSAL,Z.Type.INTEGER,!1,i.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=a.algorithm,d}var S=Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[o,Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,f)]);return S};Le.decryptPrivateKeyInfo=function(e,t){var a=null,r={},n=[];if(!Z.validate(e,kc,r,n)){var i=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=n,i}var s=Z.derToOid(r.encryptionOid),o=Le.pbe.getCipher(s,r.encryptionParams,t),f=pe.util.createBuffer(r.encryptedData);return o.update(f),o.finish()&&(a=Z.fromDer(o.output)),a};Le.encryptedPrivateKeyToPem=function(e,t){var a={type:"ENCRYPTED PRIVATE KEY",body:Z.toDer(e).getBytes()};return pe.pem.encode(a,{maxline:t})};Le.encryptedPrivateKeyFromPem=function(e){var t=pe.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var a=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return Z.fromDer(t.body)};Le.encryptRsaPrivateKey=function(e,t,a){if(a=a||{},!a.legacy){var r=Le.wrapRsaPrivateKey(Le.privateKeyToAsn1(e));return r=Le.encryptPrivateKeyInfo(r,t,a),Le.encryptedPrivateKeyToPem(r)}var n,i,s,o;switch(a.algorithm){case"aes128":n="AES-128-CBC",s=16,i=pe.random.getBytesSync(16),o=pe.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",s=24,i=pe.random.getBytesSync(16),o=pe.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",s=32,i=pe.random.getBytesSync(16),o=pe.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",s=24,i=pe.random.getBytesSync(8),o=pe.des.createEncryptionCipher;break;case"des":n="DES-CBC",s=8,i=pe.random.getBytesSync(8),o=pe.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+a.algorithm+'".');throw f.algorithm=a.algorithm,f}var l=pe.pbe.opensslDeriveBytes(t,i.substr(0,8),s),u=o(l);u.start(i),u.update(Z.toDer(Le.privateKeyToAsn1(e))),u.finish();var c={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:pe.util.bytesToHex(i).toUpperCase()},body:u.output.getBytes()};return pe.pem.encode(c)};Le.decryptRsaPrivateKey=function(e,t){var a=null,r=pe.pem.decode(e)[0];if(r.type!=="ENCRYPTED PRIVATE KEY"&&r.type!=="PRIVATE KEY"&&r.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(r.procType&&r.procType.type==="ENCRYPTED"){var i,s;switch(r.dekInfo.algorithm){case"DES-CBC":i=8,s=pe.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,s=pe.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,s=pe.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,s=pe.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,s=pe.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,s=function(c){return pe.rc2.createDecryptionCipher(c,40)};break;case"RC2-64-CBC":i=8,s=function(c){return pe.rc2.createDecryptionCipher(c,64)};break;case"RC2-128-CBC":i=16,s=function(c){return pe.rc2.createDecryptionCipher(c,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+r.dekInfo.algorithm+'".');throw n.algorithm=r.dekInfo.algorithm,n}var o=pe.util.hexToBytes(r.dekInfo.parameters),f=pe.pbe.opensslDeriveBytes(t,o.substr(0,8),i),l=s(f);if(l.start(o),l.update(pe.util.createBuffer(r.body)),l.finish())a=l.output.getBytes();else return a}else a=r.body;return r.type==="ENCRYPTED PRIVATE KEY"?a=Le.decryptPrivateKeyInfo(Z.fromDer(a),t):a=Z.fromDer(a),a!==null&&(a=Le.privateKeyFromAsn1(a)),a};Le.pbe.generatePkcs12Key=function(e,t,a,r,n,i){var s,o;if(typeof i>"u"||i===null){if(!("sha1"in pe.md))throw new Error('"sha1" hash algorithm unavailable.');i=pe.md.sha1.create()}var f=i.digestLength,l=i.blockLength,u=new pe.util.ByteBuffer,c=new pe.util.ByteBuffer;if(e!=null){for(o=0;o<e.length;o++)c.putInt16(e.charCodeAt(o));c.putInt16(0)}var d=c.length(),h=t.length(),p=new pe.util.ByteBuffer;p.fillWithByte(a,l);var v=l*Math.ceil(h/l),g=new pe.util.ByteBuffer;for(o=0;o<v;o++)g.putByte(t.at(o%h));var C=l*Math.ceil(d/l),x=new pe.util.ByteBuffer;for(o=0;o<C;o++)x.putByte(c.at(o%d));var y=g;y.putBuffer(x);for(var S=Math.ceil(n/f),T=1;T<=S;T++){var A=new pe.util.ByteBuffer;A.putBytes(p.bytes()),A.putBytes(y.bytes());for(var k=0;k<r;k++)i.start(),i.update(A.getBytes()),A=i.digest();var B=new pe.util.ByteBuffer;for(o=0;o<l;o++)B.putByte(A.at(o%f));var O=Math.ceil(h/l)+Math.ceil(d/l),I=new pe.util.ByteBuffer;for(s=0;s<O;s++){var w=new pe.util.ByteBuffer(y.getBytes(l)),P=511;for(o=B.length()-1;o>=0;o--)P=P>>8,P+=B.at(o)+w.at(o),w.setAt(o,P&255);I.putBuffer(w)}y=I,u.putBuffer(A)}return u.truncate(u.length()-n),u};Le.pbe.getCipher=function(e,t,a){switch(e){case Le.oids.pkcs5PBES2:return Le.pbe.getCipherForPBES2(e,t,a);case Le.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Le.oids["pbewithSHAAnd40BitRC2-CBC"]:return Le.pbe.getCipherForPKCS12PBE(e,t,a);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=e,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}};Le.pbe.getCipherForPBES2=function(e,t,a){var r={},n=[];if(!Z.validate(t,Nc,r,n)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=n,i}if(e=Z.derToOid(r.kdfOid),e!==Le.oids.pkcs5PBKDF2){var i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw i.oid=e,i.supportedOids=["pkcs5PBKDF2"],i}if(e=Z.derToOid(r.encOid),e!==Le.oids["aes128-CBC"]&&e!==Le.oids["aes192-CBC"]&&e!==Le.oids["aes256-CBC"]&&e!==Le.oids["des-EDE3-CBC"]&&e!==Le.oids.desCBC){var i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw i.oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i}var s=r.kdfSalt,o=pe.util.createBuffer(r.kdfIterationCount);o=o.getInt(o.length()<<3);var f,l;switch(Le.oids[e]){case"aes128-CBC":f=16,l=pe.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,l=pe.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,l=pe.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,l=pe.des.createDecryptionCipher;break;case"desCBC":f=8,l=pe.des.createDecryptionCipher;break}var u=Io(r.prfOid),c=pe.pkcs5.pbkdf2(a,s,o,f,u),d=r.encIv,h=l(c);return h.start(d),h};Le.pbe.getCipherForPKCS12PBE=function(e,t,a){var r={},n=[];if(!Z.validate(t,Rc,r,n)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=n,i}var s=pe.util.createBuffer(r.salt),o=pe.util.createBuffer(r.iterations);o=o.getInt(o.length()<<3);var f,l,u;switch(e){case Le.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,l=8,u=pe.des.startDecrypting;break;case Le.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,l=8,u=function(v,g){var C=pe.rc2.createDecryptionCipher(v,40);return C.start(g,null),C};break;default:var i=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw i.oid=e,i}var c=Io(r.prfOid),d=Le.pbe.generatePkcs12Key(a,s,1,o,f,c);c.start();var h=Le.pbe.generatePkcs12Key(a,s,2,o,l,c);return u(d,h)};Le.pbe.opensslDeriveBytes=function(e,t,a,r){if(typeof r>"u"||r===null){if(!("md5"in pe.md))throw new Error('"md5" hash algorithm unavailable.');r=pe.md.md5.create()}t===null&&(t="");for(var n=[ms(r,e+t)],i=16,s=1;i<a;++s,i+=16)n.push(ms(r,n[s-1]+e+t));return n.join("").substr(0,a)};function ms(e,t){return e.start().update(t).digest().getBytes()}function Io(e){var t;if(!e)t="hmacWithSHA1";else if(t=Le.oids[Z.derToOid(e)],!t){var a=new Error("Unsupported PRF OID.");throw a.oid=e,a.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],a}return wo(t)}function wo(e){var t=pe.md;switch(e){case"hmacWithSHA224":t=pe.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var a=new Error("Unsupported PRF algorithm.");throw a.algorithm=e,a.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],a}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function Lc(e,t,a,r){var n=Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,e),Z.create(Z.Class.UNIVERSAL,Z.Type.INTEGER,!1,t.getBytes())]);return r!=="hmacWithSHA1"&&n.value.push(Z.create(Z.Class.UNIVERSAL,Z.Type.INTEGER,!1,pe.util.hexToBytes(a.toString(16))),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(Le.oids[r]).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.NULL,!1,"")])),n}var ma=Oe,ce=ma.asn1,Ia=ma.pkcs7asn1=ma.pkcs7asn1||{};ma.pkcs7=ma.pkcs7||{};ma.pkcs7.asn1=Ia;var ko={name:"ContentInfo",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:ce.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};Ia.contentInfoValidator=ko;var No={name:"EncryptedContentInfo",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:ce.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:ce.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};Ia.envelopedDataValidator={name:"EnvelopedData",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(No)};Ia.encryptedDataValidator={name:"EncryptedData",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"version"}].concat(No)};var Dc={name:"SignerInfo",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:ce.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:ce.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:ce.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};Ia.signedDataValidator={name:"SignedData",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},ko,{name:"SignedData.Certificates",tagClass:ce.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:ce.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SET,capture:"signerInfos",optional:!0,value:[Dc]}]};Ia.recipientInfoValidator={name:"RecipientInfo",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:ce.Class.UNIVERSAL,type:ce.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:ce.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:ce.Class.UNIVERSAL,type:ce.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]};var sa=Oe;sa.mgf=sa.mgf||{};var Pc=sa.mgf.mgf1=sa.mgf1=sa.mgf1||{};Pc.create=function(e){var t={generate:function(a,r){for(var n=new sa.util.ByteBuffer,i=Math.ceil(r/e.digestLength),s=0;s<i;s++){var o=new sa.util.ByteBuffer;o.putInt32(s),e.start(),e.update(a+o.getBytes()),n.putBuffer(e.digest())}return n.truncate(n.length()-r),n.getBytes()}};return t};var mn=Oe;mn.mgf=mn.mgf||{};mn.mgf.mgf1=mn.mgf1;var Zr=Oe,Uc=Zr.pss=Zr.pss||{};Uc.create=function(e){arguments.length===3&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t=e.md,a=e.mgf,r=t.digestLength,n=e.salt||null;typeof n=="string"&&(n=Zr.util.createBuffer(n));var i;if("saltLength"in e)i=e.saltLength;else if(n!==null)i=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==i)throw new Error("Given salt length does not match length of given salt.");var s=e.prng||Zr.random,o={};return o.encode=function(f,l){var u,c=l-1,d=Math.ceil(c/8),h=f.digest().getBytes();if(d<r+i+2)throw new Error("Message is too long to encrypt.");var p;n===null?p=s.getBytesSync(i):p=n.bytes();var v=new Zr.util.ByteBuffer;v.fillWithByte(0,8),v.putBytes(h),v.putBytes(p),t.start(),t.update(v.getBytes());var g=t.digest().getBytes(),C=new Zr.util.ByteBuffer;C.fillWithByte(0,d-i-r-2),C.putByte(1),C.putBytes(p);var x=C.getBytes(),y=d-r-1,S=a.generate(g,y),T="";for(u=0;u<y;u++)T+=String.fromCharCode(x.charCodeAt(u)^S.charCodeAt(u));var A=65280>>8*d-c&255;return T=String.fromCharCode(T.charCodeAt(0)&~A)+T.substr(1),T+g+String.fromCharCode(188)},o.verify=function(f,l,u){var c,d=u-1,h=Math.ceil(d/8);if(l=l.substr(-h),h<r+i+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(l.charCodeAt(h-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var p=h-r-1,v=l.substr(0,p),g=l.substr(p,r),C=65280>>8*h-d&255;if(v.charCodeAt(0)&C)throw new Error("Bits beyond keysize not zero as expected.");var x=a.generate(g,p),y="";for(c=0;c<p;c++)y+=String.fromCharCode(v.charCodeAt(c)^x.charCodeAt(c));y=String.fromCharCode(y.charCodeAt(0)&~C)+y.substr(1);var S=h-r-i-2;for(c=0;c<S;c++)if(y.charCodeAt(c)!==0)throw new Error("Leftmost octets not zero as expected");if(y.charCodeAt(S)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var T=y.substr(-i),A=new Zr.util.ByteBuffer;A.fillWithByte(0,8),A.putBytes(f),A.putBytes(T),t.start(),t.update(A.getBytes());var k=t.digest().getBytes();return g===k},o};var Ee=Oe,E=Ee.asn1,ie=Ee.pki=Ee.pki||{},Ge=ie.oids,ht={};ht.CN=Ge.commonName;ht.commonName="CN";ht.C=Ge.countryName;ht.countryName="C";ht.L=Ge.localityName;ht.localityName="L";ht.ST=Ge.stateOrProvinceName;ht.stateOrProvinceName="ST";ht.O=Ge.organizationName;ht.organizationName="O";ht.OU=Ge.organizationalUnitName;ht.organizationalUnitName="OU";ht.E=Ge.emailAddress;ht.emailAddress="E";var Ro=Ee.pki.rsa.publicKeyValidator,Oc={name:"Certificate",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:E.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:E.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:E.Class.UNIVERSAL,type:E.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:E.Class.UNIVERSAL,type:E.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:E.Class.UNIVERSAL,type:E.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:E.Class.UNIVERSAL,type:E.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Ro,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:E.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:E.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:E.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:E.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},Vc={name:"rsapss",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:E.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:E.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:E.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:E.Class.UNIVERSAL,type:E.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:E.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:E.Class.UNIVERSAL,type:E.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},Fc={name:"CertificationRequestInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Ro,{name:"CertificationRequestInfo.attributes",tagClass:E.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:E.Class.UNIVERSAL,type:E.Type.SET,constructed:!0}]}]}]},Mc={name:"CertificationRequest",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[Fc,{name:"CertificationRequest.signatureAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:E.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};ie.RDNAttributesAsArray=function(e,t){for(var a=[],r,n,i,s=0;s<e.value.length;++s){r=e.value[s];for(var o=0;o<r.value.length;++o)i={},n=r.value[o],i.type=E.derToOid(n.value[0].value),i.value=n.value[1].value,i.valueTagClass=n.value[1].type,i.type in Ge&&(i.name=Ge[i.type],i.name in ht&&(i.shortName=ht[i.name])),t&&(t.update(i.type),t.update(i.value)),a.push(i)}return a};ie.CRIAttributesAsArray=function(e){for(var t=[],a=0;a<e.length;++a)for(var r=e[a],n=E.derToOid(r.value[0].value),i=r.value[1].value,s=0;s<i.length;++s){var o={};if(o.type=n,o.value=i[s].value,o.valueTagClass=i[s].type,o.type in Ge&&(o.name=Ge[o.type],o.name in ht&&(o.shortName=ht[o.name])),o.type===Ge.extensionRequest){o.extensions=[];for(var f=0;f<o.value.length;++f)o.extensions.push(ie.certificateExtensionFromAsn1(o.value[f]))}t.push(o)}return t};function Qr(e,t){typeof t=="string"&&(t={shortName:t});for(var a=null,r,n=0;a===null&&n<e.attributes.length;++n)r=e.attributes[n],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(a=r);return a}var Cn=function(e,t,a){var r={};if(e!==Ge["RSASSA-PSS"])return r;a&&(r={hash:{algorithmOid:Ge.sha1},mgf:{algorithmOid:Ge.mgf1,hash:{algorithmOid:Ge.sha1}},saltLength:20});var n={},i=[];if(!E.validate(t,Vc,n,i)){var s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=i,s}return n.hashOid!==void 0&&(r.hash=r.hash||{},r.hash.algorithmOid=E.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=E.derToOid(n.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=E.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(r.saltLength=n.saltLength.charCodeAt(0)),r},Un=function(e){switch(Ge[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return Ee.md.sha1.create();case"md5WithRSAEncryption":return Ee.md.md5.create();case"sha256WithRSAEncryption":return Ee.md.sha256.create();case"sha384WithRSAEncryption":return Ee.md.sha384.create();case"sha512WithRSAEncryption":return Ee.md.sha512.create();case"RSASSA-PSS":return Ee.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},Lo=function(e){var t=e.certificate,a;switch(t.signatureOid){case Ge.sha1WithRSAEncryption:case Ge.sha1WithRSASignature:break;case Ge["RSASSA-PSS"]:var r,n;if(r=Ge[t.signatureParameters.mgf.hash.algorithmOid],r===void 0||Ee.md[r]===void 0){var i=new Error("Unsupported MGF hash function.");throw i.oid=t.signatureParameters.mgf.hash.algorithmOid,i.name=r,i}if(n=Ge[t.signatureParameters.mgf.algorithmOid],n===void 0||Ee.mgf[n]===void 0){var i=new Error("Unsupported MGF function.");throw i.oid=t.signatureParameters.mgf.algorithmOid,i.name=n,i}if(n=Ee.mgf[n].create(Ee.md[r].create()),r=Ge[t.signatureParameters.hash.algorithmOid],r===void 0||Ee.md[r]===void 0){var i=new Error("Unsupported RSASSA-PSS hash function.");throw i.oid=t.signatureParameters.hash.algorithmOid,i.name=r,i}a=Ee.pss.create(Ee.md[r].create(),n,t.signatureParameters.saltLength);break}return t.publicKey.verify(e.md.digest().getBytes(),e.signature,a)};ie.certificateFromPem=function(e,t,a){var r=Ee.pem.decode(e)[0];if(r.type!=="CERTIFICATE"&&r.type!=="X509 CERTIFICATE"&&r.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=r.type,n}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var i=E.fromDer(r.body,a);return ie.certificateFromAsn1(i,t)};ie.certificateToPem=function(e,t){var a={type:"CERTIFICATE",body:E.toDer(ie.certificateToAsn1(e)).getBytes()};return Ee.pem.encode(a,{maxline:t})};ie.publicKeyFromPem=function(e){var t=Ee.pem.decode(e)[0];if(t.type!=="PUBLIC KEY"&&t.type!=="RSA PUBLIC KEY"){var a=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=E.fromDer(t.body);return ie.publicKeyFromAsn1(r)};ie.publicKeyToPem=function(e,t){var a={type:"PUBLIC KEY",body:E.toDer(ie.publicKeyToAsn1(e)).getBytes()};return Ee.pem.encode(a,{maxline:t})};ie.publicKeyToRSAPublicKeyPem=function(e,t){var a={type:"RSA PUBLIC KEY",body:E.toDer(ie.publicKeyToRSAPublicKey(e)).getBytes()};return Ee.pem.encode(a,{maxline:t})};ie.getPublicKeyFingerprint=function(e,t){t=t||{};var a=t.md||Ee.md.sha1.create(),r=t.type||"RSAPublicKey",n;switch(r){case"RSAPublicKey":n=E.toDer(ie.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":n=E.toDer(ie.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}a.start(),a.update(n);var i=a.digest();if(t.encoding==="hex"){var s=i.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return i.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return i};ie.certificationRequestFromPem=function(e,t,a){var r=Ee.pem.decode(e)[0];if(r.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=r.type,n}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var i=E.fromDer(r.body,a);return ie.certificationRequestFromAsn1(i,t)};ie.certificationRequestToPem=function(e,t){var a={type:"CERTIFICATE REQUEST",body:E.toDer(ie.certificationRequestToAsn1(e)).getBytes()};return Ee.pem.encode(a,{maxline:t})};ie.createCertificate=function(){var e={};return e.version=2,e.serialNumber="00",e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return Qr(e.issuer,t)},e.issuer.addField=function(t){tr([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return Qr(e.subject,t)},e.subject.addField=function(t){tr([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,a){tr(t),e.subject.attributes=t,delete e.subject.uniqueId,a&&(e.subject.uniqueId=a),e.subject.hash=null},e.setIssuer=function(t,a){tr(t),e.issuer.attributes=t,delete e.issuer.uniqueId,a&&(e.issuer.uniqueId=a),e.issuer.hash=null},e.setExtensions=function(t){for(var a=0;a<t.length;++a)Do(t[a],{cert:e});e.extensions=t},e.getExtension=function(t){typeof t=="string"&&(t={name:t});for(var a=null,r,n=0;a===null&&n<e.extensions.length;++n)r=e.extensions[n],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(a=r);return a},e.sign=function(t,a){e.md=a||Ee.md.sha1.create();var r=Ge[e.md.algorithm+"WithRSAEncryption"];if(!r){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=e.md.algorithm,n}e.signatureOid=e.siginfo.algorithmOid=r,e.tbsCertificate=ie.getTBSCertificate(e);var i=E.toDer(e.tbsCertificate);e.md.update(i.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var a=!1;if(!e.issued(t)){var r=t.issuer,n=e.subject,i=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw i.expectedIssuer=n.attributes,i.actualIssuer=r.attributes,i}var s=t.md;if(s===null){s=Un({signatureOid:t.signatureOid,type:"certificate"});var o=t.tbsCertificate||ie.getTBSCertificate(t),f=E.toDer(o);s.update(f.getBytes())}return s!==null&&(a=Lo({certificate:e,md:s,signature:t.signature})),a},e.isIssuer=function(t){var a=!1,r=e.issuer,n=t.subject;if(r.hash&&n.hash)a=r.hash===n.hash;else if(r.attributes.length===n.attributes.length){a=!0;for(var i,s,o=0;a&&o<r.attributes.length;++o)i=r.attributes[o],s=n.attributes[o],(i.type!==s.type||i.value!==s.value)&&(a=!1)}return a},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return ie.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=Ge.subjectKeyIdentifier,a=0;a<e.extensions.length;++a){var r=e.extensions[a];if(r.id===t){var n=e.generateSubjectKeyIdentifier().getBytes();return Ee.util.hexToBytes(r.subjectKeyIdentifier)===n}}return!1},e};ie.certificateFromAsn1=function(e,t){var a={},r=[];if(!E.validate(e,Oc,a,r)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=r,n}var i=E.derToOid(a.publicKeyOid);if(i!==ie.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=ie.createCertificate();s.version=a.certVersion?a.certVersion.charCodeAt(0):0;var o=Ee.util.createBuffer(a.certSerialNumber);s.serialNumber=o.toHex(),s.signatureOid=Ee.asn1.derToOid(a.certSignatureOid),s.signatureParameters=Cn(s.signatureOid,a.certSignatureParams,!0),s.siginfo.algorithmOid=Ee.asn1.derToOid(a.certinfoSignatureOid),s.siginfo.parameters=Cn(s.siginfo.algorithmOid,a.certinfoSignatureParams,!1),s.signature=a.certSignature;var f=[];if(a.certValidity1UTCTime!==void 0&&f.push(E.utcTimeToDate(a.certValidity1UTCTime)),a.certValidity2GeneralizedTime!==void 0&&f.push(E.generalizedTimeToDate(a.certValidity2GeneralizedTime)),a.certValidity3UTCTime!==void 0&&f.push(E.utcTimeToDate(a.certValidity3UTCTime)),a.certValidity4GeneralizedTime!==void 0&&f.push(E.generalizedTimeToDate(a.certValidity4GeneralizedTime)),f.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(f.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(s.validity.notBefore=f[0],s.validity.notAfter=f[1],s.tbsCertificate=a.tbsCertificate,t){s.md=Un({signatureOid:s.signatureOid,type:"certificate"});var l=E.toDer(s.tbsCertificate);s.md.update(l.getBytes())}var u=Ee.md.sha1.create(),c=E.toDer(a.certIssuer);u.update(c.getBytes()),s.issuer.getField=function(p){return Qr(s.issuer,p)},s.issuer.addField=function(p){tr([p]),s.issuer.attributes.push(p)},s.issuer.attributes=ie.RDNAttributesAsArray(a.certIssuer),a.certIssuerUniqueId&&(s.issuer.uniqueId=a.certIssuerUniqueId),s.issuer.hash=u.digest().toHex();var d=Ee.md.sha1.create(),h=E.toDer(a.certSubject);return d.update(h.getBytes()),s.subject.getField=function(p){return Qr(s.subject,p)},s.subject.addField=function(p){tr([p]),s.subject.attributes.push(p)},s.subject.attributes=ie.RDNAttributesAsArray(a.certSubject),a.certSubjectUniqueId&&(s.subject.uniqueId=a.certSubjectUniqueId),s.subject.hash=d.digest().toHex(),a.certExtensions?s.extensions=ie.certificateExtensionsFromAsn1(a.certExtensions):s.extensions=[],s.publicKey=ie.publicKeyFromAsn1(a.subjectPublicKeyInfo),s};ie.certificateExtensionsFromAsn1=function(e){for(var t=[],a=0;a<e.value.length;++a)for(var r=e.value[a],n=0;n<r.value.length;++n)t.push(ie.certificateExtensionFromAsn1(r.value[n]));return t};ie.certificateExtensionFromAsn1=function(e){var t={};if(t.id=E.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===E.Type.BOOLEAN?(t.critical=e.value[1].value.charCodeAt(0)!==0,t.value=e.value[2].value):t.value=e.value[1].value,t.id in Ge){if(t.name=Ge[t.id],t.name==="keyUsage"){var a=E.fromDer(t.value),r=0,n=0;a.value.length>1&&(r=a.value.charCodeAt(1),n=a.value.length>2?a.value.charCodeAt(2):0),t.digitalSignature=(r&128)===128,t.nonRepudiation=(r&64)===64,t.keyEncipherment=(r&32)===32,t.dataEncipherment=(r&16)===16,t.keyAgreement=(r&8)===8,t.keyCertSign=(r&4)===4,t.cRLSign=(r&2)===2,t.encipherOnly=(r&1)===1,t.decipherOnly=(n&128)===128}else if(t.name==="basicConstraints"){var a=E.fromDer(t.value);a.value.length>0&&a.value[0].type===E.Type.BOOLEAN?t.cA=a.value[0].value.charCodeAt(0)!==0:t.cA=!1;var i=null;a.value.length>0&&a.value[0].type===E.Type.INTEGER?i=a.value[0].value:a.value.length>1&&(i=a.value[1].value),i!==null&&(t.pathLenConstraint=E.derToInteger(i))}else if(t.name==="extKeyUsage")for(var a=E.fromDer(t.value),s=0;s<a.value.length;++s){var o=E.derToOid(a.value[s].value);o in Ge?t[Ge[o]]=!0:t[o]=!0}else if(t.name==="nsCertType"){var a=E.fromDer(t.value),r=0;a.value.length>1&&(r=a.value.charCodeAt(1)),t.client=(r&128)===128,t.server=(r&64)===64,t.email=(r&32)===32,t.objsign=(r&16)===16,t.reserved=(r&8)===8,t.sslCA=(r&4)===4,t.emailCA=(r&2)===2,t.objCA=(r&1)===1}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.altNames=[];for(var f,a=E.fromDer(t.value),l=0;l<a.value.length;++l){f=a.value[l];var u={type:f.type,value:f.value};switch(t.altNames.push(u),f.type){case 1:case 2:case 6:break;case 7:u.ip=Ee.util.bytesToIP(f.value);break;case 8:u.oid=E.derToOid(f.value);break}}}else if(t.name==="subjectKeyIdentifier"){var a=E.fromDer(t.value);t.subjectKeyIdentifier=Ee.util.bytesToHex(a.value)}}return t};ie.certificationRequestFromAsn1=function(e,t){var a={},r=[];if(!E.validate(e,Mc,a,r)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=r,n}var i=E.derToOid(a.publicKeyOid);if(i!==ie.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=ie.createCertificationRequest();if(s.version=a.csrVersion?a.csrVersion.charCodeAt(0):0,s.signatureOid=Ee.asn1.derToOid(a.csrSignatureOid),s.signatureParameters=Cn(s.signatureOid,a.csrSignatureParams,!0),s.siginfo.algorithmOid=Ee.asn1.derToOid(a.csrSignatureOid),s.siginfo.parameters=Cn(s.siginfo.algorithmOid,a.csrSignatureParams,!1),s.signature=a.csrSignature,s.certificationRequestInfo=a.certificationRequestInfo,t){s.md=Un({signatureOid:s.signatureOid,type:"certification request"});var o=E.toDer(s.certificationRequestInfo);s.md.update(o.getBytes())}var f=Ee.md.sha1.create();return s.subject.getField=function(l){return Qr(s.subject,l)},s.subject.addField=function(l){tr([l]),s.subject.attributes.push(l)},s.subject.attributes=ie.RDNAttributesAsArray(a.certificationRequestInfoSubject,f),s.subject.hash=f.digest().toHex(),s.publicKey=ie.publicKeyFromAsn1(a.subjectPublicKeyInfo),s.getAttribute=function(l){return Qr(s,l)},s.addAttribute=function(l){tr([l]),s.attributes.push(l)},s.attributes=ie.CRIAttributesAsArray(a.certificationRequestInfoAttributes||[]),s};ie.createCertificationRequest=function(){var e={};return e.version=0,e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return Qr(e.subject,t)},e.subject.addField=function(t){tr([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return Qr(e,t)},e.addAttribute=function(t){tr([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){tr(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){tr(t),e.attributes=t},e.sign=function(t,a){e.md=a||Ee.md.sha1.create();var r=Ge[e.md.algorithm+"WithRSAEncryption"];if(!r){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=e.md.algorithm,n}e.signatureOid=e.siginfo.algorithmOid=r,e.certificationRequestInfo=ie.getCertificationRequestInfo(e);var i=E.toDer(e.certificationRequestInfo);e.md.update(i.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,a=e.md;if(a===null){a=Un({signatureOid:e.signatureOid,type:"certification request"});var r=e.certificationRequestInfo||ie.getCertificationRequestInfo(e),n=E.toDer(r);a.update(n.getBytes())}return a!==null&&(t=Lo({certificate:e,md:a,signature:e.signature})),t},e};function Ca(e){for(var t=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),a,r,n=e.attributes,i=0;i<n.length;++i){a=n[i];var s=a.value,o=E.Type.PRINTABLESTRING;"valueTagClass"in a&&(o=a.valueTagClass,o===E.Type.UTF8&&(s=Ee.util.encodeUtf8(s))),r=E.create(E.Class.UNIVERSAL,E.Type.SET,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(a.type).getBytes()),E.create(E.Class.UNIVERSAL,o,!1,s)])]),t.value.push(r)}return t}function tr(e){for(var t,a=0;a<e.length;++a){if(t=e[a],typeof t.name>"u"&&(t.type&&t.type in ie.oids?t.name=ie.oids[t.type]:t.shortName&&t.shortName in ht&&(t.name=ie.oids[ht[t.shortName]])),typeof t.type>"u")if(t.name&&t.name in ie.oids)t.type=ie.oids[t.name];else{var r=new Error("Attribute type not specified.");throw r.attribute=t,r}if(typeof t.shortName>"u"&&t.name&&t.name in ht&&(t.shortName=ht[t.name]),t.type===Ge.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=E.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(ie.certificateExtensionToAsn1(Do(t.extensions[n])))}if(typeof t.value>"u"){var r=new Error("Attribute value not specified.");throw r.attribute=t,r}}}function Do(e,t){if(t=t||{},typeof e.name>"u"&&e.id&&e.id in ie.oids&&(e.name=ie.oids[e.id]),typeof e.id>"u")if(e.name&&e.name in ie.oids)e.id=ie.oids[e.name];else{var a=new Error("Extension ID not specified.");throw a.extension=e,a}if(typeof e.value<"u")return e;if(e.name==="keyUsage"){var r=0,n=0,i=0;e.digitalSignature&&(n|=128,r=7),e.nonRepudiation&&(n|=64,r=6),e.keyEncipherment&&(n|=32,r=5),e.dataEncipherment&&(n|=16,r=4),e.keyAgreement&&(n|=8,r=3),e.keyCertSign&&(n|=4,r=2),e.cRLSign&&(n|=2,r=1),e.encipherOnly&&(n|=1,r=0),e.decipherOnly&&(i|=128,r=7);var s=String.fromCharCode(r);i!==0?s+=String.fromCharCode(n)+String.fromCharCode(i):n!==0&&(s+=String.fromCharCode(n)),e.value=E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,s)}else if(e.name==="basicConstraints")e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(E.create(E.Class.UNIVERSAL,E.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(e.pathLenConstraint).getBytes()));else if(e.name==="extKeyUsage"){e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);var o=e.value.value;for(var f in e)e[f]===!0&&(f in Ge?o.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Ge[f]).getBytes())):f.indexOf(".")!==-1&&o.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(f).getBytes())))}else if(e.name==="nsCertType"){var r=0,n=0;e.client&&(n|=128,r=7),e.server&&(n|=64,r=6),e.email&&(n|=32,r=5),e.objsign&&(n|=16,r=4),e.reserved&&(n|=8,r=3),e.sslCA&&(n|=4,r=2),e.emailCA&&(n|=2,r=1),e.objCA&&(n|=1,r=0);var s=String.fromCharCode(r);n!==0&&(s+=String.fromCharCode(n)),e.value=E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,s)}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);for(var l,u=0;u<e.altNames.length;++u){l=e.altNames[u];var s=l.value;if(l.type===7&&l.ip){if(s=Ee.util.bytesFromIP(l.ip),s===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=e,a}}else l.type===8&&(l.oid?s=E.oidToDer(E.oidToDer(l.oid)):s=E.oidToDer(s));e.value.value.push(E.create(E.Class.CONTEXT_SPECIFIC,l.type,!1,s))}}else if(e.name==="nsComment"&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=E.create(E.Class.UNIVERSAL,E.Type.IA5STRING,!1,e.comment)}else if(e.name==="subjectKeyIdentifier"&&t.cert){var c=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=c.toHex(),e.value=E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,c.getBytes())}else if(e.name==="authorityKeyIdentifier"&&t.cert){e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);var o=e.value.value;if(e.keyIdentifier){var d=e.keyIdentifier===!0?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;o.push(E.create(E.Class.CONTEXT_SPECIFIC,0,!1,d))}if(e.authorityCertIssuer){var h=[E.create(E.Class.CONTEXT_SPECIFIC,4,!0,[Ca(e.authorityCertIssuer===!0?t.cert.issuer:e.authorityCertIssuer)])];o.push(E.create(E.Class.CONTEXT_SPECIFIC,1,!0,h))}if(e.serialNumber){var p=Ee.util.hexToBytes(e.serialNumber===!0?t.cert.serialNumber:e.serialNumber);o.push(E.create(E.Class.CONTEXT_SPECIFIC,2,!1,p))}}else if(e.name==="cRLDistributionPoints"){e.value=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);for(var o=e.value.value,v=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),g=E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[]),l,u=0;u<e.altNames.length;++u){l=e.altNames[u];var s=l.value;if(l.type===7&&l.ip){if(s=Ee.util.bytesFromIP(l.ip),s===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=e,a}}else l.type===8&&(l.oid?s=E.oidToDer(E.oidToDer(l.oid)):s=E.oidToDer(s));g.value.push(E.create(E.Class.CONTEXT_SPECIFIC,l.type,!1,s))}v.value.push(E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[g])),o.push(v)}if(typeof e.value>"u"){var a=new Error("Extension value not specified.");throw a.extension=e,a}return e}function o0(e,t){switch(e){case Ge["RSASSA-PSS"]:var a=[];return t.hash.algorithmOid!==void 0&&a.push(E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.hash.algorithmOid).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])])),t.mgf.algorithmOid!==void 0&&a.push(E.create(E.Class.CONTEXT_SPECIFIC,1,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.mgf.algorithmOid).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(t.mgf.hash.algorithmOid).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])])])),t.saltLength!==void 0&&a.push(E.create(E.Class.CONTEXT_SPECIFIC,2,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(t.saltLength).getBytes())])),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,a);default:return E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")}}function Kc(e){var t=E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[]);if(e.attributes.length===0)return t;for(var a=e.attributes,r=0;r<a.length;++r){var n=a[r],i=n.value,s=E.Type.UTF8;"valueTagClass"in n&&(s=n.valueTagClass),s===E.Type.UTF8&&(i=Ee.util.encodeUtf8(i));var o=!1;"valueConstructed"in n&&(o=n.valueConstructed);var f=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(n.type).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SET,!0,[E.create(E.Class.UNIVERSAL,s,o,i)])]);t.value.push(f)}return t}var Hc=new Date("1950-01-01T00:00:00Z"),zc=new Date("2050-01-01T00:00:00Z");function Cs(e){return e>=Hc&&e<zc?E.create(E.Class.UNIVERSAL,E.Type.UTCTIME,!1,E.dateToUtcTime(e)):E.create(E.Class.UNIVERSAL,E.Type.GENERALIZEDTIME,!1,E.dateToGeneralizedTime(e))}ie.getTBSCertificate=function(e){var t=Cs(e.validity.notBefore),a=Cs(e.validity.notAfter),r=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.CONTEXT_SPECIFIC,0,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(e.version).getBytes())]),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,Ee.util.hexToBytes(e.serialNumber)),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.siginfo.algorithmOid).getBytes()),o0(e.siginfo.algorithmOid,e.siginfo.parameters)]),Ca(e.issuer),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[t,a]),Ca(e.subject),ie.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&r.value.push(E.create(E.Class.CONTEXT_SPECIFIC,1,!0,[E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&r.value.push(E.create(E.Class.CONTEXT_SPECIFIC,2,!0,[E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&r.value.push(ie.certificateExtensionsToAsn1(e.extensions)),r};ie.getCertificationRequestInfo=function(e){var t=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(e.version).getBytes()),Ca(e.subject),ie.publicKeyToAsn1(e.publicKey),Kc(e)]);return t};ie.distinguishedNameToAsn1=function(e){return Ca(e)};ie.certificateToAsn1=function(e){var t=e.tbsCertificate||ie.getTBSCertificate(e);return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[t,E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.signatureOid).getBytes()),o0(e.signatureOid,e.signatureParameters)]),E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};ie.certificateExtensionsToAsn1=function(e){var t=E.create(E.Class.CONTEXT_SPECIFIC,3,!0,[]),a=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);t.value.push(a);for(var r=0;r<e.length;++r)a.value.push(ie.certificateExtensionToAsn1(e[r]));return t};ie.certificateExtensionToAsn1=function(e){var t=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);t.value.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.id).getBytes())),e.critical&&t.value.push(E.create(E.Class.UNIVERSAL,E.Type.BOOLEAN,!1,String.fromCharCode(255)));var a=e.value;return typeof e.value!="string"&&(a=E.toDer(a).getBytes()),t.value.push(E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,a)),t};ie.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||ie.getCertificationRequestInfo(e);return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[t,E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(e.signatureOid).getBytes()),o0(e.signatureOid,e.signatureParameters)]),E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};ie.createCaStore=function(e){var t={certs:{}};t.getIssuer=function(s){var o=a(s.issuer);return o},t.addCertificate=function(s){if(typeof s=="string"&&(s=Ee.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))if(s.subject.hash in t.certs){var o=t.certs[s.subject.hash];Ee.util.isArray(o)||(o=[o]),o.push(s),t.certs[s.subject.hash]=o}else t.certs[s.subject.hash]=s},t.hasCertificate=function(s){typeof s=="string"&&(s=Ee.pki.certificateFromPem(s));var o=a(s.subject);if(!o)return!1;Ee.util.isArray(o)||(o=[o]);for(var f=E.toDer(ie.certificateToAsn1(s)).getBytes(),l=0;l<o.length;++l){var u=E.toDer(ie.certificateToAsn1(o[l])).getBytes();if(f===u)return!0}return!1},t.listAllCertificates=function(){var s=[];for(var o in t.certs)if(t.certs.hasOwnProperty(o)){var f=t.certs[o];if(!Ee.util.isArray(f))s.push(f);else for(var l=0;l<f.length;++l)s.push(f[l])}return s},t.removeCertificate=function(s){var o;if(typeof s=="string"&&(s=Ee.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))return null;var f=a(s.subject);if(!Ee.util.isArray(f))return o=t.certs[s.subject.hash],delete t.certs[s.subject.hash],o;for(var l=E.toDer(ie.certificateToAsn1(s)).getBytes(),u=0;u<f.length;++u){var c=E.toDer(ie.certificateToAsn1(f[u])).getBytes();l===c&&(o=f[u],f.splice(u,1))}return f.length===0&&delete t.certs[s.subject.hash],o};function a(s){return r(s),t.certs[s.hash]||null}function r(s){if(!s.hash){var o=Ee.md.sha1.create();s.attributes=ie.RDNAttributesAsArray(Ca(s),o),s.hash=o.digest().toHex()}}if(e)for(var n=0;n<e.length;++n){var i=e[n];t.addCertificate(i)}return t};ie.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};ie.verifyCertificateChain=function(e,t,a){typeof a=="function"&&(a={verify:a}),a=a||{},t=t.slice(0);var r=t.slice(0),n=a.validityCheckDate;typeof n>"u"&&(n=new Date);var i=!0,s=null,o=0;do{var f=t.shift(),l=null,u=!1;if(n&&(n<f.validity.notBefore||n>f.validity.notAfter)&&(s={message:"Certificate is not valid yet or has expired.",error:ie.certificateError.certificate_expired,notBefore:f.validity.notBefore,notAfter:f.validity.notAfter,now:n}),s===null){if(l=t[0]||e.getIssuer(f),l===null&&f.isIssuer(f)&&(u=!0,l=f),l){var c=l;Ee.util.isArray(c)||(c=[c]);for(var d=!1;!d&&c.length>0;){l=c.shift();try{d=l.verify(f)}catch{}}d||(s={message:"Certificate signature is invalid.",error:ie.certificateError.bad_certificate})}s===null&&(!l||u)&&!e.hasCertificate(f)&&(s={message:"Certificate is not trusted.",error:ie.certificateError.unknown_ca})}if(s===null&&l&&!f.isIssuer(l)&&(s={message:"Certificate issuer is invalid.",error:ie.certificateError.bad_certificate}),s===null)for(var h={keyUsage:!0,basicConstraints:!0},p=0;s===null&&p<f.extensions.length;++p){var v=f.extensions[p];v.critical&&!(v.name in h)&&(s={message:"Certificate has an unsupported critical extension.",error:ie.certificateError.unsupported_certificate})}if(s===null&&(!i||t.length===0&&(!l||u))){var g=f.getExtension("basicConstraints"),C=f.getExtension("keyUsage");if(C!==null&&(!C.keyCertSign||g===null)&&(s={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:ie.certificateError.bad_certificate}),s===null&&g!==null&&!g.cA&&(s={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:ie.certificateError.bad_certificate}),s===null&&C!==null&&"pathLenConstraint"in g){var x=o-1;x>g.pathLenConstraint&&(s={message:"Certificate basicConstraints pathLenConstraint violated.",error:ie.certificateError.bad_certificate})}}var y=s===null?!0:s.error,S=a.verify?a.verify(y,o,r):y;if(S===!0)s=null;else throw y===!0&&(s={message:"The application rejected the certificate.",error:ie.certificateError.bad_certificate}),(S||S===0)&&(typeof S=="object"&&!Ee.util.isArray(S)?(S.message&&(s.message=S.message),S.error&&(s.error=S.error)):typeof S=="string"&&(s.error=S)),s;i=!1,++o}while(t.length>0);return!0};var rt=Oe,D=rt.asn1,Fe=rt.pki,Qa=rt.pkcs12=rt.pkcs12||{},Po={name:"ContentInfo",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:D.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},qc={name:"PFX",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"version"},Po,{name:"PFX.macData",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:D.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:D.Class.UNIVERSAL,type:D.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:D.Class.UNIVERSAL,type:D.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},Gc={name:"SafeBag",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:D.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:D.Class.UNIVERSAL,type:D.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},Qc={name:"Attribute",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:D.Class.UNIVERSAL,type:D.Type.SET,constructed:!0,capture:"values"}]},Wc={name:"CertBag",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:D.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:D.Class.UNIVERSAL,type:D.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function Pa(e,t,a,r){for(var n=[],i=0;i<e.length;i++)for(var s=0;s<e[i].safeBags.length;s++){var o=e[i].safeBags[s];if(!(r!==void 0&&o.type!==r)){if(t===null){n.push(o);continue}o.attributes[t]!==void 0&&o.attributes[t].indexOf(a)>=0&&n.push(o)}}return n}Qa.pkcs12FromAsn1=function(e,t,a){typeof t=="string"?(a=t,t=!0):t===void 0&&(t=!0);var r={},n=[];if(!D.validate(e,qc,r,n)){var i=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw i.errors=i,i}var s={version:r.version.charCodeAt(0),safeContents:[],getBags:function(g){var C={},x;return"localKeyId"in g?x=g.localKeyId:"localKeyIdHex"in g&&(x=rt.util.hexToBytes(g.localKeyIdHex)),x===void 0&&!("friendlyName"in g)&&"bagType"in g&&(C[g.bagType]=Pa(s.safeContents,null,null,g.bagType)),x!==void 0&&(C.localKeyId=Pa(s.safeContents,"localKeyId",x,g.bagType)),"friendlyName"in g&&(C.friendlyName=Pa(s.safeContents,"friendlyName",g.friendlyName,g.bagType)),C},getBagsByFriendlyName:function(g,C){return Pa(s.safeContents,"friendlyName",g,C)},getBagsByLocalKeyId:function(g,C){return Pa(s.safeContents,"localKeyId",g,C)}};if(r.version.charCodeAt(0)!==3){var i=new Error("PKCS#12 PFX of version other than 3 not supported.");throw i.version=r.version.charCodeAt(0),i}if(D.derToOid(r.contentType)!==Fe.oids.data){var i=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw i.oid=D.derToOid(r.contentType),i}var o=r.content.value[0];if(o.tagClass!==D.Class.UNIVERSAL||o.type!==D.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(o=l0(o),r.mac){var f=null,l=0,u=D.derToOid(r.macAlgorithm);switch(u){case Fe.oids.sha1:f=rt.md.sha1.create(),l=20;break;case Fe.oids.sha256:f=rt.md.sha256.create(),l=32;break;case Fe.oids.sha384:f=rt.md.sha384.create(),l=48;break;case Fe.oids.sha512:f=rt.md.sha512.create(),l=64;break;case Fe.oids.md5:f=rt.md.md5.create(),l=16;break}if(f===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+u);var c=new rt.util.ByteBuffer(r.macSalt),d="macIterations"in r?parseInt(rt.util.bytesToHex(r.macIterations),16):1,h=Qa.generateKey(a,c,3,d,l,f),p=rt.hmac.create();p.start(f,h),p.update(o.value);var v=p.getMac();if(v.getBytes()!==r.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return jc(s,o.value,t,a),s};function l0(e){if(e.composed||e.constructed){for(var t=rt.util.createBuffer(),a=0;a<e.value.length;++a)t.putBytes(e.value[a].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function jc(e,t,a,r){if(t=D.fromDer(t,a),t.tagClass!==D.Class.UNIVERSAL||t.type!==D.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var n=0;n<t.value.length;n++){var i=t.value[n],s={},o=[];if(!D.validate(i,Po,s,o)){var f=new Error("Cannot read ContentInfo.");throw f.errors=o,f}var l={encrypted:!1},u=null,c=s.content.value[0];switch(D.derToOid(s.contentType)){case Fe.oids.data:if(c.tagClass!==D.Class.UNIVERSAL||c.type!==D.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");u=l0(c).value;break;case Fe.oids.encryptedData:u=Yc(c,r),l.encrypted=!0;break;default:var f=new Error("Unsupported PKCS#12 contentType.");throw f.contentType=D.derToOid(s.contentType),f}l.safeBags=Xc(u,a,r),e.safeContents.push(l)}}function Yc(e,t){var a={},r=[];if(!D.validate(e,rt.pkcs7.asn1.encryptedDataValidator,a,r)){var n=new Error("Cannot read EncryptedContentInfo.");throw n.errors=r,n}var i=D.derToOid(a.contentType);if(i!==Fe.oids.data){var n=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw n.oid=i,n}i=D.derToOid(a.encAlgorithm);var s=Fe.pbe.getCipher(i,a.encParameter,t),o=l0(a.encryptedContentAsn1),f=rt.util.createBuffer(o.value);if(s.update(f),!s.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return s.output.getBytes()}function Xc(e,t,a){if(!t&&e.length===0)return[];if(e=D.fromDer(e,t),e.tagClass!==D.Class.UNIVERSAL||e.type!==D.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var r=[],n=0;n<e.value.length;n++){var i=e.value[n],s={},o=[];if(!D.validate(i,Gc,s,o)){var f=new Error("Cannot read SafeBag.");throw f.errors=o,f}var l={type:D.derToOid(s.bagId),attributes:Zc(s.bagAttributes)};r.push(l);var u,c,d=s.bagValue.value[0];switch(l.type){case Fe.oids.pkcs8ShroudedKeyBag:if(d=Fe.decryptPrivateKeyInfo(d,a),d===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case Fe.oids.keyBag:try{l.key=Fe.privateKeyFromAsn1(d)}catch{l.key=null,l.asn1=d}continue;case Fe.oids.certBag:u=Wc,c=function(){if(D.derToOid(s.certId)!==Fe.oids.x509Certificate){var p=new Error("Unsupported certificate type, only X.509 supported.");throw p.oid=D.derToOid(s.certId),p}var v=D.fromDer(s.cert,t);try{l.cert=Fe.certificateFromAsn1(v,!0)}catch{l.cert=null,l.asn1=v}};break;default:var f=new Error("Unsupported PKCS#12 SafeBag type.");throw f.oid=l.type,f}if(u!==void 0&&!D.validate(d,u,s,o)){var f=new Error("Cannot read PKCS#12 "+u.name);throw f.errors=o,f}c()}return r}function Zc(e){var t={};if(e!==void 0)for(var a=0;a<e.length;++a){var r={},n=[];if(!D.validate(e[a],Qc,r,n)){var i=new Error("Cannot read PKCS#12 BagAttribute.");throw i.errors=n,i}var s=D.derToOid(r.oid);if(Fe.oids[s]!==void 0){t[Fe.oids[s]]=[];for(var o=0;o<r.values.length;++o)t[Fe.oids[s]].push(r.values[o].value)}}return t}Qa.toPkcs12Asn1=function(e,t,a,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||r.encAlgorithm||"aes128","useMac"in r||(r.useMac=!0),"localKeyId"in r||(r.localKeyId=null),"generateLocalKeyId"in r||(r.generateLocalKeyId=!0);var n=r.localKeyId,i;if(n!==null)n=rt.util.hexToBytes(n);else if(r.generateLocalKeyId)if(t){var s=rt.util.isArray(t)?t[0]:t;typeof s=="string"&&(s=Fe.certificateFromPem(s));var o=rt.md.sha1.create();o.update(D.toDer(Fe.certificateToAsn1(s)).getBytes()),n=o.digest().getBytes()}else n=rt.random.getBytes(20);var f=[];n!==null&&f.push(D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.localKeyId).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SET,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,n)])])),"friendlyName"in r&&f.push(D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.friendlyName).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SET,!0,[D.create(D.Class.UNIVERSAL,D.Type.BMPSTRING,!1,r.friendlyName)])])),f.length>0&&(i=D.create(D.Class.UNIVERSAL,D.Type.SET,!0,f));var l=[],u=[];t!==null&&(rt.util.isArray(t)?u=t:u=[t]);for(var c=[],d=0;d<u.length;++d){t=u[d],typeof t=="string"&&(t=Fe.certificateFromPem(t));var h=d===0?i:void 0,p=Fe.certificateToAsn1(t),v=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.certBag).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.x509Certificate).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,D.toDer(p).getBytes())])])]),h]);c.push(v)}if(c.length>0){var g=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,c),C=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.data).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,D.toDer(g).getBytes())])]);l.push(C)}var x=null;if(e!==null){var y=Fe.wrapRsaPrivateKey(Fe.privateKeyToAsn1(e));a===null?x=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.keyBag).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[y]),i]):x=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.pkcs8ShroudedKeyBag).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[Fe.encryptPrivateKeyInfo(y,a,r)]),i]);var S=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[x]),T=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.data).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,D.toDer(S).getBytes())])]);l.push(T)}var A=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,l),k;if(r.useMac){var o=rt.md.sha1.create(),B=new rt.util.ByteBuffer(rt.random.getBytes(r.saltSize)),O=r.count,e=Qa.generateKey(a,B,3,O,20),I=rt.hmac.create();I.start(o,e),I.update(D.toDer(A).getBytes());var w=I.getMac();k=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.sha1).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.NULL,!1,"")]),D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,w.getBytes())]),D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,B.getBytes()),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(O).getBytes())])}return D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(3).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(Fe.oids.data).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,D.toDer(A).getBytes())])]),k])};Qa.generateKey=rt.pbe.generatePkcs12Key;var Wr=Oe,f0=Wr.asn1,Ea=Wr.pki=Wr.pki||{};Ea.pemToDer=function(e){var t=Wr.pem.decode(e)[0];if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Wr.util.createBuffer(t.body)};Ea.privateKeyFromPem=function(e){var t=Wr.pem.decode(e)[0];if(t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var a=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var r=f0.fromDer(t.body);return Ea.privateKeyFromAsn1(r)};Ea.privateKeyToPem=function(e,t){var a={type:"RSA PRIVATE KEY",body:f0.toDer(Ea.privateKeyToAsn1(e)).getBytes()};return Wr.pem.encode(a,{maxline:t})};Ea.privateKeyInfoToPem=function(e,t){var a={type:"PRIVATE KEY",body:f0.toDer(e).getBytes()};return Wr.pem.encode(a,{maxline:t})};var ee=Oe,On=function(e,t,a,r){var n=ee.util.createBuffer(),i=e.length>>1,s=i+(e.length&1),o=e.substr(0,s),f=e.substr(i,s),l=ee.util.createBuffer(),u=ee.hmac.create();a=t+a;var c=Math.ceil(r/16),d=Math.ceil(r/20);u.start("MD5",o);var h=ee.util.createBuffer();l.putBytes(a);for(var p=0;p<c;++p)u.start(null,null),u.update(l.getBytes()),l.putBuffer(u.digest()),u.start(null,null),u.update(l.bytes()+a),h.putBuffer(u.digest());u.start("SHA1",f);var v=ee.util.createBuffer();l.clear(),l.putBytes(a);for(var p=0;p<d;++p)u.start(null,null),u.update(l.getBytes()),l.putBuffer(u.digest()),u.start(null,null),u.update(l.bytes()+a),v.putBuffer(u.digest());return n.putBytes(ee.util.xorBytes(h.getBytes(),v.getBytes(),r)),n},Jc=function(e,t,a){var r=ee.hmac.create();r.start("SHA1",e);var n=ee.util.createBuffer();return n.putInt32(t[0]),n.putInt32(t[1]),n.putByte(a.type),n.putByte(a.version.major),n.putByte(a.version.minor),n.putInt16(a.length),n.putBytes(a.fragment.bytes()),r.update(n.getBytes()),r.digest().getBytes()},$c=function(e,t,a){var r=!1;try{var n=e.deflate(t.fragment.getBytes());t.fragment=ee.util.createBuffer(n),t.length=n.length,r=!0}catch{}return r},ed=function(e,t,a){var r=!1;try{var n=e.inflate(t.fragment.getBytes());t.fragment=ee.util.createBuffer(n),t.length=n.length,r=!0}catch{}return r},Yt=function(e,t){var a=0;switch(t){case 1:a=e.getByte();break;case 2:a=e.getInt16();break;case 3:a=e.getInt24();break;case 4:a=e.getInt32();break}return ee.util.createBuffer(e.getBytes(a))},Jt=function(e,t,a){e.putInt(a.length(),t<<3),e.putBuffer(a)},b={};b.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};b.SupportedVersions=[b.Versions.TLS_1_1,b.Versions.TLS_1_0];b.Version=b.SupportedVersions[0];b.MaxFragment=16384-1024;b.ConnectionEnd={server:0,client:1};b.PRFAlgorithm={tls_prf_sha256:0};b.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};b.CipherType={stream:0,block:1,aead:2};b.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};b.CompressionMethod={none:0,deflate:1};b.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};b.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};b.Alert={};b.Alert.Level={warning:1,fatal:2};b.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};b.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};b.CipherSuites={};b.getCipherSuite=function(e){var t=null;for(var a in b.CipherSuites){var r=b.CipherSuites[a];if(r.id[0]===e.charCodeAt(0)&&r.id[1]===e.charCodeAt(1)){t=r;break}}return t};b.handleUnexpected=function(e,t){var a=!e.open&&e.entity===b.ConnectionEnd.client;a||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.unexpected_message}})};b.handleHelloRequest=function(e,t,a){!e.handshaking&&e.handshakes>0&&(b.queue(e,b.createAlert(e,{level:b.Alert.Level.warning,description:b.Alert.Description.no_renegotiation})),b.flush(e)),e.process()};b.parseHelloMessage=function(e,t,a){var r=null,n=e.entity===b.ConnectionEnd.client;if(a<38)e.error(e,{message:n?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.illegal_parameter}});else{var i=t.fragment,s=i.length();if(r={version:{major:i.getByte(),minor:i.getByte()},random:ee.util.createBuffer(i.getBytes(32)),session_id:Yt(i,1),extensions:[]},n?(r.cipher_suite=i.getBytes(2),r.compression_method=i.getByte()):(r.cipher_suites=Yt(i,2),r.compression_methods=Yt(i,1)),s=a-(s-i.length()),s>0){for(var o=Yt(i,2);o.length()>0;)r.extensions.push({type:[o.getByte(),o.getByte()],data:Yt(o,2)});if(!n)for(var f=0;f<r.extensions.length;++f){var l=r.extensions[f];if(l.type[0]===0&&l.type[1]===0)for(var u=Yt(l.data,2);u.length()>0;){var c=u.getByte();if(c!==0)break;e.session.extensions.server_name.serverNameList.push(Yt(u,2).getBytes())}}}if(e.session.version&&(r.version.major!==e.session.version.major||r.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.protocol_version}});if(n)e.session.cipherSuite=b.getCipherSuite(r.cipher_suite);else for(var d=ee.util.createBuffer(r.cipher_suites.bytes());d.length()>0&&(e.session.cipherSuite=b.getCipherSuite(d.getBytes(2)),e.session.cipherSuite===null););if(e.session.cipherSuite===null)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.handshake_failure},cipherSuite:ee.util.bytesToHex(r.cipher_suite)});n?e.session.compressionMethod=r.compression_method:e.session.compressionMethod=b.CompressionMethod.none}return r};b.createSecurityParameters=function(e,t){var a=e.entity===b.ConnectionEnd.client,r=t.random.bytes(),n=a?e.session.sp.client_random:r,i=a?r:b.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:b.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:n,server_random:i}};b.handleServerHello=function(e,t,a){var r=b.parseHelloMessage(e,t,a);if(!e.fail){if(r.version.minor<=e.version.minor)e.version.minor=r.version.minor;else return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.protocol_version}});e.session.version=e.version;var n=r.session_id.bytes();n.length>0&&n===e.session.id?(e.expect=Uo,e.session.resuming=!0,e.session.sp.server_random=r.random.bytes()):(e.expect=rd,e.session.resuming=!1,b.createSecurityParameters(e,r)),e.session.id=n,e.process()}};b.handleClientHello=function(e,t,a){var r=b.parseHelloMessage(e,t,a);if(!e.fail){var n=r.session_id.bytes(),i=null;if(e.sessionCache&&(i=e.sessionCache.getSession(n),i===null?n="":(i.version.major!==r.version.major||i.version.minor>r.version.minor)&&(i=null,n="")),n.length===0&&(n=ee.random.getBytes(32)),e.session.id=n,e.session.clientHelloVersion=r.version,e.session.sp={},i)e.version=e.session.version=i.version,e.session.sp=i.sp;else{for(var s,o=1;o<b.SupportedVersions.length&&(s=b.SupportedVersions[o],!(s.minor<=r.version.minor));++o);e.version={major:s.major,minor:s.minor},e.session.version=e.version}i!==null?(e.expect=u0,e.session.resuming=!0,e.session.sp.client_random=r.random.bytes()):(e.expect=e.verifyClient!==!1?fd:Mi,e.session.resuming=!1,b.createSecurityParameters(e,r)),e.open=!0,b.queue(e,b.createRecord(e,{type:b.ContentType.handshake,data:b.createServerHello(e)})),e.session.resuming?(b.queue(e,b.createRecord(e,{type:b.ContentType.change_cipher_spec,data:b.createChangeCipherSpec()})),e.state.pending=b.createConnectionState(e),e.state.current.write=e.state.pending.write,b.queue(e,b.createRecord(e,{type:b.ContentType.handshake,data:b.createFinished(e)}))):(b.queue(e,b.createRecord(e,{type:b.ContentType.handshake,data:b.createCertificate(e)})),e.fail||(b.queue(e,b.createRecord(e,{type:b.ContentType.handshake,data:b.createServerKeyExchange(e)})),e.verifyClient!==!1&&b.queue(e,b.createRecord(e,{type:b.ContentType.handshake,data:b.createCertificateRequest(e)})),b.queue(e,b.createRecord(e,{type:b.ContentType.handshake,data:b.createServerHelloDone(e)})))),b.flush(e),e.process()}};b.handleCertificate=function(e,t,a){if(a<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.illegal_parameter}});var r=t.fragment,n={certificate_list:Yt(r,3)},i,s,o=[];try{for(;n.certificate_list.length()>0;)i=Yt(n.certificate_list,3),s=ee.asn1.fromDer(i),i=ee.pki.certificateFromAsn1(s,!0),o.push(i)}catch(l){return e.error(e,{message:"Could not parse certificate list.",cause:l,send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.bad_certificate}})}var f=e.entity===b.ConnectionEnd.client;(f||e.verifyClient===!0)&&o.length===0?e.error(e,{message:f?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.illegal_parameter}}):o.length===0?e.expect=f?Es:Mi:(f?e.session.serverCertificate=o[0]:e.session.clientCertificate=o[0],b.verifyCertificateChain(e,o)&&(e.expect=f?Es:Mi)),e.process()};b.handleServerKeyExchange=function(e,t,a){if(a>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.unsupported_certificate}});e.expect=ad,e.process()};b.handleClientKeyExchange=function(e,t,a){if(a<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.unsupported_certificate}});var r=t.fragment,n={enc_pre_master_secret:Yt(r,2).getBytes()},i=null;if(e.getPrivateKey)try{i=e.getPrivateKey(e,e.session.serverCertificate),i=ee.pki.privateKeyFromPem(i)}catch(f){e.error(e,{message:"Could not get private key.",cause:f,send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.internal_error}})}if(i===null)return e.error(e,{message:"No private key set.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.internal_error}});try{var s=e.session.sp;s.pre_master_secret=i.decrypt(n.enc_pre_master_secret);var o=e.session.clientHelloVersion;if(o.major!==s.pre_master_secret.charCodeAt(0)||o.minor!==s.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{s.pre_master_secret=ee.random.getBytes(48)}e.expect=u0,e.session.clientCertificate!==null&&(e.expect=ud),e.process()};b.handleCertificateRequest=function(e,t,a){if(a<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.illegal_parameter}});var r=t.fragment,n={certificate_types:Yt(r,1),certificate_authorities:Yt(r,2)};e.session.certificateRequest=n,e.expect=nd,e.process()};b.handleCertificateVerify=function(e,t,a){if(a<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.illegal_parameter}});var r=t.fragment;r.read-=4;var n=r.bytes();r.read+=4;var i={signature:Yt(r,2).getBytes()},s=ee.util.createBuffer();s.putBuffer(e.session.md5.digest()),s.putBuffer(e.session.sha1.digest()),s=s.getBytes();try{var o=e.session.clientCertificate;if(!o.publicKey.verify(s,i.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(n),e.session.sha1.update(n)}catch{return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.handshake_failure}})}e.expect=u0,e.process()};b.handleServerHelloDone=function(e,t,a){if(a>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.record_overflow}});if(e.serverCertificate===null){var r={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.insufficient_security}},n=0,i=e.verify(e,r.alert.description,n,[]);if(i!==!0)return(i||i===0)&&(typeof i=="object"&&!ee.util.isArray(i)?(i.message&&(r.message=i.message),i.alert&&(r.alert.description=i.alert)):typeof i=="number"&&(r.alert.description=i)),e.error(e,r)}e.session.certificateRequest!==null&&(t=b.createRecord(e,{type:b.ContentType.handshake,data:b.createCertificate(e)}),b.queue(e,t)),t=b.createRecord(e,{type:b.ContentType.handshake,data:b.createClientKeyExchange(e)}),b.queue(e,t),e.expect=od;var s=function(o,f){o.session.certificateRequest!==null&&o.session.clientCertificate!==null&&b.queue(o,b.createRecord(o,{type:b.ContentType.handshake,data:b.createCertificateVerify(o,f)})),b.queue(o,b.createRecord(o,{type:b.ContentType.change_cipher_spec,data:b.createChangeCipherSpec()})),o.state.pending=b.createConnectionState(o),o.state.current.write=o.state.pending.write,b.queue(o,b.createRecord(o,{type:b.ContentType.handshake,data:b.createFinished(o)})),o.expect=Uo,b.flush(o),o.process()};if(e.session.certificateRequest===null||e.session.clientCertificate===null)return s(e,null);b.getClientSignature(e,s)};b.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1)return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.illegal_parameter}});var a=e.entity===b.ConnectionEnd.client;(e.session.resuming&&a||!e.session.resuming&&!a)&&(e.state.pending=b.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&a||e.session.resuming&&!a)&&(e.state.pending=null),e.expect=a?id:cd,e.process()};b.handleFinished=function(e,t,a){var r=t.fragment;r.read-=4;var n=r.bytes();r.read+=4;var i=t.fragment.getBytes();r=ee.util.createBuffer(),r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest());var s=e.entity===b.ConnectionEnd.client,o=s?"server finished":"client finished",f=e.session.sp,l=12,u=On;if(r=u(f.master_secret,o,r.getBytes(),l),r.getBytes()!==i)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.decrypt_error}});e.session.md5.update(n),e.session.sha1.update(n),(e.session.resuming&&s||!e.session.resuming&&!s)&&(b.queue(e,b.createRecord(e,{type:b.ContentType.change_cipher_spec,data:b.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,b.queue(e,b.createRecord(e,{type:b.ContentType.handshake,data:b.createFinished(e)}))),e.expect=s?sd:dd,e.handshaking=!1,++e.handshakes,e.peerCertificate=s?e.session.serverCertificate:e.session.clientCertificate,b.flush(e),e.isConnected=!0,e.connected(e),e.process()};b.handleAlert=function(e,t){var a=t.fragment,r={level:a.getByte(),description:a.getByte()},n;switch(r.description){case b.Alert.Description.close_notify:n="Connection closed.";break;case b.Alert.Description.unexpected_message:n="Unexpected message.";break;case b.Alert.Description.bad_record_mac:n="Bad record MAC.";break;case b.Alert.Description.decryption_failed:n="Decryption failed.";break;case b.Alert.Description.record_overflow:n="Record overflow.";break;case b.Alert.Description.decompression_failure:n="Decompression failed.";break;case b.Alert.Description.handshake_failure:n="Handshake failure.";break;case b.Alert.Description.bad_certificate:n="Bad certificate.";break;case b.Alert.Description.unsupported_certificate:n="Unsupported certificate.";break;case b.Alert.Description.certificate_revoked:n="Certificate revoked.";break;case b.Alert.Description.certificate_expired:n="Certificate expired.";break;case b.Alert.Description.certificate_unknown:n="Certificate unknown.";break;case b.Alert.Description.illegal_parameter:n="Illegal parameter.";break;case b.Alert.Description.unknown_ca:n="Unknown certificate authority.";break;case b.Alert.Description.access_denied:n="Access denied.";break;case b.Alert.Description.decode_error:n="Decode error.";break;case b.Alert.Description.decrypt_error:n="Decrypt error.";break;case b.Alert.Description.export_restriction:n="Export restriction.";break;case b.Alert.Description.protocol_version:n="Unsupported protocol version.";break;case b.Alert.Description.insufficient_security:n="Insufficient security.";break;case b.Alert.Description.internal_error:n="Internal error.";break;case b.Alert.Description.user_canceled:n="User canceled.";break;case b.Alert.Description.no_renegotiation:n="Renegotiation not supported.";break;default:n="Unknown error.";break}if(r.description===b.Alert.Description.close_notify)return e.close();e.error(e,{message:n,send:!1,origin:e.entity===b.ConnectionEnd.client?"server":"client",alert:r}),e.process()};b.handleHandshake=function(e,t){var a=t.fragment,r=a.getByte(),n=a.getInt24();if(n>a.length())return e.fragmented=t,t.fragment=ee.util.createBuffer(),a.read-=4,e.process();e.fragmented=null,a.read-=4;var i=a.bytes(n+4);a.read+=4,r in En[e.entity][e.expect]?(e.entity===b.ConnectionEnd.server&&!e.open&&!e.fail&&(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:ee.md.md5.create(),sha1:ee.md.sha1.create()}),r!==b.HandshakeType.hello_request&&r!==b.HandshakeType.certificate_verify&&r!==b.HandshakeType.finished&&(e.session.md5.update(i),e.session.sha1.update(i)),En[e.entity][e.expect][r](e,t,n)):b.handleUnexpected(e,t)};b.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()};b.handleHeartbeat=function(e,t){var a=t.fragment,r=a.getByte(),n=a.getInt16(),i=a.getBytes(n);if(r===b.HeartbeatMessageType.heartbeat_request){if(e.handshaking||n>i.length)return e.process();b.queue(e,b.createRecord(e,{type:b.ContentType.heartbeat,data:b.createHeartbeat(b.HeartbeatMessageType.heartbeat_response,i)})),b.flush(e)}else if(r===b.HeartbeatMessageType.heartbeat_response){if(i!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,ee.util.createBuffer(i))}e.process()};var td=0,rd=1,Es=2,ad=3,nd=4,Uo=5,id=6,sd=7,od=8,ld=0,fd=1,Mi=2,ud=3,u0=4,cd=5,dd=6,_=b.handleUnexpected,Oo=b.handleChangeCipherSpec,It=b.handleAlert,Ot=b.handleHandshake,Vo=b.handleApplicationData,wt=b.handleHeartbeat,c0=[];c0[b.ConnectionEnd.client]=[[_,It,Ot,_,wt],[_,It,Ot,_,wt],[_,It,Ot,_,wt],[_,It,Ot,_,wt],[_,It,Ot,_,wt],[Oo,It,_,_,wt],[_,It,Ot,_,wt],[_,It,Ot,Vo,wt],[_,It,Ot,_,wt]];c0[b.ConnectionEnd.server]=[[_,It,Ot,_,wt],[_,It,Ot,_,wt],[_,It,Ot,_,wt],[_,It,Ot,_,wt],[Oo,It,_,_,wt],[_,It,Ot,_,wt],[_,It,Ot,Vo,wt],[_,It,Ot,_,wt]];var Pr=b.handleHelloRequest,hd=b.handleServerHello,Fo=b.handleCertificate,_s=b.handleServerKeyExchange,_i=b.handleCertificateRequest,sn=b.handleServerHelloDone,Mo=b.handleFinished,En=[];En[b.ConnectionEnd.client]=[[_,_,hd,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,Fo,_s,_i,sn,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_s,_i,sn,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_i,sn,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,sn,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,Mo],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_]];var pd=b.handleClientHello,vd=b.handleClientKeyExchange,gd=b.handleCertificateVerify;En[b.ConnectionEnd.server]=[[_,pd,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,Fo,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,vd,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,gd,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,Mo],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_]];b.generateKeys=function(e,t){var a=On,r=t.client_random+t.server_random;e.session.resuming||(t.master_secret=a(t.pre_master_secret,"master secret",r,48).bytes(),t.pre_master_secret=null),r=t.server_random+t.client_random;var n=2*t.mac_key_length+2*t.enc_key_length,i=e.version.major===b.Versions.TLS_1_0.major&&e.version.minor===b.Versions.TLS_1_0.minor;i&&(n+=2*t.fixed_iv_length);var s=a(t.master_secret,"key expansion",r,n),o={client_write_MAC_key:s.getBytes(t.mac_key_length),server_write_MAC_key:s.getBytes(t.mac_key_length),client_write_key:s.getBytes(t.enc_key_length),server_write_key:s.getBytes(t.enc_key_length)};return i&&(o.client_write_IV=s.getBytes(t.fixed_iv_length),o.server_write_IV=s.getBytes(t.fixed_iv_length)),o};b.createConnectionState=function(e){var t=e.entity===b.ConnectionEnd.client,a=function(){var i={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(s){return!0},compressionState:null,compressFunction:function(s){return!0},updateSequenceNumber:function(){i.sequenceNumber[1]===4294967295?(i.sequenceNumber[1]=0,++i.sequenceNumber[0]):++i.sequenceNumber[1]}};return i},r={read:a(),write:a()};if(r.read.update=function(i,s){return r.read.cipherFunction(s,r.read)?r.read.compressFunction(i,s,r.read)||i.error(i,{message:"Could not decompress record.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.decompression_failure}}):i.error(i,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.bad_record_mac}}),!i.fail},r.write.update=function(i,s){return r.write.compressFunction(i,s,r.write)?r.write.cipherFunction(s,r.write)||i.error(i,{message:"Could not encrypt record.",send:!1,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.internal_error}}):i.error(i,{message:"Could not compress record.",send:!1,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.internal_error}}),!i.fail},e.session){var n=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(n),n.keys=b.generateKeys(e,n),r.read.macKey=t?n.keys.server_write_MAC_key:n.keys.client_write_MAC_key,r.write.macKey=t?n.keys.client_write_MAC_key:n.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(r,e,n),n.compression_algorithm){case b.CompressionMethod.none:break;case b.CompressionMethod.deflate:r.read.compressFunction=ed,r.write.compressFunction=$c;break;default:throw new Error("Unsupported compression algorithm.")}}return r};b.createRandom=function(){var e=new Date,t=+e+e.getTimezoneOffset()*6e4,a=ee.util.createBuffer();return a.putInt32(t),a.putBytes(ee.random.getBytes(28)),a};b.createRecord=function(e,t){if(!t.data)return null;var a={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return a};b.createAlert=function(e,t){var a=ee.util.createBuffer();return a.putByte(t.level),a.putByte(t.description),b.createRecord(e,{type:b.ContentType.alert,data:a})};b.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=ee.util.createBuffer(),a=0;a<e.cipherSuites.length;++a){var r=e.cipherSuites[a];t.putByte(r.id[0]),t.putByte(r.id[1])}var n=t.length(),i=ee.util.createBuffer();i.putByte(b.CompressionMethod.none);var s=i.length(),o=ee.util.createBuffer();if(e.virtualHost){var f=ee.util.createBuffer();f.putByte(0),f.putByte(0);var l=ee.util.createBuffer();l.putByte(0),Jt(l,2,ee.util.createBuffer(e.virtualHost));var u=ee.util.createBuffer();Jt(u,2,l),Jt(f,2,u),o.putBuffer(f)}var c=o.length();c>0&&(c+=2);var d=e.session.id,h=d.length+1+2+4+28+2+n+1+s+c,p=ee.util.createBuffer();return p.putByte(b.HandshakeType.client_hello),p.putInt24(h),p.putByte(e.version.major),p.putByte(e.version.minor),p.putBytes(e.session.sp.client_random),Jt(p,1,ee.util.createBuffer(d)),Jt(p,2,t),Jt(p,1,i),c>0&&Jt(p,2,o),p};b.createServerHello=function(e){var t=e.session.id,a=t.length+1+2+4+28+2+1,r=ee.util.createBuffer();return r.putByte(b.HandshakeType.server_hello),r.putInt24(a),r.putByte(e.version.major),r.putByte(e.version.minor),r.putBytes(e.session.sp.server_random),Jt(r,1,ee.util.createBuffer(t)),r.putByte(e.session.cipherSuite.id[0]),r.putByte(e.session.cipherSuite.id[1]),r.putByte(e.session.compressionMethod),r};b.createCertificate=function(e){var t=e.entity===b.ConnectionEnd.client,a=null;if(e.getCertificate){var r;t?r=e.session.certificateRequest:r=e.session.extensions.server_name.serverNameList,a=e.getCertificate(e,r)}var n=ee.util.createBuffer();if(a!==null)try{ee.util.isArray(a)||(a=[a]);for(var i=null,s=0;s<a.length;++s){var o=ee.pem.decode(a[s])[0];if(o.type!=="CERTIFICATE"&&o.type!=="X509 CERTIFICATE"&&o.type!=="TRUSTED CERTIFICATE"){var f=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw f.headerType=o.type,f}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var l=ee.util.createBuffer(o.body);i===null&&(i=ee.asn1.fromDer(l.bytes(),!1));var u=ee.util.createBuffer();Jt(u,3,l),n.putBuffer(u)}a=ee.pki.certificateFromAsn1(i),t?e.session.clientCertificate=a:e.session.serverCertificate=a}catch(h){return e.error(e,{message:"Could not send certificate list.",cause:h,send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.bad_certificate}})}var c=3+n.length(),d=ee.util.createBuffer();return d.putByte(b.HandshakeType.certificate),d.putInt24(c),Jt(d,3,n),d};b.createClientKeyExchange=function(e){var t=ee.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(ee.random.getBytes(46));var a=e.session.sp;a.pre_master_secret=t.getBytes();var r=e.session.serverCertificate.publicKey;t=r.encrypt(a.pre_master_secret);var n=t.length+2,i=ee.util.createBuffer();return i.putByte(b.HandshakeType.client_key_exchange),i.putInt24(n),i.putInt16(t.length),i.putBytes(t),i};b.createServerKeyExchange=function(e){var t=ee.util.createBuffer();return t};b.getClientSignature=function(e,t){var a=ee.util.createBuffer();a.putBuffer(e.session.md5.digest()),a.putBuffer(e.session.sha1.digest()),a=a.getBytes(),e.getSignature=e.getSignature||function(r,n,i){var s=null;if(r.getPrivateKey)try{s=r.getPrivateKey(r,r.session.clientCertificate),s=ee.pki.privateKeyFromPem(s)}catch(o){r.error(r,{message:"Could not get private key.",cause:o,send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.internal_error}})}s===null?r.error(r,{message:"No private key set.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.internal_error}}):n=s.sign(n,null),i(r,n)},e.getSignature(e,a,t)};b.createCertificateVerify=function(e,t){var a=t.length+2,r=ee.util.createBuffer();return r.putByte(b.HandshakeType.certificate_verify),r.putInt24(a),r.putInt16(t.length),r.putBytes(t),r};b.createCertificateRequest=function(e){var t=ee.util.createBuffer();t.putByte(1);var a=ee.util.createBuffer();for(var r in e.caStore.certs){var n=e.caStore.certs[r],i=ee.pki.distinguishedNameToAsn1(n.subject),s=ee.asn1.toDer(i);a.putInt16(s.length()),a.putBuffer(s)}var o=1+t.length()+2+a.length(),f=ee.util.createBuffer();return f.putByte(b.HandshakeType.certificate_request),f.putInt24(o),Jt(f,1,t),Jt(f,2,a),f};b.createServerHelloDone=function(e){var t=ee.util.createBuffer();return t.putByte(b.HandshakeType.server_hello_done),t.putInt24(0),t};b.createChangeCipherSpec=function(){var e=ee.util.createBuffer();return e.putByte(1),e};b.createFinished=function(e){var t=ee.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var a=e.entity===b.ConnectionEnd.client,r=e.session.sp,n=12,i=On,s=a?"client finished":"server finished";t=i(r.master_secret,s,t.getBytes(),n);var o=ee.util.createBuffer();return o.putByte(b.HandshakeType.finished),o.putInt24(t.length()),o.putBuffer(t),o};b.createHeartbeat=function(e,t,a){typeof a>"u"&&(a=t.length);var r=ee.util.createBuffer();r.putByte(e),r.putInt16(a),r.putBytes(t);var n=r.length(),i=Math.max(16,n-a-3);return r.putBytes(ee.random.getBytes(i)),r};b.queue=function(e,t){if(t&&!(t.fragment.length()===0&&(t.type===b.ContentType.handshake||t.type===b.ContentType.alert||t.type===b.ContentType.change_cipher_spec))){if(t.type===b.ContentType.handshake){var a=t.fragment.bytes();e.session.md5.update(a),e.session.sha1.update(a),a=null}var r;if(t.fragment.length()<=b.MaxFragment)r=[t];else{r=[];for(var n=t.fragment.bytes();n.length>b.MaxFragment;)r.push(b.createRecord(e,{type:t.type,data:ee.util.createBuffer(n.slice(0,b.MaxFragment))})),n=n.slice(b.MaxFragment);n.length>0&&r.push(b.createRecord(e,{type:t.type,data:ee.util.createBuffer(n)}))}for(var i=0;i<r.length&&!e.fail;++i){var s=r[i],o=e.state.current.write;o.update(e,s)&&e.records.push(s)}}};b.flush=function(e){for(var t=0;t<e.records.length;++t){var a=e.records[t];e.tlsData.putByte(a.type),e.tlsData.putByte(a.version.major),e.tlsData.putByte(a.version.minor),e.tlsData.putInt16(a.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var bi=function(e){switch(e){case!0:return!0;case ee.pki.certificateError.bad_certificate:return b.Alert.Description.bad_certificate;case ee.pki.certificateError.unsupported_certificate:return b.Alert.Description.unsupported_certificate;case ee.pki.certificateError.certificate_revoked:return b.Alert.Description.certificate_revoked;case ee.pki.certificateError.certificate_expired:return b.Alert.Description.certificate_expired;case ee.pki.certificateError.certificate_unknown:return b.Alert.Description.certificate_unknown;case ee.pki.certificateError.unknown_ca:return b.Alert.Description.unknown_ca;default:return b.Alert.Description.bad_certificate}},yd=function(e){switch(e){case!0:return!0;case b.Alert.Description.bad_certificate:return ee.pki.certificateError.bad_certificate;case b.Alert.Description.unsupported_certificate:return ee.pki.certificateError.unsupported_certificate;case b.Alert.Description.certificate_revoked:return ee.pki.certificateError.certificate_revoked;case b.Alert.Description.certificate_expired:return ee.pki.certificateError.certificate_expired;case b.Alert.Description.certificate_unknown:return ee.pki.certificateError.certificate_unknown;case b.Alert.Description.unknown_ca:return ee.pki.certificateError.unknown_ca;default:return ee.pki.certificateError.bad_certificate}};b.verifyCertificateChain=function(e,t){try{var a={};for(var r in e.verifyOptions)a[r]=e.verifyOptions[r];a.verify=function(i,s,o){var f=bi(i),l=e.verify(e,i,s,o);if(l!==!0){if(typeof l=="object"&&!ee.util.isArray(l)){var u=new Error("The application rejected the certificate.");throw u.send=!0,u.alert={level:b.Alert.Level.fatal,description:b.Alert.Description.bad_certificate},l.message&&(u.message=l.message),l.alert&&(u.alert.description=l.alert),u}l!==i&&(l=yd(l))}return l},ee.pki.verifyCertificateChain(e.caStore,t,a)}catch(i){var n=i;(typeof n!="object"||ee.util.isArray(n))&&(n={send:!0,alert:{level:b.Alert.Level.fatal,description:bi(i)}}),"send"in n||(n.send=!0),"alert"in n||(n.alert={level:b.Alert.Level.fatal,description:bi(n.error)}),e.error(e,n)}return!e.fail};b.createSessionCache=function(e,t){var a=null;if(e&&e.getSession&&e.setSession&&e.order)a=e;else{a={},a.cache=e||{},a.capacity=Math.max(t||100,1),a.order=[];for(var r in e)a.order.length<=t?a.order.push(r):delete e[r];a.getSession=function(n){var i=null,s=null;if(n?s=ee.util.bytesToHex(n):a.order.length>0&&(s=a.order[0]),s!==null&&s in a.cache){i=a.cache[s],delete a.cache[s];for(var o in a.order)if(a.order[o]===s){a.order.splice(o,1);break}}return i},a.setSession=function(n,i){if(a.order.length===a.capacity){var s=a.order.shift();delete a.cache[s]}var s=ee.util.bytesToHex(n);a.order.push(s),a.cache[s]=i}}return a};b.createConnection=function(e){var t=null;e.caStore?ee.util.isArray(e.caStore)?t=ee.pki.createCaStore(e.caStore):t=e.caStore:t=ee.pki.createCaStore();var a=e.cipherSuites||null;if(a===null){a=[];for(var r in b.CipherSuites)a.push(b.CipherSuites[r])}var n=e.server?b.ConnectionEnd.server:b.ConnectionEnd.client,i=e.sessionCache?b.createSessionCache(e.sessionCache):null,s={version:{major:b.Version.major,minor:b.Version.minor},entity:n,sessionId:e.sessionId,caStore:t,sessionCache:i,cipherSuites:a,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(u,c,d,h){return c},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:ee.util.createBuffer(),tlsData:ee.util.createBuffer(),data:ee.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(u,c){c.origin=c.origin||(u.entity===b.ConnectionEnd.client?"client":"server"),c.send&&(b.queue(u,b.createAlert(u,c.alert)),b.flush(u));var d=c.fatal!==!1;d&&(u.fail=!0),e.error(u,c),d&&u.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null};s.reset=function(u){s.version={major:b.Version.major,minor:b.Version.minor},s.record=null,s.session=null,s.peerCertificate=null,s.state={pending:null,current:null},s.expect=s.entity===b.ConnectionEnd.client?td:ld,s.fragmented=null,s.records=[],s.open=!1,s.handshakes=0,s.handshaking=!1,s.isConnected=!1,s.fail=!(u||typeof u>"u"),s.input.clear(),s.tlsData.clear(),s.data.clear(),s.state.current=b.createConnectionState(s)},s.reset();var o=function(u,c){var d=c.type-b.ContentType.change_cipher_spec,h=c0[u.entity][u.expect];d in h?h[d](u,c):b.handleUnexpected(u,c)},f=function(u){var c=0,d=u.input,h=d.length();if(h<5)c=5-h;else{u.record={type:d.getByte(),version:{major:d.getByte(),minor:d.getByte()},length:d.getInt16(),fragment:ee.util.createBuffer(),ready:!1};var p=u.record.version.major===u.version.major;p&&u.session&&u.session.version&&(p=u.record.version.minor===u.version.minor),p||u.error(u,{message:"Incompatible TLS version.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.protocol_version}})}return c},l=function(u){var c=0,d=u.input,h=d.length();if(h<u.record.length)c=u.record.length-h;else{u.record.fragment.putBytes(d.getBytes(u.record.length)),d.compact();var p=u.state.current.read;p.update(u,u.record)&&(u.fragmented!==null&&(u.fragmented.type===u.record.type?(u.fragmented.fragment.putBuffer(u.record.fragment),u.record=u.fragmented):u.error(u,{message:"Invalid fragmented record.",send:!0,alert:{level:b.Alert.Level.fatal,description:b.Alert.Description.unexpected_message}})),u.record.ready=!0)}return c};return s.handshake=function(u){if(s.entity!==b.ConnectionEnd.client)s.error(s,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(s.handshaking)s.error(s,{message:"Handshake already in progress.",fatal:!1});else{s.fail&&!s.open&&s.handshakes===0&&(s.fail=!1),s.handshaking=!0,u=u||"";var c=null;u.length>0&&(s.sessionCache&&(c=s.sessionCache.getSession(u)),c===null&&(u="")),u.length===0&&s.sessionCache&&(c=s.sessionCache.getSession(),c!==null&&(u=c.id)),s.session={id:u,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:ee.md.md5.create(),sha1:ee.md.sha1.create()},c&&(s.version=c.version,s.session.sp=c.sp),s.session.sp.client_random=b.createRandom().getBytes(),s.open=!0,b.queue(s,b.createRecord(s,{type:b.ContentType.handshake,data:b.createClientHello(s)})),b.flush(s)}},s.process=function(u){var c=0;return u&&s.input.putBytes(u),s.fail||(s.record!==null&&s.record.ready&&s.record.fragment.isEmpty()&&(s.record=null),s.record===null&&(c=f(s)),!s.fail&&s.record!==null&&!s.record.ready&&(c=l(s)),!s.fail&&s.record!==null&&s.record.ready&&o(s,s.record)),c},s.prepare=function(u){return b.queue(s,b.createRecord(s,{type:b.ContentType.application_data,data:ee.util.createBuffer(u)})),b.flush(s)},s.prepareHeartbeatRequest=function(u,c){return u instanceof ee.util.ByteBuffer&&(u=u.bytes()),typeof c>"u"&&(c=u.length),s.expectedHeartbeatPayload=u,b.queue(s,b.createRecord(s,{type:b.ContentType.heartbeat,data:b.createHeartbeat(b.HeartbeatMessageType.heartbeat_request,u,c)})),b.flush(s)},s.close=function(u){if(!s.fail&&s.sessionCache&&s.session){var c={id:s.session.id,version:s.session.version,sp:s.session.sp};c.sp.keys=null,s.sessionCache.setSession(c.id,c)}s.open&&(s.open=!1,s.input.clear(),(s.isConnected||s.handshaking)&&(s.isConnected=s.handshaking=!1,b.queue(s,b.createAlert(s,{level:b.Alert.Level.warning,description:b.Alert.Description.close_notify})),b.flush(s)),s.closed(s)),s.reset(u)},s};ee.tls=ee.tls||{};for(var Si in b)typeof b[Si]!="function"&&(ee.tls[Si]=b[Si]);ee.tls.prf_tls1=On;ee.tls.hmac_sha1=Jc;ee.tls.createSessionCache=b.createSessionCache;ee.tls.createConnection=b.createConnection;var Gr=Oe,rr=Gr.tls;rr.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=rr.BulkCipherAlgorithm.aes,e.cipher_type=rr.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=rr.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Ko};rr.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=rr.BulkCipherAlgorithm.aes,e.cipher_type=rr.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=rr.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Ko};function Ko(e,t,a){var r=t.entity===Gr.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:Gr.cipher.createDecipher("AES-CBC",r?a.keys.server_write_key:a.keys.client_write_key),iv:r?a.keys.server_write_IV:a.keys.client_write_IV},e.write.cipherState={init:!1,cipher:Gr.cipher.createCipher("AES-CBC",r?a.keys.client_write_key:a.keys.server_write_key),iv:r?a.keys.client_write_IV:a.keys.server_write_IV},e.read.cipherFunction=Ed,e.write.cipherFunction=xd,e.read.macLength=e.write.macLength=a.mac_length,e.read.macFunction=e.write.macFunction=rr.hmac_sha1}function xd(e,t){var a=!1,r=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(r),t.updateSequenceNumber();var n;e.version.minor===rr.Versions.TLS_1_0.minor?n=t.cipherState.init?null:t.cipherState.iv:n=Gr.random.getBytesSync(16),t.cipherState.init=!0;var i=t.cipherState.cipher;return i.start({iv:n}),e.version.minor>=rr.Versions.TLS_1_1.minor&&i.output.putBytes(n),i.update(e.fragment),i.finish(md)&&(e.fragment=i.output,e.length=e.fragment.length(),a=!0),a}function md(e,t,a){if(!a){var r=e-t.length()%e;t.fillWithByte(r-1,r)}return!0}function Cd(e,t,a){var r=!0;if(a){for(var n=t.length(),i=t.last(),s=n-1-i;s<n-1;++s)r=r&&t.at(s)==i;r&&t.truncate(i+1)}return r}function Ed(e,t){var a=!1,r;e.version.minor===rr.Versions.TLS_1_0.minor?r=t.cipherState.init?null:t.cipherState.iv:r=e.fragment.getBytes(16),t.cipherState.init=!0;var n=t.cipherState.cipher;n.start({iv:r}),n.update(e.fragment),a=n.finish(Cd);var i=t.macLength,s=Gr.random.getBytesSync(i),o=n.output.length();o>=i?(e.fragment=n.output.getBytes(o-i),s=n.output.getBytes(i)):e.fragment=n.output.getBytes(),e.fragment=Gr.util.createBuffer(e.fragment),e.length=e.fragment.length();var f=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),a=_d(t.macKey,s,f)&&a,a}function _d(e,t,a){var r=Gr.hmac.create();return r.start("SHA1",e),r.update(t),t=r.digest().getBytes(),r.start(null,null),r.update(a),a=r.digest().getBytes(),t===a}var st=Oe,Ja=st.sha512=st.sha512||{};st.md.sha512=st.md.algorithms.sha512=Ja;var Ho=st.sha384=st.sha512.sha384=st.sha512.sha384||{};Ho.create=function(){return Ja.create("SHA-384")};st.md.sha384=st.md.algorithms.sha384=Ho;st.sha512.sha256=st.sha512.sha256||{create:function(){return Ja.create("SHA-512/256")}};st.md["sha512/256"]=st.md.algorithms["sha512/256"]=st.sha512.sha256;st.sha512.sha224=st.sha512.sha224||{create:function(){return Ja.create("SHA-512/224")}};st.md["sha512/224"]=st.md.algorithms["sha512/224"]=st.sha512.sha224;Ja.create=function(e){if(zo||bd(),typeof e>"u"&&(e="SHA-512"),!(e in Jr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Jr[e],a=null,r=st.util.createBuffer(),n=new Array(80),i=0;i<80;++i)n[i]=new Array(2);var s=64;switch(e){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,l=0;l<f;++l)o.fullMessageLength.push(0);r=st.util.createBuffer(),a=new Array(t.length);for(var l=0;l<t.length;++l)a[l]=t[l].slice(0);return o},o.start(),o.update=function(f,l){l==="utf8"&&(f=st.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var c=o.fullMessageLength.length-1;c>=0;--c)o.fullMessageLength[c]+=u[1],u[1]=u[0]+(o.fullMessageLength[c]/4294967296>>>0),o.fullMessageLength[c]=o.fullMessageLength[c]>>>0,u[0]=u[1]/4294967296>>>0;return r.putBytes(f),bs(a,n,r),(r.read>2048||r.length()===0)&&r.compact(),o},o.digest=function(){var f=st.util.createBuffer();f.putBytes(r.bytes());var l=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=l&o.blockLength-1;f.putBytes(Ki.substr(0,o.blockLength-u));for(var c,d,h=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)c=o.fullMessageLength[p+1]*8,d=c/4294967296>>>0,h+=d,f.putInt32(h>>>0),h=c>>>0;f.putInt32(h);for(var v=new Array(a.length),p=0;p<a.length;++p)v[p]=a[p].slice(0);bs(v,n,f);var g=st.util.createBuffer(),C;e==="SHA-512"?C=v.length:e==="SHA-384"?C=v.length-2:C=v.length-4;for(var p=0;p<C;++p)g.putInt32(v[p][0]),(p!==C-1||e!=="SHA-512/224")&&g.putInt32(v[p][1]);return g},o};var Ki=null,zo=!1,Hi=null,Jr=null;function bd(){Ki=String.fromCharCode(128),Ki+=st.util.fillString(String.fromCharCode(0),128),Hi=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Jr={},Jr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Jr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Jr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Jr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],zo=!0}function bs(e,t,a){for(var r,n,i,s,o,f,l,u,c,d,h,p,v,g,C,x,y,S,T,A,k,B,O,I,w,P,V,$,K,H,q,ne,fe,X,M,G=a.length();G>=128;){for(K=0;K<16;++K)t[K][0]=a.getInt32()>>>0,t[K][1]=a.getInt32()>>>0;for(;K<80;++K)ne=t[K-2],H=ne[0],q=ne[1],r=((H>>>19|q<<13)^(q>>>29|H<<3)^H>>>6)>>>0,n=((H<<13|q>>>19)^(q<<3|H>>>29)^(H<<26|q>>>6))>>>0,X=t[K-15],H=X[0],q=X[1],i=((H>>>1|q<<31)^(H>>>8|q<<24)^H>>>7)>>>0,s=((H<<31|q>>>1)^(H<<24|q>>>8)^(H<<25|q>>>7))>>>0,fe=t[K-7],M=t[K-16],q=n+fe[1]+s+M[1],t[K][0]=r+fe[0]+i+M[0]+(q/4294967296>>>0)>>>0,t[K][1]=q>>>0;for(v=e[0][0],g=e[0][1],C=e[1][0],x=e[1][1],y=e[2][0],S=e[2][1],T=e[3][0],A=e[3][1],k=e[4][0],B=e[4][1],O=e[5][0],I=e[5][1],w=e[6][0],P=e[6][1],V=e[7][0],$=e[7][1],K=0;K<80;++K)l=((k>>>14|B<<18)^(k>>>18|B<<14)^(B>>>9|k<<23))>>>0,u=((k<<18|B>>>14)^(k<<14|B>>>18)^(B<<23|k>>>9))>>>0,c=(w^k&(O^w))>>>0,d=(P^B&(I^P))>>>0,o=((v>>>28|g<<4)^(g>>>2|v<<30)^(g>>>7|v<<25))>>>0,f=((v<<4|g>>>28)^(g<<30|v>>>2)^(g<<25|v>>>7))>>>0,h=(v&C|y&(v^C))>>>0,p=(g&x|S&(g^x))>>>0,q=$+u+d+Hi[K][1]+t[K][1],r=V+l+c+Hi[K][0]+t[K][0]+(q/4294967296>>>0)>>>0,n=q>>>0,q=f+p,i=o+h+(q/4294967296>>>0)>>>0,s=q>>>0,V=w,$=P,w=O,P=I,O=k,I=B,q=A+n,k=T+r+(q/4294967296>>>0)>>>0,B=q>>>0,T=y,A=S,y=C,S=x,C=v,x=g,q=n+s,v=r+i+(q/4294967296>>>0)>>>0,g=q>>>0;q=e[0][1]+g,e[0][0]=e[0][0]+v+(q/4294967296>>>0)>>>0,e[0][1]=q>>>0,q=e[1][1]+x,e[1][0]=e[1][0]+C+(q/4294967296>>>0)>>>0,e[1][1]=q>>>0,q=e[2][1]+S,e[2][0]=e[2][0]+y+(q/4294967296>>>0)>>>0,e[2][1]=q>>>0,q=e[3][1]+A,e[3][0]=e[3][0]+T+(q/4294967296>>>0)>>>0,e[3][1]=q>>>0,q=e[4][1]+B,e[4][0]=e[4][0]+k+(q/4294967296>>>0)>>>0,e[4][1]=q>>>0,q=e[5][1]+I,e[5][0]=e[5][0]+O+(q/4294967296>>>0)>>>0,e[5][1]=q>>>0,q=e[6][1]+P,e[6][0]=e[6][0]+w+(q/4294967296>>>0)>>>0,e[6][1]=q>>>0,q=e[7][1]+$,e[7][0]=e[7][0]+V+(q/4294967296>>>0)>>>0,e[7][1]=q>>>0,G-=128}}var d0={},Sd=Oe,St=Sd.asn1;d0.privateKeyValidator={name:"PrivateKeyInfo",tagClass:St.Class.UNIVERSAL,type:St.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:St.Class.UNIVERSAL,type:St.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:St.Class.UNIVERSAL,type:St.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:St.Class.UNIVERSAL,type:St.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:St.Class.UNIVERSAL,type:St.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};d0.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:St.Class.UNIVERSAL,type:St.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:St.Class.UNIVERSAL,type:St.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:St.Class.UNIVERSAL,type:St.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:St.Class.UNIVERSAL,type:St.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]};var kt=Oe,qo=d0,Td=qo.publicKeyValidator,Ad=qo.privateKeyValidator;if(typeof Bd>"u")var Bd=kt.jsbn.BigInteger;var zi=kt.util.ByteBuffer,qt=typeof Buffer>"u"?Uint8Array:Buffer;kt.pki=kt.pki||{};kt.pki.ed25519=kt.ed25519=kt.ed25519||{};var Me=kt.ed25519;Me.constants={};Me.constants.PUBLIC_KEY_BYTE_LENGTH=32;Me.constants.PRIVATE_KEY_BYTE_LENGTH=64;Me.constants.SEED_BYTE_LENGTH=32;Me.constants.SIGN_BYTE_LENGTH=64;Me.constants.HASH_BYTE_LENGTH=64;Me.generateKeyPair=function(e){e=e||{};var t=e.seed;if(t===void 0)t=kt.random.getBytesSync(Me.constants.SEED_BYTE_LENGTH);else if(typeof t=="string"){if(t.length!==Me.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+Me.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=wr({message:t,encoding:"binary"});for(var a=new qt(Me.constants.PUBLIC_KEY_BYTE_LENGTH),r=new qt(Me.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)r[n]=t[n];return Nd(a,r),{publicKey:a,privateKey:r}};Me.privateKeyFromAsn1=function(e){var t={},a=[],r=kt.asn1.validate(e,Ad,t,a);if(!r){var n=new Error("Invalid Key.");throw n.errors=a,n}var i=kt.asn1.derToOid(t.privateKeyOid),s=kt.oids.EdDSA25519;if(i!==s)throw new Error('Invalid OID "'+i+'"; OID must be "'+s+'".');var o=t.privateKey,f=wr({message:kt.asn1.fromDer(o).value,encoding:"binary"});return{privateKeyBytes:f}};Me.publicKeyFromAsn1=function(e){var t={},a=[],r=kt.asn1.validate(e,Td,t,a);if(!r){var n=new Error("Invalid Key.");throw n.errors=a,n}var i=kt.asn1.derToOid(t.publicKeyOid),s=kt.oids.EdDSA25519;if(i!==s)throw new Error('Invalid OID "'+i+'"; OID must be "'+s+'".');var o=t.ed25519PublicKey;if(o.length!==Me.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return wr({message:o,encoding:"binary"})};Me.publicKeyFromPrivateKey=function(e){e=e||{};var t=wr({message:e.privateKey,encoding:"binary"});if(t.length!==Me.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Me.constants.PRIVATE_KEY_BYTE_LENGTH);for(var a=new qt(Me.constants.PUBLIC_KEY_BYTE_LENGTH),r=0;r<a.length;++r)a[r]=t[32+r];return a};Me.sign=function(e){e=e||{};var t=wr(e),a=wr({message:e.privateKey,encoding:"binary"});if(a.length===Me.constants.SEED_BYTE_LENGTH){var r=Me.generateKeyPair({seed:a});a=r.privateKey}else if(a.length!==Me.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Me.constants.SEED_BYTE_LENGTH+" or "+Me.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new qt(Me.constants.SIGN_BYTE_LENGTH+t.length);Rd(n,t,t.length,a);for(var i=new qt(Me.constants.SIGN_BYTE_LENGTH),s=0;s<i.length;++s)i[s]=n[s];return i};Me.verify=function(e){e=e||{};var t=wr(e);if(e.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var a=wr({message:e.signature,encoding:"binary"});if(a.length!==Me.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+Me.constants.SIGN_BYTE_LENGTH);var r=wr({message:e.publicKey,encoding:"binary"});if(r.length!==Me.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+Me.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new qt(Me.constants.SIGN_BYTE_LENGTH+t.length),i=new qt(Me.constants.SIGN_BYTE_LENGTH+t.length),s;for(s=0;s<Me.constants.SIGN_BYTE_LENGTH;++s)n[s]=a[s];for(s=0;s<t.length;++s)n[s+Me.constants.SIGN_BYTE_LENGTH]=t[s];return Ld(i,n,n.length,r)>=0};function wr(e){var t=e.message;if(t instanceof Uint8Array||t instanceof qt)return t;var a=e.encoding;if(t===void 0)if(e.md)t=e.md.digest().getBytes(),a="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof t=="string"&&!a)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof t=="string"){if(typeof Buffer<"u")return Buffer.from(t,a);t=new zi(t,a)}else if(!(t instanceof zi))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var r=new qt(t.length()),n=0;n<r.length;++n)r[n]=t.at(n);return r}var qi=be(),_n=be([1]),Id=be([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),wd=be([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Ss=be([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Ts=be([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Ti=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),kd=be([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Ka(e,t){var a=kt.md.sha512.create(),r=new zi(e);a.update(r.getBytes(t),"binary");var n=a.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(n,"binary");for(var i=new qt(Me.constants.HASH_BYTE_LENGTH),s=0;s<64;++s)i[s]=n.charCodeAt(s);return i}function Nd(e,t){var a=[be(),be(),be(),be()],r,n=Ka(t,32);for(n[0]&=248,n[31]&=127,n[31]|=64,p0(a,n),h0(e,a),r=0;r<32;++r)t[r+32]=e[r];return 0}function Rd(e,t,a,r){var n,i,s=new Float64Array(64),o=[be(),be(),be(),be()],f=Ka(r,32);f[0]&=248,f[31]&=127,f[31]|=64;var l=a+64;for(n=0;n<a;++n)e[64+n]=t[n];for(n=0;n<32;++n)e[32+n]=f[32+n];var u=Ka(e.subarray(32),a+32);for(Gi(u),p0(o,u),h0(e,o),n=32;n<64;++n)e[n]=r[n];var c=Ka(e,a+64);for(Gi(c),n=32;n<64;++n)s[n]=0;for(n=0;n<32;++n)s[n]=u[n];for(n=0;n<32;++n)for(i=0;i<32;i++)s[n+i]+=c[n]*f[i];return Go(e.subarray(32),s),l}function Ld(e,t,a,r){var n,i,s=new qt(32),o=[be(),be(),be(),be()],f=[be(),be(),be(),be()];if(i=-1,a<64||Dd(f,r))return-1;for(n=0;n<a;++n)e[n]=t[n];for(n=0;n<32;++n)e[n+32]=r[n];var l=Ka(e,a);if(Gi(l),jo(o,f,l),p0(f,t.subarray(32)),Qi(o,f),h0(s,o),a-=64,Qo(t,0,s,0)){for(n=0;n<a;++n)e[n]=0;return-1}for(n=0;n<a;++n)e[n]=t[n+64];return i=a,i}function Go(e,t){var a,r,n,i;for(r=63;r>=32;--r){for(a=0,n=r-32,i=r-12;n<i;++n)t[n]+=a-16*t[r]*Ti[n-(r-32)],a=t[n]+128>>8,t[n]-=a*256;t[n]+=a,t[r]=0}for(a=0,n=0;n<32;++n)t[n]+=a-(t[31]>>4)*Ti[n],a=t[n]>>8,t[n]&=255;for(n=0;n<32;++n)t[n]-=a*Ti[n];for(r=0;r<32;++r)t[r+1]+=t[r]>>8,e[r]=t[r]&255}function Gi(e){for(var t=new Float64Array(64),a=0;a<64;++a)t[a]=e[a],e[a]=0;Go(e,t)}function Qi(e,t){var a=be(),r=be(),n=be(),i=be(),s=be(),o=be(),f=be(),l=be(),u=be();ga(a,e[1],e[0]),ga(u,t[1],t[0]),tt(a,a,u),pa(r,e[0],e[1]),pa(u,t[0],t[1]),tt(r,r,u),tt(n,e[3],t[3]),tt(n,n,wd),tt(i,e[2],t[2]),pa(i,i,i),ga(s,r,a),ga(o,i,n),pa(f,i,n),pa(l,r,a),tt(e[0],s,o),tt(e[1],l,f),tt(e[2],f,o),tt(e[3],s,l)}function As(e,t,a){for(var r=0;r<4;++r)Yo(e[r],t[r],a)}function h0(e,t){var a=be(),r=be(),n=be();Vd(n,t[2]),tt(a,t[0],n),tt(r,t[1],n),bn(e,r),e[31]^=Wo(a)<<7}function bn(e,t){var a,r,n,i=be(),s=be();for(a=0;a<16;++a)s[a]=t[a];for(Ai(s),Ai(s),Ai(s),r=0;r<2;++r){for(i[0]=s[0]-65517,a=1;a<15;++a)i[a]=s[a]-65535-(i[a-1]>>16&1),i[a-1]&=65535;i[15]=s[15]-32767-(i[14]>>16&1),n=i[15]>>16&1,i[14]&=65535,Yo(s,i,1-n)}for(a=0;a<16;a++)e[2*a]=s[a]&255,e[2*a+1]=s[a]>>8}function Dd(e,t){var a=be(),r=be(),n=be(),i=be(),s=be(),o=be(),f=be();return Kr(e[2],_n),Pd(e[1],t),$r(n,e[1]),tt(i,n,Id),ga(n,n,e[2]),pa(i,e[2],i),$r(s,i),$r(o,s),tt(f,o,s),tt(a,f,n),tt(a,a,i),Ud(a,a),tt(a,a,n),tt(a,a,i),tt(a,a,i),tt(e[0],a,i),$r(r,e[0]),tt(r,r,i),Bs(r,n)&&tt(e[0],e[0],kd),$r(r,e[0]),tt(r,r,i),Bs(r,n)?-1:(Wo(e[0])===t[31]>>7&&ga(e[0],qi,e[0]),tt(e[3],e[0],e[1]),0)}function Pd(e,t){var a;for(a=0;a<16;++a)e[a]=t[2*a]+(t[2*a+1]<<8);e[15]&=32767}function Ud(e,t){var a=be(),r;for(r=0;r<16;++r)a[r]=t[r];for(r=250;r>=0;--r)$r(a,a),r!==1&&tt(a,a,t);for(r=0;r<16;++r)e[r]=a[r]}function Bs(e,t){var a=new qt(32),r=new qt(32);return bn(a,e),bn(r,t),Qo(a,0,r,0)}function Qo(e,t,a,r){return Od(e,t,a,r,32)}function Od(e,t,a,r,n){var i,s=0;for(i=0;i<n;++i)s|=e[t+i]^a[r+i];return(1&s-1>>>8)-1}function Wo(e){var t=new qt(32);return bn(t,e),t[0]&1}function jo(e,t,a){var r,n;for(Kr(e[0],qi),Kr(e[1],_n),Kr(e[2],_n),Kr(e[3],qi),n=255;n>=0;--n)r=a[n/8|0]>>(n&7)&1,As(e,t,r),Qi(t,e),Qi(e,e),As(e,t,r)}function p0(e,t){var a=[be(),be(),be(),be()];Kr(a[0],Ss),Kr(a[1],Ts),Kr(a[2],_n),tt(a[3],Ss,Ts),jo(e,a,t)}function Kr(e,t){var a;for(a=0;a<16;a++)e[a]=t[a]|0}function Vd(e,t){var a=be(),r;for(r=0;r<16;++r)a[r]=t[r];for(r=253;r>=0;--r)$r(a,a),r!==2&&r!==4&&tt(a,a,t);for(r=0;r<16;++r)e[r]=a[r]}function Ai(e){var t,a,r=1;for(t=0;t<16;++t)a=e[t]+r+65535,r=Math.floor(a/65536),e[t]=a-r*65536;e[0]+=r-1+37*(r-1)}function Yo(e,t,a){for(var r,n=~(a-1),i=0;i<16;++i)r=n&(e[i]^t[i]),e[i]^=r,t[i]^=r}function be(e){var t,a=new Float64Array(16);if(e)for(t=0;t<e.length;++t)a[t]=e[t];return a}function pa(e,t,a){for(var r=0;r<16;++r)e[r]=t[r]+a[r]}function ga(e,t,a){for(var r=0;r<16;++r)e[r]=t[r]-a[r]}function $r(e,t){tt(e,t,t)}function tt(e,t,a){var r,n,i=0,s=0,o=0,f=0,l=0,u=0,c=0,d=0,h=0,p=0,v=0,g=0,C=0,x=0,y=0,S=0,T=0,A=0,k=0,B=0,O=0,I=0,w=0,P=0,V=0,$=0,K=0,H=0,q=0,ne=0,fe=0,X=a[0],M=a[1],G=a[2],Y=a[3],W=a[4],ve=a[5],he=a[6],xe=a[7],ae=a[8],ye=a[9],Pe=a[10],Re=a[11],Ae=a[12],Ie=a[13],me=a[14],Se=a[15];r=t[0],i+=r*X,s+=r*M,o+=r*G,f+=r*Y,l+=r*W,u+=r*ve,c+=r*he,d+=r*xe,h+=r*ae,p+=r*ye,v+=r*Pe,g+=r*Re,C+=r*Ae,x+=r*Ie,y+=r*me,S+=r*Se,r=t[1],s+=r*X,o+=r*M,f+=r*G,l+=r*Y,u+=r*W,c+=r*ve,d+=r*he,h+=r*xe,p+=r*ae,v+=r*ye,g+=r*Pe,C+=r*Re,x+=r*Ae,y+=r*Ie,S+=r*me,T+=r*Se,r=t[2],o+=r*X,f+=r*M,l+=r*G,u+=r*Y,c+=r*W,d+=r*ve,h+=r*he,p+=r*xe,v+=r*ae,g+=r*ye,C+=r*Pe,x+=r*Re,y+=r*Ae,S+=r*Ie,T+=r*me,A+=r*Se,r=t[3],f+=r*X,l+=r*M,u+=r*G,c+=r*Y,d+=r*W,h+=r*ve,p+=r*he,v+=r*xe,g+=r*ae,C+=r*ye,x+=r*Pe,y+=r*Re,S+=r*Ae,T+=r*Ie,A+=r*me,k+=r*Se,r=t[4],l+=r*X,u+=r*M,c+=r*G,d+=r*Y,h+=r*W,p+=r*ve,v+=r*he,g+=r*xe,C+=r*ae,x+=r*ye,y+=r*Pe,S+=r*Re,T+=r*Ae,A+=r*Ie,k+=r*me,B+=r*Se,r=t[5],u+=r*X,c+=r*M,d+=r*G,h+=r*Y,p+=r*W,v+=r*ve,g+=r*he,C+=r*xe,x+=r*ae,y+=r*ye,S+=r*Pe,T+=r*Re,A+=r*Ae,k+=r*Ie,B+=r*me,O+=r*Se,r=t[6],c+=r*X,d+=r*M,h+=r*G,p+=r*Y,v+=r*W,g+=r*ve,C+=r*he,x+=r*xe,y+=r*ae,S+=r*ye,T+=r*Pe,A+=r*Re,k+=r*Ae,B+=r*Ie,O+=r*me,I+=r*Se,r=t[7],d+=r*X,h+=r*M,p+=r*G,v+=r*Y,g+=r*W,C+=r*ve,x+=r*he,y+=r*xe,S+=r*ae,T+=r*ye,A+=r*Pe,k+=r*Re,B+=r*Ae,O+=r*Ie,I+=r*me,w+=r*Se,r=t[8],h+=r*X,p+=r*M,v+=r*G,g+=r*Y,C+=r*W,x+=r*ve,y+=r*he,S+=r*xe,T+=r*ae,A+=r*ye,k+=r*Pe,B+=r*Re,O+=r*Ae,I+=r*Ie,w+=r*me,P+=r*Se,r=t[9],p+=r*X,v+=r*M,g+=r*G,C+=r*Y,x+=r*W,y+=r*ve,S+=r*he,T+=r*xe,A+=r*ae,k+=r*ye,B+=r*Pe,O+=r*Re,I+=r*Ae,w+=r*Ie,P+=r*me,V+=r*Se,r=t[10],v+=r*X,g+=r*M,C+=r*G,x+=r*Y,y+=r*W,S+=r*ve,T+=r*he,A+=r*xe,k+=r*ae,B+=r*ye,O+=r*Pe,I+=r*Re,w+=r*Ae,P+=r*Ie,V+=r*me,$+=r*Se,r=t[11],g+=r*X,C+=r*M,x+=r*G,y+=r*Y,S+=r*W,T+=r*ve,A+=r*he,k+=r*xe,B+=r*ae,O+=r*ye,I+=r*Pe,w+=r*Re,P+=r*Ae,V+=r*Ie,$+=r*me,K+=r*Se,r=t[12],C+=r*X,x+=r*M,y+=r*G,S+=r*Y,T+=r*W,A+=r*ve,k+=r*he,B+=r*xe,O+=r*ae,I+=r*ye,w+=r*Pe,P+=r*Re,V+=r*Ae,$+=r*Ie,K+=r*me,H+=r*Se,r=t[13],x+=r*X,y+=r*M,S+=r*G,T+=r*Y,A+=r*W,k+=r*ve,B+=r*he,O+=r*xe,I+=r*ae,w+=r*ye,P+=r*Pe,V+=r*Re,$+=r*Ae,K+=r*Ie,H+=r*me,q+=r*Se,r=t[14],y+=r*X,S+=r*M,T+=r*G,A+=r*Y,k+=r*W,B+=r*ve,O+=r*he,I+=r*xe,w+=r*ae,P+=r*ye,V+=r*Pe,$+=r*Re,K+=r*Ae,H+=r*Ie,q+=r*me,ne+=r*Se,r=t[15],S+=r*X,T+=r*M,A+=r*G,k+=r*Y,B+=r*W,O+=r*ve,I+=r*he,w+=r*xe,P+=r*ae,V+=r*ye,$+=r*Pe,K+=r*Re,H+=r*Ae,q+=r*Ie,ne+=r*me,fe+=r*Se,i+=38*T,s+=38*A,o+=38*k,f+=38*B,l+=38*O,u+=38*I,c+=38*w,d+=38*P,h+=38*V,p+=38*$,v+=38*K,g+=38*H,C+=38*q,x+=38*ne,y+=38*fe,n=1,r=i+n+65535,n=Math.floor(r/65536),i=r-n*65536,r=s+n+65535,n=Math.floor(r/65536),s=r-n*65536,r=o+n+65535,n=Math.floor(r/65536),o=r-n*65536,r=f+n+65535,n=Math.floor(r/65536),f=r-n*65536,r=l+n+65535,n=Math.floor(r/65536),l=r-n*65536,r=u+n+65535,n=Math.floor(r/65536),u=r-n*65536,r=c+n+65535,n=Math.floor(r/65536),c=r-n*65536,r=d+n+65535,n=Math.floor(r/65536),d=r-n*65536,r=h+n+65535,n=Math.floor(r/65536),h=r-n*65536,r=p+n+65535,n=Math.floor(r/65536),p=r-n*65536,r=v+n+65535,n=Math.floor(r/65536),v=r-n*65536,r=g+n+65535,n=Math.floor(r/65536),g=r-n*65536,r=C+n+65535,n=Math.floor(r/65536),C=r-n*65536,r=x+n+65535,n=Math.floor(r/65536),x=r-n*65536,r=y+n+65535,n=Math.floor(r/65536),y=r-n*65536,r=S+n+65535,n=Math.floor(r/65536),S=r-n*65536,i+=n-1+37*(n-1),n=1,r=i+n+65535,n=Math.floor(r/65536),i=r-n*65536,r=s+n+65535,n=Math.floor(r/65536),s=r-n*65536,r=o+n+65535,n=Math.floor(r/65536),o=r-n*65536,r=f+n+65535,n=Math.floor(r/65536),f=r-n*65536,r=l+n+65535,n=Math.floor(r/65536),l=r-n*65536,r=u+n+65535,n=Math.floor(r/65536),u=r-n*65536,r=c+n+65535,n=Math.floor(r/65536),c=r-n*65536,r=d+n+65535,n=Math.floor(r/65536),d=r-n*65536,r=h+n+65535,n=Math.floor(r/65536),h=r-n*65536,r=p+n+65535,n=Math.floor(r/65536),p=r-n*65536,r=v+n+65535,n=Math.floor(r/65536),v=r-n*65536,r=g+n+65535,n=Math.floor(r/65536),g=r-n*65536,r=C+n+65535,n=Math.floor(r/65536),C=r-n*65536,r=x+n+65535,n=Math.floor(r/65536),x=r-n*65536,r=y+n+65535,n=Math.floor(r/65536),y=r-n*65536,r=S+n+65535,n=Math.floor(r/65536),S=r-n*65536,i+=n-1+37*(n-1),e[0]=i,e[1]=s,e[2]=o,e[3]=f,e[4]=l,e[5]=u,e[6]=c,e[7]=d,e[8]=h,e[9]=p,e[10]=v,e[11]=g,e[12]=C,e[13]=x,e[14]=y,e[15]=S}var Xt=Oe;Xt.kem=Xt.kem||{};var Is=Xt.jsbn.BigInteger;Xt.kem.rsa={};Xt.kem.rsa.create=function(e,t){t=t||{};var a=t.prng||Xt.random,r={};return r.encrypt=function(n,i){var s=Math.ceil(n.n.bitLength()/8),o;do o=new Is(Xt.util.bytesToHex(a.getBytesSync(s)),16).mod(n.n);while(o.compareTo(Is.ONE)<=0);o=Xt.util.hexToBytes(o.toString(16));var f=s-o.length;f>0&&(o=Xt.util.fillString(String.fromCharCode(0),f)+o);var l=n.encrypt(o,"NONE"),u=e.generate(o,i);return{encapsulation:l,key:u}},r.decrypt=function(n,i,s){var o=n.decrypt(i,"NONE");return e.generate(o,s)},r};Xt.kem.kdf1=function(e,t){Xo(this,e,0,t||e.digestLength)};Xt.kem.kdf2=function(e,t){Xo(this,e,1,t||e.digestLength)};function Xo(e,t,a,r){e.generate=function(n,i){for(var s=new Xt.util.ByteBuffer,o=Math.ceil(i/r)+a,f=new Xt.util.ByteBuffer,l=a;l<o;++l){f.putInt32(l),t.start(),t.update(n+f.getBytes());var u=t.digest();s.putBytes(u.getBytes(r))}return s.truncate(s.length()-i),s.getBytes()}}var ze=Oe;ze.log=ze.log||{};ze.log.levels=["none","error","warning","info","debug","verbose","max"];var Sn={},Wi=[],Ha=null;ze.log.LEVEL_LOCKED=2;ze.log.NO_LEVEL_CHECK=4;ze.log.INTERPOLATE=8;for(var Hr=0;Hr<ze.log.levels.length;++Hr){var ws=ze.log.levels[Hr];Sn[ws]={index:Hr,name:ws.toUpperCase()}}ze.log.logMessage=function(e){for(var t=Sn[e.level].index,a=0;a<Wi.length;++a){var r=Wi[a];if(r.flags&ze.log.NO_LEVEL_CHECK)r.f(e);else{var n=Sn[r.level].index;t<=n&&r.f(r,e)}}};ze.log.prepareStandard=function(e){"standard"in e||(e.standard=Sn[e.level].name+" ["+e.category+"] "+e.message)};ze.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]),e.full=ze.util.format.apply(this,t)}};ze.log.prepareStandardFull=function(e){"standardFull"in e||(ze.log.prepareStandard(e),e.standardFull=e.standard)};for(var ks=["error","warning","info","debug","verbose"],Hr=0;Hr<ks.length;++Hr)(function(t){ze.log[t]=function(a,r){var n=Array.prototype.slice.call(arguments).slice(2),i={timestamp:new Date,level:t,category:a,message:r,arguments:n};ze.log.logMessage(i)}})(ks[Hr]);ze.log.makeLogger=function(e){var t={flags:0,f:e};return ze.log.setLevel(t,"none"),t};ze.log.setLevel=function(e,t){var a=!1;if(e&&!(e.flags&ze.log.LEVEL_LOCKED))for(var r=0;r<ze.log.levels.length;++r){var n=ze.log.levels[r];if(t==n){e.level=t,a=!0;break}}return a};ze.log.lock=function(e,t){typeof t>"u"||t?e.flags|=ze.log.LEVEL_LOCKED:e.flags&=~ze.log.LEVEL_LOCKED};ze.log.addLogger=function(e){Wi.push(e)};if(typeof console<"u"&&"log"in console){var Ua;if(console.error&&console.warn&&console.info&&console.debug){var Fd={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},v0=function(e,t){ze.log.prepareStandard(t);var a=Fd[t.level],r=[t.standard];r=r.concat(t.arguments.slice()),a.apply(console,r)};Ua=ze.log.makeLogger(v0)}else{var v0=function(t,a){ze.log.prepareStandardFull(a),console.log(a.standardFull)};Ua=ze.log.makeLogger(v0)}ze.log.setLevel(Ua,"debug"),ze.log.addLogger(Ua),Ha=Ua}else console={log:function(){}};if(Ha!==null&&typeof window<"u"&&window.location){var on=new URL(window.location.href).searchParams;if(on.has("console.level")&&ze.log.setLevel(Ha,on.get("console.level").slice(-1)[0]),on.has("console.lock")){var Md=on.get("console.lock").slice(-1)[0];Md=="true"&&ze.log.lock(Ha)}}ze.log.consoleLogger=Ha;var oe=Oe,U=oe.asn1,Ft=oe.pkcs7=oe.pkcs7||{};Ft.messageFromPem=function(e){var t=oe.pem.decode(e)[0];if(t.type!=="PKCS7"){var a=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var r=U.fromDer(t.body);return Ft.messageFromAsn1(r)};Ft.messageToPem=function(e,t){var a={type:"PKCS7",body:U.toDer(e.toAsn1()).getBytes()};return oe.pem.encode(a,{maxline:t})};Ft.messageFromAsn1=function(e){var t={},a=[];if(!U.validate(e,Ft.asn1.contentInfoValidator,t,a)){var r=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw r.errors=a,r}var n=U.derToOid(t.contentType),i;switch(n){case oe.pki.oids.envelopedData:i=Ft.createEnvelopedData();break;case oe.pki.oids.encryptedData:i=Ft.createEncryptedData();break;case oe.pki.oids.signedData:i=Ft.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return i.fromAsn1(t.content.value[0]),i};Ft.createSignedData=function(){var e=null;return e={type:oe.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(r){if(g0(e,r,Ft.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var n=e.rawCapture.certificates.value,i=0;i<n.length;++i)e.certificates.push(oe.pki.certificateFromAsn1(n[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var r=[],n=0;n<e.certificates.length;++n)r.push(oe.pki.certificateToAsn1(e.certificates[n]));var i=[],s=U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(e.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return r.length>0&&s.value[0].value.push(U.create(U.Class.CONTEXT_SPECIFIC,0,!0,r)),i.length>0&&s.value[0].value.push(U.create(U.Class.CONTEXT_SPECIFIC,1,!0,i)),s.value[0].value.push(U.create(U.Class.UNIVERSAL,U.Type.SET,!0,e.signerInfos)),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(e.type).getBytes()),s])},addSigner:function(r){var n=r.issuer,i=r.serialNumber;if(r.certificate){var s=r.certificate;typeof s=="string"&&(s=oe.pki.certificateFromPem(s)),n=s.issuer.attributes,i=s.serialNumber}var o=r.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof o=="string"&&(o=oe.pki.privateKeyFromPem(o));var f=r.digestAlgorithm||oe.pki.oids.sha1;switch(f){case oe.pki.oids.sha1:case oe.pki.oids.sha256:case oe.pki.oids.sha384:case oe.pki.oids.sha512:case oe.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+f)}var l=r.authenticatedAttributes||[];if(l.length>0){for(var u=!1,c=!1,d=0;d<l.length;++d){var h=l[d];if(!u&&h.type===oe.pki.oids.contentType){if(u=!0,c)break;continue}if(!c&&h.type===oe.pki.oids.messageDigest){if(c=!0,u)break;continue}}if(!u||!c)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:n,serialNumber:i,digestAlgorithm:f,signatureAlgorithm:oe.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:l,unauthenticatedAttributes:[]})},sign:function(r){if(r=r||{},(typeof e.content!="object"||e.contentInfo===null)&&(e.contentInfo=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(oe.pki.oids.data).getBytes())]),"content"in e)){var n;e.content instanceof oe.util.ByteBuffer?n=e.content.bytes():typeof e.content=="string"&&(n=oe.util.encodeUtf8(e.content)),r.detached?e.detachedContent=U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,n):e.contentInfo.value.push(U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,n)]))}if(e.signers.length!==0){var i=t();a(i)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(r){typeof r=="string"&&(r=oe.pki.certificateFromPem(r)),e.certificates.push(r)},addCertificateRevokationList:function(r){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var r={},n=0;n<e.signers.length;++n){var i=e.signers[n],s=i.digestAlgorithm;s in r||(r[s]=oe.md[oe.pki.oids[s]].create()),i.authenticatedAttributes.length===0?i.md=r[s]:i.md=oe.md[oe.pki.oids[s]].create()}e.digestAlgorithmIdentifiers=[];for(var s in r)e.digestAlgorithmIdentifiers.push(U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(s).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")]));return r}function a(r){var n;if(e.detachedContent?n=e.detachedContent:(n=e.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i=U.derToOid(e.contentInfo.value[0].value),s=U.toDer(n);s.getByte(),U.getBerValueLength(s),s=s.getBytes();for(var o in r)r[o].start().update(s);for(var f=new Date,l=0;l<e.signers.length;++l){var u=e.signers[l];if(u.authenticatedAttributes.length===0){if(i!==oe.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{u.authenticatedAttributesAsn1=U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var c=U.create(U.Class.UNIVERSAL,U.Type.SET,!0,[]),d=0;d<u.authenticatedAttributes.length;++d){var h=u.authenticatedAttributes[d];h.type===oe.pki.oids.messageDigest?h.value=r[u.digestAlgorithm].digest():h.type===oe.pki.oids.signingTime&&(h.value||(h.value=f)),c.value.push(ji(h)),u.authenticatedAttributesAsn1.value.push(ji(h))}s=U.toDer(c).getBytes(),u.md.start().update(s)}u.signature=u.key.sign(u.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=Qd(e.signers)}};Ft.createEncryptedData=function(){var e=null;return e={type:oe.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:oe.pki.oids["aes256-CBC"]},fromAsn1:function(t){g0(e,t,Ft.asn1.encryptedDataValidator)},decrypt:function(t){t!==void 0&&(e.encryptedContent.key=t),Zo(e)}},e};Ft.createEnvelopedData=function(){var e=null;return e={type:oe.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:oe.pki.oids["aes256-CBC"]},fromAsn1:function(t){var a=g0(e,t,Ft.asn1.envelopedDataValidator);e.recipients=zd(a.recipientInfos.value)},toAsn1:function(){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(e.type).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(e.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,qd(e.recipients)),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,Wd(e.encryptedContent))])])])},findRecipient:function(t){for(var a=t.issuer.attributes,r=0;r<e.recipients.length;++r){var n=e.recipients[r],i=n.issuer;if(n.serialNumber===t.serialNumber&&i.length===a.length){for(var s=!0,o=0;o<a.length;++o)if(i[o].type!==a[o].type||i[o].value!==a[o].value){s=!1;break}if(s)return n}}return null},decrypt:function(t,a){if(e.encryptedContent.key===void 0&&t!==void 0&&a!==void 0)switch(t.encryptedContent.algorithm){case oe.pki.oids.rsaEncryption:case oe.pki.oids.desCBC:var r=a.decrypt(t.encryptedContent.content);e.encryptedContent.key=oe.util.createBuffer(r);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}Zo(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:oe.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,a){if(e.encryptedContent.content===void 0){a=a||e.encryptedContent.algorithm,t=t||e.encryptedContent.key;var r,n,i;switch(a){case oe.pki.oids["aes128-CBC"]:r=16,n=16,i=oe.aes.createEncryptionCipher;break;case oe.pki.oids["aes192-CBC"]:r=24,n=16,i=oe.aes.createEncryptionCipher;break;case oe.pki.oids["aes256-CBC"]:r=32,n=16,i=oe.aes.createEncryptionCipher;break;case oe.pki.oids["des-EDE3-CBC"]:r=24,n=8,i=oe.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+a)}if(t===void 0)t=oe.util.createBuffer(oe.random.getBytes(r));else if(t.length()!=r)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+r+".");e.encryptedContent.algorithm=a,e.encryptedContent.key=t,e.encryptedContent.parameter=oe.util.createBuffer(oe.random.getBytes(n));var s=i(t);if(s.start(e.encryptedContent.parameter.copy()),s.update(e.content),!s.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=s.output}for(var o=0;o<e.recipients.length;++o){var f=e.recipients[o];if(f.encryptedContent.content===void 0)switch(f.encryptedContent.algorithm){case oe.pki.oids.rsaEncryption:f.encryptedContent.content=f.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+f.encryptedContent.algorithm)}}}},e};function Kd(e){var t={},a=[];if(!U.validate(e,Ft.asn1.recipientInfoValidator,t,a)){var r=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw r.errors=a,r}return{version:t.version.charCodeAt(0),issuer:oe.pki.RDNAttributesAsArray(t.issuer),serialNumber:oe.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:U.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function Hd(e){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(e.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[oe.pki.distinguishedNameToAsn1({attributes:e.issuer}),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,oe.util.hexToBytes(e.serialNumber))]),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(e.encryptedContent.algorithm).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")]),U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function zd(e){for(var t=[],a=0;a<e.length;++a)t.push(Kd(e[a]));return t}function qd(e){for(var t=[],a=0;a<e.length;++a)t.push(Hd(e[a]));return t}function Gd(e){var t=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(e.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[oe.pki.distinguishedNameToAsn1({attributes:e.issuer}),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,oe.util.hexToBytes(e.serialNumber))]),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(e.digestAlgorithm).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(e.signatureAlgorithm).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")])),t.value.push(U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var a=U.create(U.Class.CONTEXT_SPECIFIC,1,!0,[]),r=0;r<e.unauthenticatedAttributes.length;++r){var n=e.unauthenticatedAttributes[r];a.values.push(ji(n))}t.value.push(a)}return t}function Qd(e){for(var t=[],a=0;a<e.length;++a)t.push(Gd(e[a]));return t}function ji(e){var t;if(e.type===oe.pki.oids.contentType)t=U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(e.value).getBytes());else if(e.type===oe.pki.oids.messageDigest)t=U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===oe.pki.oids.signingTime){var a=new Date("1950-01-01T00:00:00Z"),r=new Date("2050-01-01T00:00:00Z"),n=e.value;if(typeof n=="string"){var i=Date.parse(n);isNaN(i)?n.length===13?n=U.utcTimeToDate(n):n=U.generalizedTimeToDate(n):n=new Date(i)}n>=a&&n<r?t=U.create(U.Class.UNIVERSAL,U.Type.UTCTIME,!1,U.dateToUtcTime(n)):t=U.create(U.Class.UNIVERSAL,U.Type.GENERALIZEDTIME,!1,U.dateToGeneralizedTime(n))}return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(e.type).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,[t])])}function Wd(e){return[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(oe.pki.oids.data).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(e.algorithm).getBytes()),e.parameter?U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,e.parameter.getBytes()):void 0]),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,e.content.getBytes())])]}function g0(e,t,a){var r={},n=[];if(!U.validate(t,a,r,n)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw i.errors=i,i}var s=U.derToOid(r.contentType);if(s!==oe.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(r.encryptedContent){var o="";if(oe.util.isArray(r.encryptedContent))for(var f=0;f<r.encryptedContent.length;++f){if(r.encryptedContent[f].type!==U.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");o+=r.encryptedContent[f].value}else o=r.encryptedContent;e.encryptedContent={algorithm:U.derToOid(r.encAlgorithm),parameter:oe.util.createBuffer(r.encParameter.value),content:oe.util.createBuffer(o)}}if(r.content){var o="";if(oe.util.isArray(r.content))for(var f=0;f<r.content.length;++f){if(r.content[f].type!==U.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");o+=r.content[f].value}else o=r.content;e.content=oe.util.createBuffer(o)}return e.version=r.version.charCodeAt(0),e.rawCapture=r,r}function Zo(e){if(e.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(e.content===void 0){var t;switch(e.encryptedContent.algorithm){case oe.pki.oids["aes128-CBC"]:case oe.pki.oids["aes192-CBC"]:case oe.pki.oids["aes256-CBC"]:t=oe.aes.createDecryptionCipher(e.encryptedContent.key);break;case oe.pki.oids.desCBC:case oe.pki.oids["des-EDE3-CBC"]:t=oe.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}var vt=Oe,Vn=vt.ssh=vt.ssh||{};Vn.privateKeyToPutty=function(e,t,a){a=a||"",t=t||"";var r="ssh-rsa",n=t===""?"none":"aes256-cbc",i="PuTTY-User-Key-File-2: "+r+`\r
`;i+="Encryption: "+n+`\r
`,i+="Comment: "+a+`\r
`;var s=vt.util.createBuffer();ya(s,r),yr(s,e.e),yr(s,e.n);var o=vt.util.encode64(s.bytes(),64),f=Math.floor(o.length/66)+1;i+="Public-Lines: "+f+`\r
`,i+=o;var l=vt.util.createBuffer();yr(l,e.d),yr(l,e.p),yr(l,e.q),yr(l,e.qInv);var u;if(!t)u=vt.util.encode64(l.bytes(),64);else{var c=l.length()+16-1;c-=c%16;var d=ln(l.bytes());d.truncate(d.length()-c+l.length()),l.putBuffer(d);var h=vt.util.createBuffer();h.putBuffer(ln("\0\0\0\0",t)),h.putBuffer(ln("\0\0\0",t));var p=vt.aes.createEncryptionCipher(h.truncate(8),"CBC");p.start(vt.util.createBuffer().fillWithByte(0,16)),p.update(l.copy()),p.finish();var v=p.output;v.truncate(16),u=vt.util.encode64(v.bytes(),64)}f=Math.floor(u.length/66)+1,i+=`\r
Private-Lines: `+f+`\r
`,i+=u;var g=ln("putty-private-key-file-mac-key",t),C=vt.util.createBuffer();ya(C,r),ya(C,n),ya(C,a),C.putInt32(s.length()),C.putBuffer(s),C.putInt32(l.length()),C.putBuffer(l);var x=vt.hmac.create();return x.start("sha1",g),x.update(C.bytes()),i+=`\r
Private-MAC: `+x.digest().toHex()+`\r
`,i};Vn.publicKeyToOpenSSH=function(e,t){var a="ssh-rsa";t=t||"";var r=vt.util.createBuffer();return ya(r,a),yr(r,e.e),yr(r,e.n),a+" "+vt.util.encode64(r.bytes())+" "+t};Vn.privateKeyToOpenSSH=function(e,t){return t?vt.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):vt.pki.privateKeyToPem(e)};Vn.getPublicKeyFingerprint=function(e,t){t=t||{};var a=t.md||vt.md.md5.create(),r="ssh-rsa",n=vt.util.createBuffer();ya(n,r),yr(n,e.e),yr(n,e.n),a.start(),a.update(n.getBytes());var i=a.digest();if(t.encoding==="hex"){var s=i.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return i.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return i};function yr(e,t){var a=t.toString(16);a[0]>="8"&&(a="00"+a);var r=vt.util.hexToBytes(a);e.putInt32(r.length),e.putBytes(r)}function ya(e,t){e.putInt32(t.length),e.putString(t)}function ln(){for(var e=vt.md.sha1.create(),t=arguments.length,a=0;a<t;++a)e.update(arguments[a]);return e.digest()}var jd=Oe;const Ur=ro(jd);class Xe{static findUpdates(t,a){let r=Object.keys(t),n=Object.keys(a),i={};for(const s of n)if(!r.includes(s))i[s]=a[s];else{let o=t[s],f=a[s];if(typeof o=="object"){let l=Xe.findUpdates(o,f);Object.keys(l).length>0&&(i[s]=l)}else o!=f&&(i[s]=f)}return i}static cloneDeep(t){if(!t||typeof t!="object"||t instanceof Date||t instanceof Map||t instanceof Set||t instanceof Array)return Xe.cloneValue(t);let a=Object.keys(t),r={};for(let n of a){let i=t[n];r[n]=Xe.cloneValue(i)}return r}static cloneValue(t){if(t===null)return null;if(t===void 0)return;if(t instanceof Array){let a=[];for(let r of t)a.push(Xe.cloneValue(r));return a}else if(t instanceof Map){let a=new Map;return a.forEach((r,n)=>{a.set(n,Xe.cloneValue(r))}),a}else if(t instanceof Set){let a=new Set;return a.forEach(r=>{a.add(Xe.cloneValue(r))}),a}else return t instanceof Date?new Date(t.getDate()):typeof t=="object"?Xe.cloneDeep(t):t}static equalsDeep(t,a){if(t==null&&a==null)return!0;if(t==null||a==null)return!1;let r=Object.keys(t),n=Object.keys(a);if(r.length!=n.length)return!1;for(let i of r){let s=t[i],o=a[i];if(typeof s=="object"){if(!Xe.equalsDeep(s,o))return!1}else if(s!=o)return!1}return!0}}function Yd(e){let t,a,r,n,i,s,o,f,l,u,c,d,h;const p=e[6].default,v=gl(p,e,e[5],null);return{c(){t=N("main"),a=N("div"),r=Q(),n=N("div"),i=N("div"),s=N("div"),v&&v.c(),o=Q(),f=N("div"),l=N("button"),u=de(e[3]),R(a,"class","background svelte-95myax"),L(s,"color","#333"),R(i,"class","content-box svelte-95myax"),L(l,"width","150px"),L(f,"width","100%"),L(f,"display","flex"),L(f,"justify-content","center"),L(f,"align-items","center"),R(n,"class","popup-box svelte-95myax"),L(n,"height",e[2]+"px"),L(n,"width",e[1]+"px"),L(t,"display",e[0]?"flex":"none"),R(t,"class","svelte-95myax")},m(g,C){le(g,t,C),m(t,a),m(t,r),m(t,n),m(n,i),m(i,s),v&&v.m(s,null),m(n,o),m(n,f),m(f,l),m(l,u),c=!0,d||(h=_e(l,"click",e[4]),d=!0)},p(g,[C]){v&&v.p&&(!c||C&32)&&xl(v,p,g,g[5],c?yl(p,g[5],C,null):ml(g[5]),null),(!c||C&8)&&Ke(u,g[3]),(!c||C&4)&&L(n,"height",g[2]+"px"),(!c||C&2)&&L(n,"width",g[1]+"px"),(!c||C&1)&&L(t,"display",g[0]?"flex":"none")},i(g){c||(Te(v,g),c=!0)},o(g){De(v,g),c=!1},d(g){g&&se(t),v&&v.d(g),d=!1,h()}}}function Xd(e,t,a){let{$$slots:r={},$$scope:n}=t,{width:i=320}=t,{height:s=150}=t,{show:o=!1}=t,{button:f="Ok"}=t;const l=Ya();let u=()=>{l("close"),setTimeout(()=>{a(0,o=!1)},0)};return e.$$set=c=>{"width"in c&&a(1,i=c.width),"height"in c&&a(2,s=c.height),"show"in c&&a(0,o=c.show),"button"in c&&a(3,f=c.button),"$$scope"in c&&a(5,n=c.$$scope)},[o,i,s,f,u,n,r]}class wa extends Wt{constructor(t){super(),Qt(this,t,Xd,Yd,Gt,{width:1,height:2,show:0,button:3})}}function Ns(e){let t;return{c(){t=N("ul"),t.innerHTML='<li class="svelte-1dinodq">If you do not upload a cert, a random key will be used.</li> <li class="svelte-1dinodq">If an incorrect cert is uploaded, it will work with HTTP.</li>',R(t,"class","svelte-1dinodq")},m(a,r){le(a,t,r)},d(a){a&&se(t)}}}function Zd(e){let t;return{c(){t=de(e[6])},m(a,r){le(a,t,r)},p(a,r){r[0]&64&&Ke(t,a[6])},d(a){a&&se(t)}}}function Jd(e){let t,a,r,n,i,s,o,f,l,u,c,d,h,p,v,g,C,x,y,S,T,A,k,B,O,I,w,P,V=e[0]===!1&&Ns();function $(H){e[17](H)}let K={$$slots:{default:[Zd]},$$scope:{ctx:e}};return e[5]!==void 0&&(K.show=e[5]),B=new wa({props:K}),ft.push(()=>Ht(B,"show",$)),{c(){t=N("main"),a=N("div"),r=N("div"),n=Q(),i=N("div"),s=N("div"),s.innerHTML='Key<span style="font-weight: bold;color: saddlebrown; font-size: 9pt">*</span>',o=Q(),f=N("input"),l=Q(),u=N("div"),c=N("div"),c.innerHTML='Cert<span style="font-weight: bold;color: saddlebrown; font-size: 9pt">*</span>',d=Q(),h=N("input"),p=Q(),v=N("div"),g=N("div"),g.textContent="CA",C=Q(),x=N("input"),y=Q(),S=N("div"),T=N("button"),T.textContent="X",A=Q(),V&&V.c(),k=Q(),ut(B.$$.fragment),R(r,"class","cert-select-box-vertical-line svelte-1dinodq"),R(s,"class","form-label file-label svelte-1dinodq"),L(s,"display","inline-block"),R(f,"type","file"),R(f,"class","form-control"),R(f,"accept",".pem, *.crt, *.cer"),L(f,"width",e[1]+"px"),R(i,"class","input-box file-input-box svelte-1dinodq"),R(c,"class","form-label file-label svelte-1dinodq"),L(c,"display","inline"),R(h,"type","file"),R(h,"class","form-control"),R(h,"accept",".pem, *.crt, *.cer"),L(h,"width",e[1]+"px"),R(u,"class","input-box file-input-box svelte-1dinodq"),R(g,"class","form-label file-label svelte-1dinodq"),L(g,"display","inline-block"),R(x,"type","file"),R(x,"class","form-control"),R(x,"accept",".pem, *.crt, *.cer"),L(x,"width",e[1]+"px"),R(T,"class","text-button-x svelte-1dinodq"),R(T,"aria-pressed","true"),L(S,"display","inline"),L(S,"position","relative"),R(v,"class","input-box file-input-box svelte-1dinodq"),R(a,"class","cert-select-box svelte-1dinodq")},m(H,q){le(H,t,q),m(t,a),m(a,r),m(a,n),m(a,i),m(i,s),m(i,o),m(i,f),e[12](f),m(a,l),m(a,u),m(u,c),m(u,d),m(u,h),e[14](h),m(a,p),m(a,v),m(v,g),m(v,C),m(v,x),e[16](x),m(v,y),m(v,S),m(S,T),m(a,A),V&&V.m(a,null),m(t,k),ot(B,t,null),I=!0,w||(P=[_e(f,"keyup",e[7]),_e(f,"input",e[11]),_e(h,"keyup",e[7]),_e(h,"input",e[13]),_e(x,"keyup",e[7]),_e(x,"input",e[15]),_e(T,"click",e[9])],w=!0)},p(H,q){(!I||q[0]&2)&&L(f,"width",H[1]+"px"),(!I||q[0]&2)&&L(h,"width",H[1]+"px"),(!I||q[0]&2)&&L(x,"width",H[1]+"px"),H[0]===!1?V||(V=Ns(),V.c(),V.m(a,null)):V&&(V.d(1),V=null);const ne={};q[0]&64|q[1]&4&&(ne.$$scope={dirty:q,ctx:H}),!O&&q[0]&32&&(O=!0,ne.show=H[5],Kt(()=>O=!1)),B.$set(ne)},i(H){I||(Te(B.$$.fragment,H),I=!0)},o(H){De(B.$$.fragment,H),I=!1},d(H){H&&se(t),e[12](null),e[14](null),e[16](null),V&&V.d(),lt(B),w=!1,nr(P)}}}function $d(e,t,a){let r,n,i,s=!1,o=Ya(),f=!1,l="",{hideMessage:u=!1}=t,{width:c=250}=t,{certInfo:d}=t;d||(d={key:{name:"",value:""},cert:{name:"",value:""},ca:{name:"",value:""}});let h=Xe.cloneDeep(d),p=()=>{Xe.equalsDeep(d,h)||o("update",Xe.cloneDeep(h)),a(10,d=Xe.cloneDeep(h))};kr(async()=>{!s&&n&&(g(),s=!0)}),Tl(async()=>{h=Xe.cloneDeep(d),g()});let v=X=>{a(6,l=X),a(5,f=!0)},g=()=>{h=Xe.cloneDeep(d),n&&h.cert.name!=""&&h.cert.value!=""?a(3,n.files=x(h.cert).files,n):n&&a(3,n.value="",n),r&&h.key.name!=""&&h.key.value!=""?a(2,r.files=x(h.key).files,r):r&&a(2,r.value="",r),i&&h.ca.name!=""&&h.ca.value!=""?a(4,i.files=x(h.ca).files,i):i&&a(4,i.value="",i)},C=()=>{a(10,d.key.name="",d),a(10,d.key.value="",d),a(10,d.cert.name="",d),a(10,d.cert.value="",d),a(10,d.ca.name="",d),a(10,d.ca.value="",d),h.key.name="",h.key.value="",h.cert.name="",h.cert.value="",a(2,r.value="",r),a(3,n.value="",n)},x=X=>{let M=new DataTransfer,G=new File([y(X.value)],X.name);return M.items.add(G),M},y=X=>new Blob([X],{type:"text/plain"}),S=X=>{let M=X.target;M.value!=""&&(parseInt(M.value)<parseInt(M.min)&&(M.value=M.min),parseInt(M.value)>parseInt(M.max)&&(M.value=M.max))},T=(X,M)=>{try{const G=Ur.pki.certificateFromPem(M),Y=Ur.pki.privateKeyFromPem(X),W=so.SHA512(Date.now()+"@").toString();let ve=G.publicKey.encrypt(W,"RSA-OAEP",{md:Ur.md.sha256.create(),mgf1:{md:Ur.md.sha256.create()}});return Y.decrypt(ve,"RSA-OAEP",{md:Ur.md.sha256.create(),mgf1:{md:Ur.md.sha256.create()}})==W}catch(G){return console.error(G),!1}},A=X=>{if(X=X.trim(),!X.startsWith("-----BEGIN CERTIFICATE")||!X.endsWith("END CERTIFICATE-----"))return!1;try{if(Ur.pki.certificateFromPem(X).publicKey.n.bitLength()<2048)return!1}catch(M){return console.error(M),!1}return!0},k=X=>{if(X=X.trim(),(!X.startsWith("-----BEGIN PRIVATE KEY")||!X.endsWith("END PRIVATE KEY-----"))&&(!X.startsWith("-----BEGIN RSA PRIVATE KEY")||!X.endsWith("END RSA PRIVATE KEY-----")))return!1;try{if(Ur.pki.privateKeyFromPem(X).n.bitLength()<2048)return!1}catch(M){return console.error(M),!1}return!0},B=async(X,M,G,Y)=>{var ae;let W=(ae=M.files)==null?void 0:ae.item(0);if(!W)return;let ve=await w(W),he=G.name!=""&&G.value!=""?x(G):null;if(!Y(ve)){v(`Invalid ${X=="private"?"private key":"certificate"}`),he?a(2,r.files=he.files,r):M.value="";return}G.name=W.name,G.value=ve;let xe=I();xe=="Success"?p():xe=="Fail"&&C()},O=async(X,M)=>{var W;let G=X.target,Y=(W=G.files)==null?void 0:W.item(0);Y&&(await w(Y),M=="private"?await B(M,G,h.key,k):M=="cert"?await B(M,G,h.cert,A):M=="ca"&&await B(M,G,h.ca,A))},I=()=>h.cert.value==""||h.key.value==""?"NoCondition":T(h.key.value,h.cert.value)?"Success":(v("Invalid Key Pair"),"Fail"),w=X=>{let M=new FileReader;M.readAsText(X);let G="";return new Promise((Y,W)=>{M.onload=ve=>{var he;G=(he=ve.target)==null?void 0:he.result,Y(G)}})},P=()=>{h.ca.name="",h.ca.value="",I()=="Success"&&p(),a(4,i.value="",i),a(10,d.ca.name="",d),a(10,d.ca.value="",d)};const V=X=>O(X,"private");function $(X){ft[X?"unshift":"push"](()=>{r=X,a(2,r)})}const K=X=>O(X,"cert");function H(X){ft[X?"unshift":"push"](()=>{n=X,a(3,n)})}const q=X=>O(X,"ca");function ne(X){ft[X?"unshift":"push"](()=>{i=X,a(4,i)})}function fe(X){f=X,a(5,f)}return e.$$set=X=>{"hideMessage"in X&&a(0,u=X.hideMessage),"width"in X&&a(1,c=X.width),"certInfo"in X&&a(10,d=X.certInfo)},[u,c,r,n,i,f,l,S,O,P,d,V,$,K,H,q,ne,fe]}class Jo extends Wt{constructor(t){super(),Qt(this,t,$d,Jd,Gt,{hideMessage:0,width:1,certInfo:10},null,[-1,-1])}}const eh="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC6ElEQVR4nO3c32oTQRTH8R+VJg8Re12w7bNY+vclbJ5DbZWKRR9AESqFPoB/Lq1eKVRJ/fcGKiZ6WamsTGAR3d3ZnWHPTr4fGAhpOps9J52zmZNGAgAAAAAAAOzpSxpKeinppxvZ7R33M0Q0kPRG0sV/xmv3GETQLwl+Pgn8JUQwrBD86bgW4wnMulceCTjxmJeaUtEPjwRMKs5JTWkxAX1qSrtL0HAWasqCpCP3iszGsaTFmnPtBA5YrJpiKvhf/3Ey39zPfPXdJWaVy9BeSzXFlKOCE3pcc85BSRJ83ogln4BJwQmNG8zbc0vMiQtiNl64+6q88mdmCSpKwPe2n5zC1xRzjgtO6LDtJ6fwNcWcRVdw/z6hL5Iuy4ZBwJpi0oIruGM3Dg0FP3RNAQAAAABEQg+5RfSQW0QPuWUme8ghe77WmWvghO75WmeuhRmj52uZuQTE6vlaZW4Jst7zTb6HbL3nm3wPuQs93+R7yF3o+YZGDxkAAAAAIlmRdEfS29x3UmS39yUtxzoo9GfP556kXwVbDueSDvj0dJzgP/fY9XxGEsK67xH86bgrw7rUM14pWXaKlqMlGdS1nvF+jeBPx20Z1LWe8bsGCTiVQV3rGU8aJMDkP3LH6Bn3JG1LeiTpLHd9fubu22pwVZJcAkL3jNclfa4QjE+S1mrMn9wSFKpnfEnSXo2g7Eqam+UiHKpnvNcgMDc9jrPsLil9j5H9zhUlar1B8Kdj1eN4BzXmz/aLktSruOaXjY8ehTl73FOPuZ9ImleitgMEfzo2PY7bc9sLRcvRuXvlJxt8ucvKUAl4KH9Lrrie5r5DIrt9K+U1P+9DwARk7xMQ8ePgFyUjmwstJmBM9P29D5iAEQlotwg/IAH+tgImYIME+Jt3b6KaBj97M8dXj9W0FiABV3n1N7PbIPjXCX5zc25X0zf4Nzy3o1FitWJNyB7DshOxMG+6vZ1Rbo9m5O7bSH2DDAAAAAAAAOq836+c4pabVYFmAAAAAElFTkSuQmCC";function th(e){let t,a,r,n,i,s,o,f;return{c(){t=N("main"),a=N("div"),n=Q(),i=N("div"),s=N("img"),R(a,"class","background svelte-9r5b10"),R(a,"style",r=e[1]?"opacity: 0.0 !important;":""),Xi(s.src,o=eh)||R(s,"src",o),R(i,"class","progress"),R(i,"style",f=e[1]?"opacity: 0.0 !important;":""),L(t,"display",e[0]?"flex":"none"),R(t,"class","svelte-9r5b10")},m(l,u){le(l,t,u),m(t,a),m(t,n),m(t,i),m(i,s),e[3](s)},p(l,[u]){u&2&&r!==(r=l[1]?"opacity: 0.0 !important;":"")&&R(a,"style",r),u&2&&f!==(f=l[1]?"opacity: 0.0 !important;":"")&&R(i,"style",f),u&1&&L(t,"display",l[0]?"flex":"none")},i:ct,o:ct,d(l){l&&se(t),e[3](null)}}}function rh(e,t,a){let{show:r=!1}=t,{transition:n=!1}=t,i,s=0;kr(()=>{i&&a(2,i.onload=()=>{setInterval(o,200)},i)});let o=()=>{s+=45,i&&a(2,i.style.transform=`rotate(${s}deg)`,i)};function f(l){ft[l?"unshift":"push"](()=>{i=l,a(2,i)})}return e.$$set=l=>{"show"in l&&a(0,r=l.show),"transition"in l&&a(1,n=l.transition)},[r,n,i,f]}class $o extends Wt{constructor(t){super(),Qt(this,t,rh,th,Gt,{show:0,transition:1})}}function Rs(e){let t,a;return t=new Jo({props:{certInfo:e[1]}}),t.$on("update",e[9]),{c(){ut(t.$$.fragment)},m(r,n){ot(t,r,n),a=!0},p(r,n){const i={};n&2&&(i.certInfo=r[1]),t.$set(i)},i(r){a||(Te(t.$$.fragment,r),a=!0)},o(r){De(t.$$.fragment,r),a=!1},d(r){lt(t,r)}}}function ah(e){let t,a;return{c(){t=new Tn(!1),a=ja(),t.a=a},m(r,n){t.m(e[6],r,n),le(r,a,n)},p(r,n){n&64&&t.p(r[6])},d(r){r&&(se(a),t.d())}}}function nh(e){let t,a,r,n,i,s,o,f,l,u,c,d,h,p,v,g,C,x,y,S,T,A,k,B,O,I,w,P,V,$,K,H,q,ne,fe,X,M,G,Y,W,ve,he,xe,ae,ye,Pe,Re,Ae,Ie,me,Se,ge,Ve,Be=e[0].adminTls&&Rs(e);function gt(Ye){e[20](Ye)}let yt={};e[2]!==void 0&&(yt.show=e[2]),ye=new $o({props:yt}),ft.push(()=>Ht(ye,"show",gt));function xt(Ye){e[21](Ye)}function et(Ye){e[22](Ye)}let Bt={$$slots:{default:[ah]},$$scope:{ctx:e}};return e[3]!==void 0&&(Bt.show=e[3]),e[4]!==void 0&&(Bt.button=e[4]),Ae=new wa({props:Bt}),ft.push(()=>Ht(Ae,"show",xt)),ft.push(()=>Ht(Ae,"button",et)),Ae.$on("close",function(){Wa(e[5])&&e[5].apply(this,arguments)}),{c(){t=N("main"),a=N("h2"),a.textContent="Server settings",r=Q(),n=N("div"),i=N("div"),s=N("label"),s.textContent="Tunnel server-client authentication key",o=Q(),f=N("input"),l=Q(),u=N("div"),c=N("label"),c.textContent="Admin service port number",d=Q(),h=N("input"),p=Q(),v=N("div"),g=N("input"),C=Q(),x=N("div"),x.textContent="Secure tunneling Server/Client",y=Q(),Be&&Be.c(),S=Q(),T=N("div"),A=N("label"),A.textContent="Tunnel server port number",k=Q(),B=N("input"),O=Q(),I=N("div"),w=N("input"),P=Q(),V=N("div"),V.textContent="Enable secure Tunnel server",$=Q(),K=N("div"),H=N("label"),H.textContent="Total buffer size limit (MiB)",q=Q(),ne=N("input"),fe=Q(),X=N("div"),M=N("div"),G=N("button"),Y=de("Apply"),ve=Q(),he=N("div"),xe=N("button"),xe.textContent="Reset",ae=Q(),ut(ye.$$.fragment),Re=Q(),ut(Ae.$$.fragment),R(a,"class","title"),R(s,"for","input-key"),R(s,"class","form-label"),R(f,"type","text"),R(f,"id","input-key"),R(f,"class","form-control svelte-oaz9w8"),R(f,"aria-describedby","passwordHelpBlock"),R(i,"class","input-box"),R(c,"for","input-admin-port"),R(c,"class","form-label"),R(h,"type","number"),R(h,"min","0"),R(h,"max","65535"),R(h,"id","input-admin-port"),R(h,"class","form-control svelte-oaz9w8"),R(h,"aria-describedby","passwordHelpBlock"),R(u,"class","input-box"),L(u,"margin-bottom","5px"),R(g,"type","checkbox"),L(g,"width","14px"),R(g,"class","svelte-oaz9w8"),L(x,"display","inline-block"),L(x,"position","relative"),L(x,"top","-7px"),L(x,"font-size","10pt"),R(v,"class","check-box"),L(v,"margin-bottom",(e[0].adminTls?10:20)+"px"),R(A,"for","input-tunnel-port"),R(A,"class","form-label"),R(B,"type","number"),R(B,"min","0"),R(B,"max","65535"),R(B,"id","input-tunnel-port"),R(B,"class","form-control svelte-oaz9w8"),R(T,"class","input-box"),L(T,"margin-bottom","5px"),L(T,"margin-top","20px"),R(w,"type","checkbox"),L(w,"width","14px"),R(w,"class","svelte-oaz9w8"),L(V,"display","inline-block"),L(V,"position","relative"),L(V,"top","-7px"),L(V,"font-size","10pt"),R(I,"class","check-box"),L(I,"margin-bottom","25px"),R(H,"for","input-global-cache-limit"),R(H,"class","form-label"),R(ne,"type","number"),R(ne,"min","1"),R(ne,"max","99999"),R(ne,"class","svelte-oaz9w8"),R(K,"class","input-box"),L(G,"width","100px"),G.disabled=W=!e[7],L(M,"display","inline-block"),L(xe,"width","100px"),L(he,"display","inline-block"),L(X,"width","100%"),L(X,"margin-top","40px"),R(n,"class","round-box"),R(t,"class","svelte-oaz9w8")},m(Ye,Ze){le(Ye,t,Ze),m(t,a),m(t,r),m(t,n),m(n,i),m(i,s),m(i,o),m(i,f),qe(f,e[0].key),m(n,l),m(n,u),m(u,c),m(u,d),m(u,h),qe(h,e[0].adminPort),m(n,p),m(n,v),m(v,g),g.checked=e[0].adminTls,m(v,C),m(v,x),m(n,y),Be&&Be.m(n,null),m(n,S),m(n,T),m(T,A),m(T,k),m(T,B),qe(B,e[0].port),m(n,O),m(n,I),m(I,w),w.checked=e[0].tls,m(I,P),m(I,V),m(n,$),m(n,K),m(K,H),m(K,q),m(K,ne),qe(ne,e[0].globalMemCacheLimit),m(n,fe),m(n,X),m(X,M),m(M,G),m(G,Y),m(X,ve),m(X,he),m(he,xe),m(t,ae),ot(ye,t,null),m(t,Re),ot(Ae,t,null),Se=!0,ge||(Ve=[_e(f,"input",e[14]),_e(h,"keyup",e[8]),_e(h,"input",e[15]),_e(g,"change",e[16]),_e(B,"keyup",e[8]),_e(B,"input",e[17]),_e(w,"change",e[18]),_e(ne,"keyup",e[8]),_e(ne,"input",e[19]),_e(G,"click",e[10]),_e(xe,"click",e[11])],ge=!0)},p(Ye,[Ze]){e=Ye,Ze&1&&f.value!==e[0].key&&qe(f,e[0].key),Ze&1&&Mt(h.value)!==e[0].adminPort&&qe(h,e[0].adminPort),Ze&1&&(g.checked=e[0].adminTls),(!Se||Ze&1)&&L(v,"margin-bottom",(e[0].adminTls?10:20)+"px"),e[0].adminTls?Be?(Be.p(e,Ze),Ze&1&&Te(Be,1)):(Be=Rs(e),Be.c(),Te(Be,1),Be.m(n,S)):Be&&(zr(),De(Be,1,1,()=>{Be=null}),qr()),Ze&1&&Mt(B.value)!==e[0].port&&qe(B,e[0].port),Ze&1&&(w.checked=e[0].tls),Ze&1&&Mt(ne.value)!==e[0].globalMemCacheLimit&&qe(ne,e[0].globalMemCacheLimit),(!Se||Ze&128&&W!==(W=!e[7]))&&(G.disabled=W);const j={};!Pe&&Ze&4&&(Pe=!0,j.show=e[2],Kt(()=>Pe=!1)),ye.$set(j);const J={};Ze&536870976&&(J.$$scope={dirty:Ze,ctx:e}),!Ie&&Ze&8&&(Ie=!0,J.show=e[3],Kt(()=>Ie=!1)),!me&&Ze&16&&(me=!0,J.button=e[4],Kt(()=>me=!1)),Ae.$set(J)},i(Ye){Se||(Te(Be),Te(ye.$$.fragment,Ye),Te(Ae.$$.fragment,Ye),Se=!0)},o(Ye){De(Be),De(ye.$$.fragment,Ye),De(Ae.$$.fragment,Ye),Se=!1},d(Ye){Ye&&se(t),Be&&Be.d(),lt(ye),lt(Ae),ge=!1,nr(Ve)}}}function ih(e,t,a){let r=Vt.instance.getCachedServerOption(),n=Vt.instance.getCachedServerOption(),i=null,s=null,o=null,f=!1,l=!1,u=!1,c="OK",d=()=>{},h="",p=!1;kr(async()=>{if(!f)try{a(2,l=!0),a(0,r=await Vt.instance.getServerOption()),await Vt.instance.getServerOptionHash(),a(12,n=Xe.cloneDeep(r)),a(1,i=await Or.instance.loadAdminCert()),a(13,o=Xe.cloneDeep(i)),s=Xe.cloneDeep(i),f=!0,a(2,l=!1)}catch(H){if(console.error(H),H instanceof at){A();return}x("Unable to connect to the server.","OK",()=>{location.href="/"})}});let v=H=>{let q=H.target;q.value!=""&&(parseInt(q.value)<parseInt(q.min)&&(q.value=q.min),parseInt(q.value)>parseInt(q.max)&&(q.value=q.max))},g=H=>{C(H.detail)},C=async H=>{a(2,l=!0);try{let q=await Or.instance.updateAdminCert(H);q.success?(a(13,o=i),a(1,i=H)):x(q.message),a(2,l=!1)}catch(q){console.error(q),q instanceof at?(a(2,l=!1),A()):x("Unable to connect to the server.","Retry",async()=>{await C(H)})}},x=(H,q,ne)=>{q==null?q="OK":a(4,c=q),ne==null?a(5,d=()=>{}):a(5,d=ne),a(6,h=H),a(3,u=!0)},y=async()=>{try{a(2,l=!0);let H=await Vt.instance.updateServerOption(r);a(2,l=!1),H.success?await S():x(H.message)}catch(H){console.error(H),a(2,l=!1),H instanceof at?A():x("Unable to connect to the server.","Retry",async()=>{await y()})}},S=async()=>{a(2,l=!0);let H=!1;try{H=await Vt.instance.checkChangeServerOption(n,r)}catch{x(`Error: Server status could not be determined.${r.adminTls?"(It could be a TSL certificate error.)":""}`,"OK",()=>{console.log((r.adminTls?"https://":"http://")+location.hostname+":"+r.adminPort+"/"),location.href=(r.adminTls?"https://":"http://")+location.hostname+":"+r.adminPort+"/"});return}a(2,l=!1),H?x("Server settings have been changed.<br/>The server has been restarted.","OK",()=>{a(12,n=Xe.cloneDeep(r)),a(13,o=Xe.cloneDeep(i)),s=Xe.cloneDeep(i),console.log((r.adminTls?"https://":"http://")+location.hostname+":"+r.adminPort+"/"),location.href=(r.adminTls?"https://":"http://")+location.hostname+":"+r.adminPort+"/"}):x("New server options cannot be applied.","OK",()=>{a(0,r=Xe.cloneDeep(n)),a(1,i=Xe.cloneDeep(s)),a(13,o=Xe.cloneDeep(i)),location.href="/"})},T=()=>{let H=!Xe.equalsDeep(i,s);a(0,r=Xe.cloneDeep(n)),a(1,i=Xe.cloneDeep(s)),H&&C(i)},A=()=>{x("Session is expired.<br/>Please login again.","OK",()=>{location.href="/"})};function k(){r.key=this.value,a(0,r)}function B(){r.adminPort=Mt(this.value),a(0,r)}function O(){r.adminTls=this.checked,a(0,r)}function I(){r.port=Mt(this.value),a(0,r)}function w(){r.tls=this.checked,a(0,r)}function P(){r.globalMemCacheLimit=Mt(this.value),a(0,r)}function V(H){l=H,a(2,l)}function $(H){u=H,a(3,u)}function K(H){c=H,a(4,c)}return e.$$.update=()=>{e.$$.dirty&12291&&a(7,p=!Xe.equalsDeep(r,n)||i==null||o==null||!Xe.equalsDeep(i,o))},[r,i,l,u,c,d,h,p,v,g,y,T,n,o,k,B,O,I,w,P,V,$,K]}class sh extends Wt{constructor(t){super(),Qt(this,t,ih,nh,Gt,{})}}function Ls(e,t,a){const r=e.slice();return r[10]=t[a],r[11]=t,r[12]=a,r}function oh(e){let t,a,r;function n(){return e[7](e[12])}return{c(){t=N("button"),t.textContent="-",L(t,"width","28px"),L(t,"font-weight","bold")},m(i,s){le(i,t,s),a||(r=_e(t,"click",n),a=!0)},p(i,s){e=i},d(i){i&&se(t),a=!1,r()}}}function lh(e){let t,a,r;return{c(){t=N("button"),t.textContent="+",L(t,"width","28px")},m(n,i){le(n,t,i),a||(r=_e(t,"click",e[2]),a=!0)},p:ct,d(n){n&&se(t),a=!1,r()}}}function Ds(e){let t,a,r,n,i,s,o,f,l,u,c,d,h,p,v;function g(){e[5].call(a,e[11],e[12])}function C(){e[6].call(s,e[11],e[12])}function x(A,k){return A[12]===A[0].length-1?lh:oh}let y=x(e),S=y(e);function T(){e[8].call(u,e[11],e[12])}return{c(){t=N("div"),a=N("input"),r=Q(),n=N("div"),n.textContent=":",i=Q(),s=N("input"),o=Q(),S.c(),f=Q(),l=N("div"),u=N("input"),c=Q(),d=N("div"),d.textContent="Replace header",h=Q(),R(a,"type","text"),L(a,"width",e[1]/2-40+"px"),L(n,"width","10px"),L(n,"display","inline-block"),L(n,"text-align","center"),L(n,"font-weight","bold"),L(n,"color","#333"),R(s,"type","text"),L(s,"width",e[1]/2-40+"px"),R(u,"type","checkbox"),L(u,"width","14px"),L(d,"display","inline-block"),L(d,"position","relative"),L(d,"top","-7px"),L(d,"font-size","10pt"),L(l,"position","relative"),L(l,"height","15px"),L(l,"margin-top","5px"),L(l,"margin-bottom","5px"),L(t,"border-radius","5px"),L(t,"padding","10px"),L(t,"background-color",e[4]),L(t,"margin-bottom","6px")},m(A,k){le(A,t,k),m(t,a),qe(a,e[10].name),m(t,r),m(t,n),m(t,i),m(t,s),qe(s,e[10].value),m(t,o),S.m(t,null),m(t,f),m(t,l),m(l,u),u.checked=e[10].replace,m(l,c),m(l,d),m(t,h),p||(v=[_e(a,"input",g),_e(s,"input",C),_e(u,"change",T)],p=!0)},p(A,k){e=A,k&2&&L(a,"width",e[1]/2-40+"px"),k&1&&a.value!==e[10].name&&qe(a,e[10].name),k&2&&L(s,"width",e[1]/2-40+"px"),k&1&&s.value!==e[10].value&&qe(s,e[10].value),y===(y=x(e))&&S?S.p(e,k):(S.d(1),S=y(e),S&&(S.c(),S.m(t,f))),k&1&&(u.checked=e[10].replace)},d(A){A&&se(t),S.d(),p=!1,nr(v)}}}function fh(e){let t,a,r,n,i=ar(e[0]),s=[];for(let o=0;o<i.length;o+=1)s[o]=Ds(Ls(e,i,o));return{c(){t=N("div"),a=N("div"),r=Q(),n=N("div");for(let o=0;o<s.length;o+=1)s[o].c();R(a,"class","horizontal-line svelte-1idq8y4"),L(a,"margin-bottom","10px"),L(a,"max-width",e[1]+"px")},m(o,f){le(o,t,f),m(t,a),m(t,r),m(t,n);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(n,null)},p(o,[f]){if(f&2&&L(a,"max-width",o[1]+"px"),f&31){i=ar(o[0]);let l;for(l=0;l<i.length;l+=1){const u=Ls(o,i,l);s[l]?s[l].p(u,f):(s[l]=Ds(u),s[l].c(),s[l].m(n,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=i.length}},i:ct,o:ct,d(o){o&&se(t),_a(s,o)}}}function uh(e,t,a){let{maxWidth:r=280}=t,{options:n=[{name:"",value:"",replace:!1}]}=t,i=h=>{a(0,n=[...n,{name:"",value:"",replace:!1}])},s=h=>{a(0,n=n.filter((p,v)=>v!==h))},f=(()=>{const h=Math.floor(Math.random()*360),p=50+Math.floor(Math.random()*50),v=90+Math.floor(Math.random()*6);return`hsl(${h}, ${p}%, ${v}%)`})();function l(h,p){h[p].name=this.value,a(0,n)}function u(h,p){h[p].value=this.value,a(0,n)}const c=h=>s(h);function d(h,p){h[p].replace=this.checked,a(0,n)}return e.$$set=h=>{"maxWidth"in h&&a(1,r=h.maxWidth),"options"in h&&a(0,n=h.options)},e.$$.update=()=>{e.$$.dirty&1&&n.length==0&&a(0,n=[{name:"",value:"",replace:!1}])},[n,r,i,s,f,l,u,c,d]}class Ps extends Wt{constructor(t){super(),Qt(this,t,uh,fh,Gt,{maxWidth:1,options:0})}}function Us(e,t,a){const r=e.slice();return r[9]=t[a],r[10]=t,r[11]=a,r}function ch(e){let t,a,r;function n(){return e[7](e[11])}return{c(){t=N("button"),t.textContent="Remove",L(t,"position","absolute"),L(t,"right","0px"),L(t,"top","0")},m(i,s){le(i,t,s),a||(r=_e(t,"click",n),a=!0)},p(i,s){e=i},d(i){i&&se(t),a=!1,r()}}}function dh(e){let t,a,r;return{c(){t=N("button"),t.textContent="Add",L(t,"position","absolute"),L(t,"right","0px"),L(t,"top","0")},m(n,i){le(n,t,i),a||(r=_e(t,"click",e[2]),a=!0)},p:ct,d(n){n&&se(t),a=!1,r()}}}function Os(e){let t,a,r,n,i,s,o,f,l,u,c,d;function h(){e[5].call(n,e[10],e[11])}function p(){e[6].call(f,e[10],e[11])}function v(x,y){return x[11]===x[0].length-1?dh:ch}let g=v(e),C=g(e);return{c(){t=N("div"),a=N("div"),a.textContent="From",r=Q(),n=N("input"),i=Q(),s=N("div"),s.textContent="To",o=Q(),f=N("input"),l=Q(),u=N("div"),C.c(),R(a,"class","form-label"),R(n,"type","text"),L(n,"width",e[1]-25+"px"),R(s,"class","form-label"),R(f,"type","text"),L(f,"width",e[1]-25+"px"),L(u,"margin-top","10px"),L(u,"margin-bottom","38px"),L(u,"position","relative "),L(t,"background",e[4]),L(t,"padding","10px"),L(t,"border-radius","5px"),L(t,"margin-bottom","10px")},m(x,y){le(x,t,y),m(t,a),m(t,r),m(t,n),qe(n,e[9].from),m(t,i),m(t,s),m(t,o),m(t,f),qe(f,e[9].to),m(t,l),m(t,u),C.m(u,null),c||(d=[_e(n,"input",h),_e(f,"input",p)],c=!0)},p(x,y){e=x,y&2&&L(n,"width",e[1]-25+"px"),y&1&&n.value!==e[9].from&&qe(n,e[9].from),y&2&&L(f,"width",e[1]-25+"px"),y&1&&f.value!==e[9].to&&qe(f,e[9].to),g===(g=v(e))&&C?C.p(e,y):(C.d(1),C=g(e),C&&(C.c(),C.m(u,null)))},d(x){x&&se(t),C.d(),c=!1,nr(d)}}}function hh(e){let t,a,r,n,i,s,o=ar(e[0]),f=[];for(let l=0;l<o.length;l+=1)f[l]=Os(Us(e,o,l));return{c(){t=N("div"),a=N("div"),r=Q(),n=N("div");for(let l=0;l<f.length;l+=1)f[l].c();i=Q(),s=N("div"),s.textContent="You can use a JavaScript-formatted regular expression in the 'From' input box.",R(a,"class","horizontal-line svelte-149ufur"),L(a,"margin-bottom","10px"),L(a,"max-width",e[1]+"px"),L(s,"font-size","10pt"),L(s,"line-height","11pt"),L(s,"color","#555 "),L(n,"margin-bottom","10px"),L(n,"width",e[1]+"px")},m(l,u){le(l,t,u),m(t,a),m(t,r),m(t,n);for(let c=0;c<f.length;c+=1)f[c]&&f[c].m(n,null);m(n,i),m(n,s)},p(l,[u]){if(u&2&&L(a,"max-width",l[1]+"px"),u&31){o=ar(l[0]);let c;for(c=0;c<o.length;c+=1){const d=Us(l,o,c);f[c]?f[c].p(d,u):(f[c]=Os(d),f[c].c(),f[c].m(n,i))}for(;c<f.length;c+=1)f[c].d(1);f.length=o.length}u&2&&L(n,"width",l[1]+"px")},i:ct,o:ct,d(l){l&&se(t),_a(f,l)}}}function ph(e,t,a){let{maxWidth:r=280}=t,{options:n=[{from:"",to:""}]}=t,i=d=>{a(0,n=[...n,{from:"",to:""}])},s=d=>{a(0,n=n.filter((h,p)=>p!==d))},f=(()=>{const d=Math.floor(Math.random()*360),h=50+Math.floor(Math.random()*50),p=90+Math.floor(Math.random()*6);return`hsl(${d}, ${h}%, ${p}%)`})();function l(d,h){d[h].from=this.value,a(0,n)}function u(d,h){d[h].to=this.value,a(0,n)}const c=d=>s(d);return e.$$set=d=>{"maxWidth"in d&&a(1,r=d.maxWidth),"options"in d&&a(0,n=d.options)},e.$$.update=()=>{e.$$.dirty&1&&n.length==0&&a(0,n=[{from:"",to:""}])},[n,r,i,s,f,l,u,c]}class vh extends Wt{constructor(t){super(),Qt(this,t,ph,hh,Gt,{maxWidth:1,options:0})}}function gh(e){let t;return{c(){t=N("div"),R(t,"class","center-box svelte-8lzpzo"),L(t,"border-radius","10px"),L(t,"width","10px"),L(t,"height","10px"),L(t,"top","calc(50% - 5px)"),L(t,"left","calc(50% - 5px)"),L(t,"border","1px solid #444")},m(a,r){le(a,t,r)},d(a){a&&se(t)}}}function yh(e){let t;return{c(){t=N("div"),R(t,"class","center-box svelte-8lzpzo"),L(t,"font-weight","bold"),L(t,"width","1px"),L(t,"height","12px"),L(t,"border","1px solid #20c997"),L(t,"top","calc(50% - 6px)"),L(t,"left","calc(50% - 1px)")},m(a,r){le(a,t,r)},d(a){a&&se(t)}}}function xh(e){let t,a,r,n,i,s,o,f,l,u;function c(p,v){return p[0]?yh:gh}let d=c(e),h=d(e);return{c(){t=N("div"),a=N("div"),n=Q(),i=N("div"),h.c(),o=Q(),f=N("button"),R(a,"class",r="switch-background "+(e[0]?"switch-background-on":"switch-background-off")+" svelte-8lzpzo"),R(i,"class",s="switch-button "+(e[0]?"switch-button-on":"switch-button-off")+" svelte-8lzpzo"),R(f,"class","translate-button svelte-8lzpzo"),R(t,"class","switch-box  svelte-8lzpzo"),R(t,"style",e[1])},m(p,v){le(p,t,v),m(t,a),m(t,n),m(t,i),h.m(i,null),m(t,o),m(t,f),l||(u=_e(f,"click",e[2]),l=!0)},p(p,[v]){v&1&&r!==(r="switch-background "+(p[0]?"switch-background-on":"switch-background-off")+" svelte-8lzpzo")&&R(a,"class",r),d!==(d=c(p))&&(h.d(1),h=d(p),h&&(h.c(),h.m(i,null))),v&1&&s!==(s="switch-button "+(p[0]?"switch-button-on":"switch-button-off")+" svelte-8lzpzo")&&R(i,"class",s),v&2&&R(t,"style",p[1])},i:ct,o:ct,d(p){p&&se(t),h.d(),l=!1,u()}}}function mh(e,t,a){let{on:r=!1}=t,{style:n=""}=t,i=r,s=Ya(),o=()=>{a(0,r=!r)};return e.$$set=f=>{"on"in f&&a(0,r=f.on),"style"in f&&a(1,n=f.style)},e.$$.update=()=>{e.$$.dirty&9&&r!=i&&(console.log(`change: new: ${r}, old: ${i}`),s("change",{on:r}),a(3,i=r))},[r,n,o,i]}class Ch extends Wt{constructor(t){super(),Qt(this,t,mh,xh,Gt,{on:0,style:1})}}const Eh="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZElEQVR4nO2YWYiPURTAfzO2MfahsQ0llLJEFA+WKQ+ilBJJ4ckDikxMeZhQHpAH82Br4kEoKdsUhuxLmWKsM3kZiRCyZBvbjM50/vU57vf/f8vUvNxffc10v3PP+d9z7j3n3A88Ho/H4/F4PO3JMGAlcBp4DLwFfgCNwCVgDdA/hf5+QBlwDngOfAc+AQ3AeWAdMCrNAiYAx4FmoCXH0wRUAJ1j6O8EbAa+RNDfAlwAJsdZQEdgW8QF2Oe2ejgXfYFbCfS3ALuiOKwncC2hgcwj2684i43ewMMs8z8DX3PYuAkUhRkoAC6HTJTFrQbGqsfFIyN0b790yF8P8Vq+ngUrXw8sAfoEZHsAs4A9em7snCthkalyCD8BSnNEsSjkx1U6ZFc45KoibJXBQLVj7l4rOM1xJuRw9SIaXTTDBOf/AaYHZAYCH4zMQSAvoo18dY61MSkoVGsE7mto4yCReeqIaMbbOx3bqWtMG/laBoJ65Di0Ms68kMhMJBkzHJFdq++mmnGRTcJQc2aatdax3Rg4QTr2GX3vAxnmlI6dSWmjytgol8GLZnBxSiOSej8anbKthNHA77iFzcFso18cxGszKKFLS7nR+RMYqe8WtYH+YqNf6tJ/5yNOm5EtizUa3dLutBV52hZldEubw7fAgPzfVix05P1gOk7rqGYTgNYuM2hM+qC03irQvzeM7toYdSMbw43eZ2gGCQ7OJB3ztBNGD7VNx8tIz3KjU6o+m8yg9DZJEW/X6Z6VtkI4bPS/y9FURuGq0VmRSYnBQfkRJSRjvmk/0Cz4zeFBqdJJmONoU1oLonDHvDyZwFB33auuDqHMcfA3JljEQOCF0VMTFJjpMFQZczFHzPw3gcSRr629tSHX2KgMAu6a+b/0avEPxxyGzgJDchjoAOx2zF1q5ETPK4fcgQhd9ly9z9u5W8O2Rp1DWD407Fdl9uKzALgX4gBXmp0SckmS6O3QOlOilzdpZlfpbdDKZ9oScaITyTQPQiZmnsxXjrD3DWbBllJHLxb3qQEKc0SRbsChhAYkOgNyGQDG610lrv4/wJZskQjzXNQPEU26NaSix2kzNurHhig2qnW7JWYMsF7v5fV6v2jSNChXgA2aUZJSqB3x0YB+KZqPtOso0w8dHo/H4/F4PB7ah7/2x/s1CzUbPgAAAABJRU5ErkJggg==",ra=class ra{static incrementAndGet(){return++ra._counter}static getAndIncrement(){return ra._counter++}static get counter(){return ra._counter}static set counter(t){ra._counter=t}};Lt(ra,"_counter",0);let Yi=ra;function _h(e){let t,a,r,n;return{c(){t=N("img"),r=Q(),n=N("div"),Xi(t.src,a=Eh)||R(t,"src",a),L(t,"width","20px"),L(t,"height","20px"),L(t,"margin-right","0px"),L(t,"vertical-align","middle"),L(n,"width","20px"),L(n,"height","1px"),L(n,"background","1px"),L(n,"background","#333"),L(n,"position","absolute"),L(n,"left","10px"),L(n,"margin-top","-3px")},m(i,s){le(i,t,s),le(i,r,s),le(i,n,s)},p:ct,d(i){i&&(se(t),se(r),se(n))}}}function bh(e){let t,a=e[8](e[1]>0?e[4]/pr:0)+"",r;return{c(){t=new Tn(!1),r=ja(),t.a=r},m(n,i){t.m(a,n,i),le(n,r,i)},p(n,i){i&18&&a!==(a=n[8](n[1]>0?n[4]/pr:0)+"")&&t.p(a)},d(n){n&&(se(r),t.d())}}}function Sh(e){let t,a,r,n,i,s,o,f,l,u,c,d,h,p,v;return{c(){t=N("div"),t.textContent="Tunneling activity restriction time",a=Q(),r=N("div"),n=N("div"),i=N("input"),o=de(`d 
            `),f=N("input"),u=de(`h 
            `),c=N("input"),h=de("m "),L(t,"display","block"),L(t,"font-size","12pt"),L(t,"margin-bottom","15px"),L(t,"font-weight","bold"),R(i,"id","input-timeout-day-"+e[7]),R(i,"type","number"),R(i,"min","0"),R(i,"max","99999"),L(i,"width","40px"),L(i,"text-align","right"),i.value=s=Math.floor(e[2]/60/60/24),R(f,"id","input-timeout-hour-"+e[7]),R(f,"type","number"),R(f,"min","0"),R(f,"max","23"),L(f,"width","40px"),L(f,"text-align","right"),f.value=l=Math.floor(e[2]/60/60)%24,R(c,"id","input-timeout-min-"+e[7]),R(c,"type","number"),R(c,"min","0"),R(c,"max","59"),L(c,"width","40px"),L(c,"text-align","right"),c.value=d=Math.floor(e[2]/60)%60,L(n,"display","block"),L(n,"font-size","12pt"),L(r,"width","100%"),L(r,"text-align","center")},m(g,C){le(g,t,C),le(g,a,C),le(g,r,C),m(r,n),m(n,i),m(n,o),m(n,f),m(n,u),m(n,c),m(n,h),p||(v=[_e(i,"keyup",e[10]),_e(f,"keyup",e[10]),_e(c,"keyup",e[10])],p=!0)},p(g,C){C&4&&s!==(s=Math.floor(g[2]/60/60/24))&&i.value!==s&&(i.value=s),C&4&&l!==(l=Math.floor(g[2]/60/60)%24)&&f.value!==l&&(f.value=l),C&4&&d!==(d=Math.floor(g[2]/60)%60)&&c.value!==d&&(c.value=d)},d(g){g&&(se(t),se(a),se(r)),p=!1,nr(v)}}}function Th(e){let t,a,r,n,i,s,o,f,l,u,c,d,h,p,v,g,C,x,y,S,T,A,k,B,O;function I(K,H){if(K[1]>=0&&K[2]>0)return bh;if(K[2]===0)return _h}let w=I(e),P=w&&w(e);function V(K){e[15](K)}let $={$$slots:{default:[Sh]},$$scope:{ctx:e}};return e[6]!==void 0&&($.show=e[6]),y=new wa({props:$}),ft.push(()=>Ht(y,"show",V)),y.$on("close",e[11]),{c(){t=N("div"),a=N("div"),P&&P.c(),n=Q(),i=N("div"),s=N("div"),o=Q(),f=N("div"),l=Q(),u=N("div"),c=Q(),d=N("div"),h=Q(),p=N("div"),v=Q(),g=N("div"),x=Q(),ut(y.$$.fragment),T=Q(),A=N("div"),R(a,"class","time-text svelte-pnvd21"),R(a,"style",r=e[2]<=0?"min-width: 30px":""),R(s,"class","T-L svelte-pnvd21"),R(f,"class","T-I svelte-pnvd21"),R(u,"class","circle svelte-pnvd21"),R(d,"class","end-point svelte-pnvd21"),R(p,"class","axis svelte-pnvd21"),R(g,"class",C="second-hand "+(e[3]?"second-hand-animation":"")+" svelte-pnvd21"),R(i,"class","clock svelte-pnvd21"),L(i,"display",e[1]<0?"none":""),R(A,"role","button"),L(A,"cursor","pointer"),L(A,"position","absolute"),L(A,"top","-5px"),L(A,"left","0"),L(A,"width","100%"),L(A,"height","100%"),R(t,"class","main svelte-pnvd21"),R(t,"style",e[0])},m(K,H){le(K,t,H),m(t,a),P&&P.m(a,null),m(t,n),m(t,i),m(i,s),m(i,o),m(i,f),m(i,l),m(i,u),m(i,c),m(i,d),m(i,h),m(i,p),m(i,v),m(i,g),e[14](g),m(t,x),ot(y,t,null),m(t,T),m(t,A),k=!0,B||(O=_e(A,"click",e[9]),B=!0)},p(K,[H]){w===(w=I(K))&&P?P.p(K,H):(P&&P.d(1),P=w&&w(K),P&&(P.c(),P.m(a,null))),(!k||H&4&&r!==(r=K[2]<=0?"min-width: 30px":""))&&R(a,"style",r),(!k||H&8&&C!==(C="second-hand "+(K[3]?"second-hand-animation":"")+" svelte-pnvd21"))&&R(g,"class",C),(!k||H&2)&&L(i,"display",K[1]<0?"none":"");const q={};H&1048580&&(q.$$scope={dirty:H,ctx:K}),!S&&H&64&&(S=!0,q.show=K[6],Kt(()=>S=!1)),y.$set(q),(!k||H&1)&&R(t,"style",K[0])},i(K){k||(Te(y.$$.fragment,K),k=!0)},o(K){De(y.$$.fragment,K),k=!1},d(K){K&&se(t),P&&P.d(),e[14](null),lt(y),B=!1,O()}}}const pr=20,Bi=100,Vs=95,Ah=440;function Bh(e,t,a){let{style:r=""}=t,n=0,i=-1,s=!1,o=n*pr,f=n*pr,l,u=!1,c=Yi.incrementAndGet(),d=Ya();const h=k=>{if(n!=null&&(a(1,n=k),a(2,i=k),i<=0)){a(3,s=!0);return}a(3,s=!1),o=i*pr,a(4,f=i*pr)};let p=(k,B,O,I,w)=>(k-B)*(w-I)/(O-B)+I,v=()=>{if(l){let k=Math.floor(p(o-f,0,o,Vs,Ah));a(5,l.style.rotate=`${k}deg`,l),a(4,f--,f),f<=0&&i<=0?(o=Bi,a(4,f=o)):f<=0&&a(4,f=0)}};const g=(k,B)=>{if(B!=null)if(a(2,i=B),B<=0){a(3,s=!0);return}else B>0&&(a(3,s=!1),o=i*pr);i<=0||(a(1,n=k),a(4,f=n*pr),v())};kr(async()=>{l&&a(5,l.style.rotate=`${Vs}deg`,l)});let C=k=>{let B='<span style="font-size: 12px">';if(k<=0)return`0${B}m</span> 0${B}s</span>`;let O=Math.floor(k/60)%60,I=Math.floor(k/60/60)%24,w=Math.floor(k%60),P=Math.floor(k/60/60/24);return P>0?`${P}${B}d</span> ${I}${B}h</span> ${B}${O}m</span>`:I>0?`${I}${B}h</span> ${O}${B}m</span> ${B}${w}s</span>`:`${O}${B}m</span> ${w}${B}s</span>`},x=()=>{a(6,u=!0)},y=k=>{let B=k.target;B.value!=""&&(parseInt(B.value)<parseInt(B.min)&&(B.value=B.min),parseInt(B.value)>parseInt(B.max)&&(B.value=B.max))},S=()=>{let k=parseInt(document.getElementById(`input-timeout-day-${c}`).value),B=parseInt(document.getElementById(`input-timeout-hour-${c}`).value),O=parseInt(document.getElementById(`input-timeout-min-${c}`).value);k=isNaN(k)?0:k,B=isNaN(B)?0:B,O=isNaN(O)?0:O;let I=i;a(2,i=k*24*60*60+B*60*60+O*60),i!=0?(o=i*pr,a(4,f=i*pr)):(o=Bi,a(4,f=Bi)),I!=i&&d("change",{time:i})};function T(k){ft[k?"unshift":"push"](()=>{l=k,a(5,l)})}function A(k){u=k,a(6,u)}return e.$$set=k=>{"style"in k&&a(0,r=k.style)},[r,n,i,s,f,l,u,c,C,x,y,S,h,g,T,A]}class Ih extends Wt{constructor(t){super(),Qt(this,t,Bh,Th,Gt,{style:0,reset:12,update:13})}get style(){return this.$$.ctx[0]}set style(t){this.$$set({style:t}),vr()}get reset(){return this.$$.ctx[12]}get update(){return this.$$.ctx[13]}}function Fs(e,t,a){const r=e.slice();return r[60]=t[a],r[61]=t,r[62]=a,r}function wh(e){let t;return{c(){t=N("span"),t.textContent="Offline",L(t,"color","gray")},m(a,r){le(a,t,r)},p:ct,d(a){a&&se(t)}}}function kh(e){let t,a,r,n=e[14](e[1][e[60].forwardPort].uptime)+"",i,s,o=e[1][e[60].forwardPort].sessions+"",f,l,u=e[15](e[1][e[60].forwardPort].rx)+"",c,d,h=e[15](e[1][e[60].forwardPort].tx)+"",p,v;function g(y,S){return y[1][y[60].forwardPort].online?Rh:Nh}let C=g(e),x=C(e);return{c(){x.c(),t=Q(),a=N("span"),r=de("Uptime: "),i=de(n),s=de(`,
                                 
                                Sessions: `),f=de(o),l=de(`,
                                 
                                RX: `),c=de(u),d=de(`,
                                 
                                TX: `),p=de(h),v=de(`
                                 `),R(a,"class","sub-status svelte-9x5gaz")},m(y,S){x.m(y,S),le(y,t,S),le(y,a,S),m(a,r),m(a,i),m(a,s),m(a,f),m(a,l),m(a,c),m(a,d),m(a,p),m(a,v)},p(y,S){C!==(C=g(y))&&(x.d(1),x=C(y),x&&(x.c(),x.m(t.parentNode,t))),S[0]&3&&n!==(n=y[14](y[1][y[60].forwardPort].uptime)+"")&&Ke(i,n),S[0]&3&&o!==(o=y[1][y[60].forwardPort].sessions+"")&&Ke(f,o),S[0]&3&&u!==(u=y[15](y[1][y[60].forwardPort].rx)+"")&&Ke(c,u),S[0]&3&&h!==(h=y[15](y[1][y[60].forwardPort].tx)+"")&&Ke(p,h)},d(y){y&&(se(t),se(a)),x.d(y)}}}function Nh(e){let t;return{c(){t=N("span"),t.textContent="Error",L(t,"color","darkred")},m(a,r){le(a,t,r)},d(a){a&&se(t)}}}function Rh(e){let t;return{c(){t=N("span"),t.textContent="Online",L(t,"color","darkgreen")},m(a,r){le(a,t,r)},d(a){a&&se(t)}}}function Ms(e){var u;let t,a,r,n,i,s,o;function f(...c){return e[18](e[60],...c)}i=new Ch({props:{on:(u=e[1][e[60].forwardPort])==null?void 0:u.active,style:"position: absolute; margin-left: 5px; margin-top: 3px"}}),i.$on("change",f);let l=e[1][e[60].forwardPort]&&e[1][e[60].forwardPort].active&&Ks(e);return{c(){t=N("div"),a=N("span"),a.textContent="Activation:",r=Q(),n=N("div"),ut(i.$$.fragment),s=Q(),l&&l.c(),R(a,"class","status-label svelte-9x5gaz"),L(n,"display","inline"),L(n,"position","relative"),L(t,"display","block"),L(t,"position","relative"),L(t,"height","34px"),L(t,"min-width","370px")},m(c,d){le(c,t,d),m(t,a),m(t,r),m(t,n),ot(i,n,null),m(t,s),l&&l.m(t,null),o=!0},p(c,d){var p;e=c;const h={};d[0]&3&&(h.on=(p=e[1][e[60].forwardPort])==null?void 0:p.active),i.$set(h),e[1][e[60].forwardPort]&&e[1][e[60].forwardPort].active?l?(l.p(e,d),d[0]&3&&Te(l,1)):(l=Ks(e),l.c(),Te(l,1),l.m(t,null)):l&&(zr(),De(l,1,1,()=>{l=null}),qr())},i(c){o||(Te(i.$$.fragment,c),Te(l),o=!0)},o(c){De(i.$$.fragment,c),De(l),o=!1},d(c){c&&se(t),lt(i),l&&l.d()}}}function Ks(e){let t,a,r,n,i=e[60],s;const o=()=>e[19](n,i),f=()=>e[19](null,i);function l(...c){return e[20](e[60],...c)}let u={style:"position: absolute; margin-left: 5px; margin-top: 3px"};return n=new Ih({props:u}),o(),n.$on("change",l),{c(){t=N("div"),t.textContent="Timeout:",a=Q(),r=N("div"),ut(n.$$.fragment),R(t,"class","status-label svelte-9x5gaz"),L(t,"display","inline-block"),L(t,"margin-left","65px"),L(r,"display","inline")},m(c,d){le(c,t,d),le(c,a,d),le(c,r,d),ot(n,r,null),s=!0},p(c,d){e=c,i!==e[60]&&(f(),i=e[60],o());const h={};n.$set(h)},i(c){s||(Te(n.$$.fragment,c),s=!0)},o(c){De(n.$$.fragment,c),s=!1},d(c){c&&(se(t),se(a),se(r)),f(),lt(n)}}}function Hs(e){let t,a;function r(...n){return e[24](e[60],e[61],e[62],...n)}return t=new Jo({props:{certInfo:e[60].certInfo,hideMessage:!0}}),t.$on("update",r),{c(){ut(t.$$.fragment)},m(n,i){ot(t,n,i),a=!0},p(n,i){e=n;const s={};i[0]&1&&(s.certInfo=e[60].certInfo),t.$set(s)},i(n){a||(Te(t.$$.fragment,n),a=!0)},o(n){De(t.$$.fragment,n),a=!1},d(n){lt(t,n)}}}function zs(e){let t,a,r,n,i,s,o,f,l,u,c,d,h,p,v,g,C,x,y,S,T,A,k,B,O,I,w,P,V,$,K,H,q,ne,fe,X,M;function G(ae){e[32](ae,e[60])}let Y={};e[60].httpOption.customRequestHeaders!==void 0&&(Y.options=e[60].httpOption.customRequestHeaders),k=new Ps({props:Y}),ft.push(()=>Ht(k,"options",G));function W(ae){e[33](ae,e[60])}let ve={};e[60].httpOption.customResponseHeaders!==void 0&&(ve.options=e[60].httpOption.customResponseHeaders),V=new Ps({props:ve}),ft.push(()=>Ht(V,"options",W));function he(ae){e[34](ae,e[60])}let xe={};return e[60].httpOption.bodyRewriteRules!==void 0&&(xe.options=e[60].httpOption.bodyRewriteRules),fe=new vh({props:xe}),ft.push(()=>Ht(fe,"options",he)),{c(){t=N("h3"),t.textContent="HTTP Options",a=Q(),r=N("div"),n=N("div"),i=Q(),s=N("div"),o=N("label"),o.textContent="Replace Host(address) in text body",f=Q(),l=N("select"),u=N("option"),u.textContent="Enabled",c=N("option"),c.textContent="Disabled",d=Q(),h=N("div"),p=N("label"),p.textContent="Replace Access-Control-Allow-Origin header",v=Q(),g=N("select"),C=N("option"),C.textContent="Enabled",x=N("option"),x.textContent="Disabled",y=Q(),S=N("div"),T=N("div"),T.textContent="Inject request header",A=Q(),ut(k.$$.fragment),O=Q(),I=N("div"),w=N("div"),w.textContent="Inject response header",P=Q(),ut(V.$$.fragment),K=Q(),H=N("div"),q=N("div"),q.textContent="Replace text in body",ne=Q(),ut(fe.$$.fragment),R(n,"class","http-select-box-vertical-line svelte-9x5gaz"),R(o,"for","select-change-host-in-body"),R(o,"class","form-label"),u.__value="true",qe(u,u.__value),c.__value="false",qe(c,c.__value),R(l,"id","select-change-host-in-body"),R(l,"class","svelte-9x5gaz"),R(s,"class","input-box"),R(p,"for","select-change-acao"),R(p,"class","form-label"),C.__value="true",qe(C,C.__value),x.__value="false",qe(x,x.__value),R(g,"id","select-change-acao"),R(g,"class","svelte-9x5gaz"),R(h,"class","input-box"),R(T,"class","form-label"),R(S,"class","input-box"),R(w,"class","form-label"),R(I,"class","input-box"),R(q,"class","form-label"),R(H,"class","input-box"),R(r,"class","http-select-box svelte-9x5gaz")},m(ae,ye){le(ae,t,ye),le(ae,a,ye),le(ae,r,ye),m(r,n),m(r,i),m(r,s),m(s,o),m(s,f),m(s,l),m(l,u),m(l,c),m(r,d),m(r,h),m(h,p),m(h,v),m(h,g),m(g,C),m(g,x),m(r,y),m(r,S),m(S,T),m(S,A),ot(k,S,null),m(r,O),m(r,I),m(I,w),m(I,P),ot(V,I,null),m(r,K),m(r,H),m(H,q),m(H,ne),ot(fe,H,null),M=!0},p(ae,ye){e=ae;const Pe={};!B&&ye[0]&1&&(B=!0,Pe.options=e[60].httpOption.customRequestHeaders,Kt(()=>B=!1)),k.$set(Pe);const Re={};!$&&ye[0]&1&&($=!0,Re.options=e[60].httpOption.customResponseHeaders,Kt(()=>$=!1)),V.$set(Re);const Ae={};!X&&ye[0]&1&&(X=!0,Ae.options=e[60].httpOption.bodyRewriteRules,Kt(()=>X=!1)),fe.$set(Ae)},i(ae){M||(Te(k.$$.fragment,ae),Te(V.$$.fragment,ae),Te(fe.$$.fragment,ae),M=!0)},o(ae){De(k.$$.fragment,ae),De(V.$$.fragment,ae),De(fe.$$.fragment,ae),M=!1},d(ae){ae&&(se(t),se(a),se(r)),lt(k),lt(V),lt(fe)}}}function qs(e){var C0;let t,a,r,n,i,s,o=e[60].forwardPort+"",f,l,u=e[60].destinationAddress+"",c,d,h=e[60].destinationPort+"",p,v,g=e[60].protocol.toUpperCase()+"",C,x,y,S,T,A,k,B,O,I,w,P,V,$,K,H,q,ne,fe,X,M,G,Y,W,ve,he,xe,ae,ye,Pe,Re,Ae,Ie,me,Se,ge,Ve,Be,gt,yt,xt,et,Bt,Ye,Ze,j,J,ke,we,pt,jt,ir,$a,Rt,br,Nr,Rr,ka,Na,Lr,sr,Ra,Sr,en,jr,ur,ua=e[0][e[62]].isSync?" Apply and Restart ":"Start",La,Yr,tn,Tr,mt=e[0][e[62]].isSync?"Stop and ":"",Zt,Da,Dt,Fn,y0;function x0(dr,$e){return dr[1][dr[60].forwardPort]?kh:wh}let rn=x0(e),cr=rn(e),Ct=((C0=e[1][e[60].forwardPort])==null?void 0:C0.online)&&Ms(e);function el(){e[21].call(P,e[61],e[62])}function tl(){return e[22](e[60])}function rl(){e[23].call(K,e[61],e[62])}let Et=e[60].tls===!0&&Hs(e);function al(){e[25].call(W,e[61],e[62])}function nl(){e[26].call(ye,e[61],e[62])}function il(){e[27].call(me,e[61],e[62])}function sl(){e[28].call(et,e[61],e[62])}function ol(){e[29].call(J,e[61],e[62])}function m0(){e[30].call(Rt,e[61],e[62])}function ll(){return e[31](e[60])}let _t=(e[60].protocol==="https"||e[60].protocol==="http")&&zs(e);function fl(){e[35].call(sr,e[61],e[62])}function ul(){return e[36](e[62])}function cl(){return e[37](e[62])}return{c(){t=N("div"),a=N("div"),r=N("div"),n=N("div"),n.textContent=`${e[62]+1}.`,i=Q(),s=N("div"),f=de(o),l=de("  ⬌ "),c=de(u),d=de(":"),p=de(h),v=de(" ("),C=de(g),x=de(")"),y=Q(),S=N("div"),T=N("div"),cr.c(),A=Q(),Ct&&Ct.c(),k=Q(),B=N("div"),O=N("div"),I=N("label"),I.textContent="External Server Port",w=Q(),P=N("input"),V=Q(),$=N("div"),K=N("input"),q=Q(),ne=N("div"),ne.textContent="Secure tunneling Server/Client",fe=Q(),Et&&Et.c(),X=Q(),M=N("div"),G=N("label"),G.textContent="Destination Host",Y=Q(),W=N("input"),ve=Q(),he=N("div"),xe=N("label"),xe.textContent="Destination Port",ae=Q(),ye=N("input"),Pe=Q(),Re=N("div"),Ae=N("label"),Ae.innerHTML='Allowed Client names <span style="font-size: 8pt">(Separate names with a semicolon(;))</span>',Ie=Q(),me=N("input"),Se=Q(),ge=N("div"),Ve=N("div"),Ve.textContent="Mem Buffer size limit per Sessions (MiB)",Be=Q(),gt=N("div"),yt=N("label"),yt.textContent="Server",xt=Q(),et=N("input"),Bt=Q(),Ye=N("div"),Ze=N("label"),Ze.textContent="Client",j=Q(),J=N("input"),ke=Q(),we=N("div"),we.innerHTML='<ul class="svelte-9x5gaz"><li class="svelte-9x5gaz"><span style="font-weight: 900">-1</span> : Unlimited memory buffer.</li> <li class="svelte-9x5gaz"><span style="font-weight: 900">0</span> : Only file cache is used.</li> <li class="svelte-9x5gaz"><span style="font-weight: 900">0&lt;n</span> : When memory buffer limit is exceeded, it uses file cache.</li></ul>',pt=Q(),jt=N("div"),ir=N("label"),ir.textContent="Protocol type",$a=Q(),Rt=N("select"),br=N("option"),br.textContent="TCP",Nr=N("option"),Nr.textContent="HTTP (http/1.1)",Rr=N("option"),Rr.textContent="HTTPS (http/1.1)",ka=Q(),_t&&_t.c(),Na=Q(),Lr=N("div"),sr=N("input"),Ra=Q(),Sr=N("div"),Sr.textContent="Inactive on startup",en=Q(),jr=N("div"),ur=N("button"),La=de(ua),tn=Q(),Tr=N("button"),Zt=de(mt),Da=de("Remove"),R(n,"class","tunneling-title svelte-9x5gaz"),L(n,"display","inline"),L(n,"min-width","25px"),L(n,"font-weight","900"),R(s,"class","tunneling-title svelte-9x5gaz"),L(s,"display","inline"),L(s,"color","#444"),L(r,"display","block"),L(T,"font-size","18pt"),L(T,"font-weight","400"),L(T,"margin-top","-5px"),L(T,"display","inline-block"),R(S,"class","round-box"),L(S,"margin-bottom","5px"),L(a,"font-size","16pt"),R(I,"for","input-external-port"),R(I,"class","form-label"),R(P,"type","number"),R(P,"id","input-external-port"),R(P,"class","form-control"),R(O,"class","input-box"),L(O,"margin-bottom","0"),R(K,"type","checkbox"),R(K,"id","sdf"),L(K,"width","14px"),K.disabled=H=e[60].protocol!=="tcp",L(ne,"display","inline-block"),L(ne,"position","relative"),L(ne,"top","-7px"),L(ne,"font-size","10pt"),R($,"class","input-box check-box"),L($,"margin-bottom",(e[60].tls?10:20)+"px"),R(G,"for","input-destination-host"),R(G,"class","form-label"),R(W,"type","text"),R(W,"id","input-destination-host"),R(W,"class","form-control"),R(M,"class","input-box"),R(xe,"for","input-destination-port"),R(xe,"class","form-label"),R(ye,"type","number"),R(ye,"id","input-destination-port"),R(ye,"class","form-control"),R(he,"class","input-box"),R(Ae,"for","input-allow-client-names"),R(Ae,"class","form-label"),R(me,"type","text"),R(me,"id","input-allow-client-names"),R(me,"class","form-control"),R(Re,"class","input-box"),R(Ve,"class","form-label"),R(yt,"for","input-buffer-limit-server"),R(yt,"class","form-label"),L(yt,"font-size","10pt"),L(yt,"color","#666666"),R(et,"type","number"),R(et,"id","input-buffer-limit-server"),R(et,"class","form-control"),L(gt,"width","calc(50% - 2px)"),L(gt,"display","inline-block"),R(Ze,"for","input-buffer-limit-client"),R(Ze,"class","form-label"),L(Ze,"font-size","10pt"),L(Ze,"color","#666666"),R(J,"type","number"),R(J,"id","input-buffer-limit-client"),R(J,"class","form-control"),L(Ye,"width","calc(50% - 2px)"),L(Ye,"display","inline-block"),L(we,"color","#666"),L(we,"font-size","10pt"),L(we,"margin-left","-10px"),R(ge,"class","input-box"),R(ir,"for","select-protocol"),R(ir,"class","form-label"),br.__value="tcp",qe(br,br.__value),Nr.__value="http",qe(Nr,Nr.__value),Rr.__value="https",qe(Rr,Rr.__value),R(Rt,"id","select-protocol"),L(Rt,"min-width","calc(100% - 5px)"),R(Rt,"class","svelte-9x5gaz"),e[60].protocol===void 0&&pn(m0),R(jt,"class","input-box"),R(sr,"type","checkbox"),L(sr,"width","14px"),L(Sr,"display","inline-block"),L(Sr,"position","relative"),L(Sr,"top","-7px"),L(Sr,"font-size","10pt"),L(ur,"width","160px"),ur.disabled=Yr=!e[0][e[62]].updatable,L(Tr,"width","140px"),R(B,"class","round-box"),L(t,"width","100%"),L(t,"margin-bottom","20px")},m(dr,$e){le(dr,t,$e),m(t,a),m(a,r),m(r,n),m(r,i),m(r,s),m(s,f),m(s,l),m(s,c),m(s,d),m(s,p),m(s,v),m(s,C),m(s,x),m(a,y),m(a,S),m(S,T),cr.m(T,null),m(S,A),Ct&&Ct.m(S,null),m(t,k),m(t,B),m(B,O),m(O,I),m(O,w),m(O,P),qe(P,e[60].forwardPort),m(B,V),m(B,$),m($,K),K.checked=e[60].tls,m($,q),m($,ne),m(B,fe),Et&&Et.m(B,null),m(B,X),m(B,M),m(M,G),m(M,Y),m(M,W),qe(W,e[60].destinationAddress),m(B,ve),m(B,he),m(he,xe),m(he,ae),m(he,ye),qe(ye,e[60].destinationPort),m(B,Pe),m(B,Re),m(Re,Ae),m(Re,Ie),m(Re,me),qe(me,e[60].allowedClientNamesQuery),m(B,Se),m(B,ge),m(ge,Ve),m(ge,Be),m(ge,gt),m(gt,yt),m(gt,xt),m(gt,et),qe(et,e[60].bufferLimitOnServer),m(ge,Bt),m(ge,Ye),m(Ye,Ze),m(Ye,j),m(Ye,J),qe(J,e[60].bufferLimitOnClient),m(ge,ke),m(ge,we),m(B,pt),m(B,jt),m(jt,ir),m(jt,$a),m(jt,Rt),m(Rt,br),m(Rt,Nr),m(Rt,Rr),b0(Rt,e[60].protocol,!0),m(B,ka),_t&&_t.m(B,null),m(B,Na),m(B,Lr),m(Lr,sr),sr.checked=e[60].inactiveOnStartup,m(Lr,Ra),m(Lr,Sr),m(B,en),m(B,jr),m(jr,ur),m(ur,La),m(jr,tn),m(jr,Tr),m(Tr,Zt),m(Tr,Da),Dt=!0,Fn||(y0=[_e(P,"input",el),_e(K,"change",tl),_e(K,"change",rl),_e(W,"input",al),_e(ye,"input",nl),_e(me,"input",il),_e(et,"input",sl),_e(J,"input",ol),_e(Rt,"change",m0),_e(Rt,"change",ll),_e(sr,"change",Ph),_e(sr,"change",fl),_e(ur,"click",ul),_e(Tr,"click",cl)],Fn=!0)},p(dr,$e){var E0;e=dr,(!Dt||$e[0]&1)&&o!==(o=e[60].forwardPort+"")&&Ke(f,o),(!Dt||$e[0]&1)&&u!==(u=e[60].destinationAddress+"")&&Ke(c,u),(!Dt||$e[0]&1)&&h!==(h=e[60].destinationPort+"")&&Ke(p,h),(!Dt||$e[0]&1)&&g!==(g=e[60].protocol.toUpperCase()+"")&&Ke(C,g),rn===(rn=x0(e))&&cr?cr.p(e,$e):(cr.d(1),cr=rn(e),cr&&(cr.c(),cr.m(T,null))),(E0=e[1][e[60].forwardPort])!=null&&E0.online?Ct?(Ct.p(e,$e),$e[0]&3&&Te(Ct,1)):(Ct=Ms(e),Ct.c(),Te(Ct,1),Ct.m(S,null)):Ct&&(zr(),De(Ct,1,1,()=>{Ct=null}),qr()),$e[0]&1&&Mt(P.value)!==e[60].forwardPort&&qe(P,e[60].forwardPort),(!Dt||$e[0]&1&&H!==(H=e[60].protocol!=="tcp"))&&(K.disabled=H),$e[0]&1&&(K.checked=e[60].tls),(!Dt||$e[0]&1)&&L($,"margin-bottom",(e[60].tls?10:20)+"px"),e[60].tls===!0?Et?(Et.p(e,$e),$e[0]&1&&Te(Et,1)):(Et=Hs(e),Et.c(),Te(Et,1),Et.m(B,X)):Et&&(zr(),De(Et,1,1,()=>{Et=null}),qr()),$e[0]&1&&W.value!==e[60].destinationAddress&&qe(W,e[60].destinationAddress),$e[0]&1&&Mt(ye.value)!==e[60].destinationPort&&qe(ye,e[60].destinationPort),$e[0]&1&&me.value!==e[60].allowedClientNamesQuery&&qe(me,e[60].allowedClientNamesQuery),$e[0]&1&&Mt(et.value)!==e[60].bufferLimitOnServer&&qe(et,e[60].bufferLimitOnServer),$e[0]&1&&Mt(J.value)!==e[60].bufferLimitOnClient&&qe(J,e[60].bufferLimitOnClient),$e[0]&1&&b0(Rt,e[60].protocol),e[60].protocol==="https"||e[60].protocol==="http"?_t?(_t.p(e,$e),$e[0]&1&&Te(_t,1)):(_t=zs(e),_t.c(),Te(_t,1),_t.m(B,Na)):_t&&(zr(),De(_t,1,1,()=>{_t=null}),qr()),$e[0]&1&&(sr.checked=e[60].inactiveOnStartup),(!Dt||$e[0]&1)&&ua!==(ua=e[0][e[62]].isSync?" Apply and Restart ":"Start")&&Ke(La,ua),(!Dt||$e[0]&1&&Yr!==(Yr=!e[0][e[62]].updatable))&&(ur.disabled=Yr),(!Dt||$e[0]&1)&&mt!==(mt=e[0][e[62]].isSync?"Stop and ":"")&&Ke(Zt,mt)},i(dr){Dt||(Te(Ct),Te(Et),Te(_t),Dt=!0)},o(dr){De(Ct),De(Et),De(_t),Dt=!1},d(dr){dr&&se(t),cr.d(),Ct&&Ct.d(),Et&&Et.d(),_t&&_t.d(),Fn=!1,nr(y0)}}}function Lh(e){let t,a;return{c(){t=new Tn(!1),a=ja(),t.a=a},m(r,n){t.m(e[5],r,n),le(r,a,n)},p(r,n){n[0]&32&&t.p(r[5])},d(r){r&&(se(a),t.d())}}}function Dh(e){let t,a,r,n,i,s,o,f,l,u,c,d,h,p,v,g,C,x=ar(e[0]),y=[];for(let w=0;w<x.length;w+=1)y[w]=qs(Fs(e,x,w));const S=w=>De(y[w],1,1,()=>{y[w]=null});function T(w){e[38](w)}function A(w){e[39](w)}let k={$$slots:{default:[Lh]},$$scope:{ctx:e}};e[4]!==void 0&&(k.show=e[4]),e[6]!==void 0&&(k.button=e[6]),f=new wa({props:k}),ft.push(()=>Ht(f,"show",T)),ft.push(()=>Ht(f,"button",A)),f.$on("close",function(){Wa(e[7])&&e[7].apply(this,arguments)});function B(w){e[40](w)}function O(w){e[41](w)}let I={};return e[2]!==void 0&&(I.show=e[2]),e[3]!==void 0&&(I.transition=e[3]),d=new $o({props:I}),ft.push(()=>Ht(d,"show",B)),ft.push(()=>Ht(d,"transition",O)),{c(){t=N("main"),a=N("div"),r=N("h2"),r.textContent="Tunneling settings",n=Q();for(let w=0;w<y.length;w+=1)y[w].c();i=Q(),s=N("button"),s.textContent="Add tunneling service",o=Q(),ut(f.$$.fragment),c=Q(),ut(d.$$.fragment),R(r,"class","title svelte-9x5gaz"),L(s,"margin-top","8px"),L(s,"width","180px"),R(a,"class",""),L(a,"margin-top","20px"),R(t,"class","svelte-9x5gaz")},m(w,P){le(w,t,P),m(t,a),m(a,r),m(a,n);for(let V=0;V<y.length;V+=1)y[V]&&y[V].m(a,null);m(a,i),m(a,s),m(t,o),ot(f,t,null),m(t,c),ot(d,t,null),v=!0,g||(C=_e(s,"click",e[9]),g=!0)},p(w,P){if(e=w,P[0]&130307){x=ar(e[0]);let K;for(K=0;K<x.length;K+=1){const H=Fs(e,x,K);y[K]?(y[K].p(H,P),Te(y[K],1)):(y[K]=qs(H),y[K].c(),Te(y[K],1),y[K].m(a,i))}for(zr(),K=x.length;K<y.length;K+=1)S(K);qr()}const V={};P[0]&32|P[2]&2&&(V.$$scope={dirty:P,ctx:e}),!l&&P[0]&16&&(l=!0,V.show=e[4],Kt(()=>l=!1)),!u&&P[0]&64&&(u=!0,V.button=e[6],Kt(()=>u=!1)),f.$set(V);const $={};!h&&P[0]&4&&(h=!0,$.show=e[2],Kt(()=>h=!1)),!p&&P[0]&8&&(p=!0,$.transition=e[3],Kt(()=>p=!1)),d.$set($)},i(w){if(!v){for(let P=0;P<x.length;P+=1)Te(y[P]);Te(f.$$.fragment,w),Te(d.$$.fragment,w),v=!0}},o(w){y=y.filter(Boolean);for(let P=0;P<y.length;P+=1)De(y[P]);De(f.$$.fragment,w),De(d.$$.fragment,w),v=!1},d(w){w&&se(t),_a(y,w),lt(f),lt(d),g=!1,C()}}}const Ph=()=>{};function Uh(e,t,a){let r={},n=0,i=[],s=[],o=!1,f=!1,l=!1,u=!1,c="",d="Ok",h=()=>{},p={},v=null;kr(async()=>{o||(await y(),await k(),A(),a(17,o=!0))});let g=j=>j<0?0:j>65535?65535:j,C=j=>j<-1?-1:j>1048576?1048576:j,x=()=>{for(let j of i)j.updatable=Vt.checkValidTunnelingOption(j)},y=async()=>{var j;try{a(2,f=!0),a(0,i=await Vt.instance.getTunnelingOption());for(let J of i)J.isSync=!0,J.updatable=!0,J.allowedClientNamesQuery=(j=J.allowedClientNames)==null?void 0:j.join("; "),J.allowedClientNamesQuery?J.allowedClientNamesQuery+=";":J.allowedClientNamesQuery="";s=Xe.cloneDeep(i),await S(),x(),a(2,f=!1)}catch(J){if(console.error(J),a(2,f=!1),J instanceof at){$();return}V()}},S=async()=>{a(2,f=!0);for(let j of i)await T(j.forwardPort);a(2,f=!1)},T=async j=>{try{let J=i.find(ke=>ke.forwardPort===j);J.certInfo=await Or.instance.loadExternalServerCert(j),a(0,i=[...i])}catch(J){if(console.error(J),J instanceof at){$();return}V()}},A=()=>{k(),v||(v=setInterval(async()=>{f||await k(!0)==!1&&clearInterval(v)},1e3))},k=async j=>{try{let J={},ke=await Vt.instance.loadTunnelingStatus();n=ke.serverTime;for(let we of ke.statuses)J[we.port]=we,we&&we.active&&p[we.port]&&p[we.port].update(X(we),we.activeTimeout);return a(1,r=J),!0}catch(J){return j?!1:J instanceof at?($(),!1):(V(),!1)}},B=async()=>{i.push({forwardPort:Math.floor(Math.random()*65534+10),tls:!1,protocol:"tcp",httpOption:{rewriteHostInTextBody:!0,replaceAccessControlAllowOrigin:!1,customRequestHeaders:[],customResponseHeaders:[],bodyRewriteRules:[]},destinationAddress:"127.0.0.1",destinationPort:8080,isSync:!1,updatable:!0,allowedClientNamesQuery:""}),a(0,i=[...i])},O=j=>{if(j.protocol=="https"){let J=j.tls;j.tls=!0,J||H(j.forwardPort)}else j.tls=!1;a(0,i=[...i])},I=async j=>{if(i[j]===void 0)return;let ke=i[j];a(2,f=!0);try{let we={success:!0,message:"",forwardPort:ke.forwardPort};ke.isSync&&(we=await Vt.instance.removeTunnelingOption(ke)),a(2,f=!1),we.success?(i.splice(j,1),a(0,i=[...i]),ke.isSync&&K("Tunneling option has been removed.<br/>The external server has been shut down."),await y()):K("Fail: "+we.message)}catch(we){if(a(2,f=!1),we instanceof at){$();return}V()}},w=async()=>{let j=s.map(ke=>ke.forwardPort),J=i.map(ke=>ke.forwardPort);for(let ke of j)if(J.indexOf(ke)===-1)try{let we=s.find(pt=>pt.forwardPort===ke);we&&we.certInfo&&await Or.instance.deleteExternalServerCert(ke),await Vt.instance.removeTunnelingOption({forwardPort:ke})}catch(we){console.error(we)}},P=async j=>{var ke;a(2,f=!0);let J=i[j];J.allowedClientNames=J.allowedClientNamesQuery.split(";").map(we=>we.trim()).filter(we=>we!=="");try{if(await w(),J.tls,J.tls&&J.certInfo){let pt=await Or.instance.updateExternalServerCert(J.forwardPort,J.certInfo);if(!pt.success){a(2,f=!1),K("Fail to apply tunneling option: "+pt.message);return}}let we=await Vt.instance.updateTunnelingOption(J);a(2,f=!1),we.success?(p[J.forwardPort]&&((ke=r[J.forwardPort])!=null&&ke.activeTimeout)&&p[J.forwardPort].reset(r[J.forwardPort].activeTimeout),s=Xe.cloneDeep(i),K("Success to apply tunneling option")):K("Fail to apply tunneling option: "+we.message),await y(),await k()}catch(we){if(console.error(we),a(2,f=!1),we instanceof at){$();return}V()}},V=()=>{K("Unable to connect to the server.","OK",()=>{location.href="/"})},$=()=>{K("Session is expired.<br/>Please login again.","OK",()=>{location.href="/"})},K=(j,J,ke)=>{J?a(6,d=J):J="OK",ke==null?a(7,h=()=>{}):a(7,h=ke),a(5,c=j),a(4,u=!0)},H=async j=>{i.find(ke=>ke.forwardPort===j)!==void 0&&await T(j)},q=j=>{if(!j)return"0s";let J=Date.now()-j;return J>1e3*60*60*24?Math.floor(J/(1e3*60*60*24))+"d, "+Math.floor(J%(1e3*60*60*24)/(1e3*60*60))+"h":J>1e3*60*60?Math.floor(J/(1e3*60*60))+"h, "+Math.floor(J%(1e3*60*60)/(1e3*60))+"m":J>1e3*60?Math.floor(J/(1e3*60))+"m":Math.floor(J/1e3)+"s"},ne=(j,J)=>{let ke=Math.pow(10,J);return Math.floor(j*ke)/ke},fe=j=>(j=j,j>1024*1024*1024?ne(j/(1024*1024*1024),2)+"Gb":j>1024*1024?ne(j/(1024*1024),2)+"Mb":j>1024?ne(j/1024,2)+"Kb":j+"B"),X=j=>{let J=j.activeStart+j.activeTimeout*1e3-n;return J<0&&(J=0),J=Math.floor(J/1e3),J},M=async(j,J,ke)=>{if(j){let pt=r[J];pt&&p[pt.port]&&p[pt.port].update(X(pt),pt.activeTimeout)}let we=r[J].active;if(we==j&&ke==null){console.log("time: "+ke);return}ke=ke??r[J].activeTimeout;try{a(2,f=!0),a(3,l=!0);let pt=await Vt.instance.activeExternalPortServer(j,J,ke);await k(),pt.success?a(1,r[J].active=j,r):a(1,r[J].active=we,r),ke>0,a(2,f=!1),a(3,l=!1)}catch(pt){if(console.error(pt),a(2,f=!1),a(3,l=!1),pt instanceof at){$();return}V()}};const G=(j,J)=>M(J.detail.on,j.forwardPort);function Y(j,J){ft[j?"unshift":"push"](()=>{p[J.forwardPort]=j,a(8,p)})}const W=(j,J)=>{M(!0,j.forwardPort,J.detail.time)};function ve(j,J){j[J].forwardPort=Mt(this.value),a(0,i)}const he=j=>{H(j.forwardPort)};function xe(j,J){j[J].tls=this.checked,a(0,i)}const ae=(j,J,ke,we)=>{a(0,J[ke].certInfo=we.detail,i)};function ye(j,J){j[J].destinationAddress=this.value,a(0,i)}function Pe(j,J){j[J].destinationPort=Mt(this.value),a(0,i)}function Re(j,J){j[J].allowedClientNamesQuery=this.value,a(0,i)}function Ae(j,J){j[J].bufferLimitOnServer=Mt(this.value),a(0,i)}function Ie(j,J){j[J].bufferLimitOnClient=Mt(this.value),a(0,i)}function me(j,J){j[J].protocol=_l(this),a(0,i)}const Se=j=>O(j);function ge(j,J){e.$$.not_equal(J.httpOption.customRequestHeaders,j)&&(J.httpOption.customRequestHeaders=j,a(0,i))}function Ve(j,J){e.$$.not_equal(J.httpOption.customResponseHeaders,j)&&(J.httpOption.customResponseHeaders=j,a(0,i))}function Be(j,J){e.$$.not_equal(J.httpOption.bodyRewriteRules,j)&&(J.httpOption.bodyRewriteRules=j,a(0,i))}function gt(j,J){j[J].inactiveOnStartup=this.checked,a(0,i)}const yt=j=>P(j),xt=j=>I(j);function et(j){u=j,a(4,u)}function Bt(j){d=j,a(6,d)}function Ye(j){f=j,a(2,f)}function Ze(j){l=j,a(3,l)}return e.$$.update=()=>{if(e.$$.dirty[0]&131073){o&&i.length>0&&x();for(let j of i)j.destinationPort=g(j.destinationPort),j.forwardPort=g(j.forwardPort),j.bufferLimitOnClient=C(j.bufferLimitOnClient),j.bufferLimitOnServer=C(j.bufferLimitOnServer)}},[i,r,f,l,u,c,d,h,p,B,O,I,P,H,q,fe,M,o,G,Y,W,ve,he,xe,ae,ye,Pe,Re,Ae,Ie,me,Se,ge,Ve,Be,gt,yt,xt,et,Bt,Ye,Ze]}class Oh extends Wt{constructor(t){super(),Qt(this,t,Uh,Dh,Gt,{},null,[-1,-1,-1])}}function Vh(e){let t,a,r,n,i,s,o,f,l,u,c,d;return{c(){t=N("main"),a=N("h2"),a.textContent="Sign in",r=Q(),n=N("div"),i=N("input"),s=Q(),o=N("div"),f=Q(),l=N("div"),u=N("button"),u.textContent="OK",R(a,"class","svelte-16cov7s"),R(i,"type","password"),R(i,"class","form-control svelte-16cov7s"),R(i,"placeholder","Password"),R(i,"aria-label","Password"),R(o,"id","login-message"),R(o,"class","svelte-16cov7s"),R(n,"class","input-box svelte-16cov7s"),R(u,"type","button"),R(u,"class","svelte-16cov7s"),R(l,"class","button-box svelte-16cov7s"),R(t,"class","svelte-16cov7s")},m(h,p){le(h,t,p),m(t,a),m(t,r),m(t,n),m(n,i),m(n,s),m(n,o),e[3](o),m(t,f),m(t,l),m(l,u),c||(d=[_e(i,"keyup",e[2]),_e(u,"click",e[1])],c=!0)},p:ct,i:ct,o:ct,d(h){h&&se(t),e[3](null),c=!1,nr(d)}}}function Fh(e,t,a){let r,n=!1;kr(async()=>{if(n=await Ga.isEmptyKey(),n&&r){a(0,r.innerHTML="No password has been set. Enter the desired password.",r);return}});let i=async f=>{let u=document.querySelector("input").value;if(u==""){a(0,r.innerHTML="Please enter your password.",r);return}if(n){if(u.length<12){a(0,r.innerHTML="The password must be at least 12 characters long.",r);return}else if(!u.match(/[0-9]/g)||!u.match(/[~!@#$%^&*()_+|<>?:{}]/g)){a(0,r.innerHTML="The password must contain at least one number or special character.",r);return}}await Ga.login(u)?window.location.href="/":a(0,r.innerHTML="The password is incorrect.",r)},s=f=>{f.key=="Enter"&&i()};function o(f){ft[f?"unshift":"push"](()=>{r=f,a(0,r)})}return[r,i,s,o]}class Mh extends Wt{constructor(t){super(),Qt(this,t,Fh,Vh,Gt,{})}}class fr{static map(t,a,r,n,i){return(t-a)*(i-n)/(r-a)+n}static floor(t,a){let r=Math.pow(10,a);return Math.floor(t*r)/r}static ceil(t,a){let r=Math.pow(10,a);return Math.ceil(t*r)/r}static round(t,a){let r=Math.pow(10,a);return Math.round(t*r)/r}}function Kh(e){let t,a,r,n,i,s,o,f,l,u,c,d,h,p,v,g,C,x,y,S,T,A,k,B,O,I,w,P,V,$,K,H,q;return{c(){t=N("div"),a=N("div"),r=de(e[1]),n=Q(),i=N("div"),s=N("div"),o=Q(),f=N("div"),l=Q(),u=N("div"),c=Q(),d=N("div"),h=Q(),p=N("div"),v=Q(),g=N("div"),C=Q(),x=N("div"),y=Q(),S=N("div"),T=Q(),A=N("div"),k=Q(),B=N("div"),O=Q(),I=N("div"),w=Q(),P=N("div"),V=de(e[4]),$=N("span"),$.textContent="%",K=Q(),H=N("div"),q=de(e[2]),R(a,"class","title svelte-1495737"),R(s,"class","gauge svelte-1495737"),R(f,"class","tick-mark mark-center svelte-1495737"),R(u,"class","tick-mark mark-30 svelte-1495737"),R(d,"class","tick-mark mark-60 svelte-1495737"),R(p,"class","tick-mark mark-90 svelte-1495737"),R(g,"class","tick-mark mark-120 svelte-1495737"),R(x,"class","tick-mark mark-150 svelte-1495737"),R(S,"class","gauge-background svelte-1495737"),R(A,"class","needle svelte-1495737"),R(B,"class","gauge-border-bottom svelte-1495737"),R(I,"class","gauge-ball svelte-1495737"),R(i,"class","gauge-container svelte-1495737"),L($,"font-size","12pt"),R(P,"class","percent-box svelte-1495737"),R(H,"class","message svelte-1495737"),R(t,"class","main svelte-1495737"),R(t,"style",e[0])},m(ne,fe){le(ne,t,fe),m(t,a),m(a,r),m(t,n),m(t,i),m(i,s),m(i,o),m(i,f),m(i,l),m(i,u),m(i,c),m(i,d),m(i,h),m(i,p),m(i,v),m(i,g),m(i,C),m(i,x),m(i,y),m(i,S),m(i,T),m(i,A),e[9](A),m(i,k),m(i,B),m(i,O),m(i,I),m(t,w),m(t,P),m(P,V),m(P,$),m(t,K),m(t,H),m(H,q)},p(ne,[fe]){fe&2&&Ke(r,ne[1]),fe&16&&Ke(V,ne[4]),fe&4&&Ke(q,ne[2]),fe&1&&R(t,"style",ne[0])},i:ct,o:ct,d(ne){ne&&se(t),e[9](null)}}}const Ii=82;function Hh(e,t,a){let{style:r=""}=t,{max:n=100}=t,{min:i=0}=t,{value:s=0}=t,{duration:o=1e3}=t,{title:f=""}=t,{message:l=""}=t,u;const c=-82;let d=-82,h=null,p=0,v={min:i,max:n,value:s};kr(()=>{u&&g()}),Sl(()=>{s<i?a(6,s=i):s>n&&a(6,s=n),n<=0&&a(5,n=1),Xe.equalsDeep(v,{min:i,max:n,value:s})||(g(),v={min:i,max:n,value:s})});let g=()=>{if(!u)return;a(4,p=fr.round(fr.map(s,i,n,0,100),1));let y=fr.map(s,i,n,c,Ii);C(y)},C=y=>{u&&(y=Math.round(y),y<c?y=c:y>Ii&&(y=Ii),d!=y&&(h==null||h.pause(),setTimeout(()=>{h=u.animate([{transform:`rotate(${d}deg)`},{transform:`rotate(${y}deg)`}],{duration:o,easing:"ease-in-out",fill:"forwards"}),d=y},0)))};function x(y){ft[y?"unshift":"push"](()=>{u=y,a(3,u)})}return e.$$set=y=>{"style"in y&&a(0,r=y.style),"max"in y&&a(5,n=y.max),"min"in y&&a(7,i=y.min),"value"in y&&a(6,s=y.value),"duration"in y&&a(8,o=y.duration),"title"in y&&a(1,f=y.title),"message"in y&&a(2,l=y.message)},[r,f,l,u,p,n,s,i,o,x]}class fn extends Wt{constructor(t){super(),Qt(this,t,Hh,Kh,Gt,{style:0,max:5,min:7,value:6,duration:8,title:1,message:2})}get style(){return this.$$.ctx[0]}set style(t){this.$$set({style:t}),vr()}get max(){return this.$$.ctx[5]}set max(t){this.$$set({max:t}),vr()}get min(){return this.$$.ctx[7]}set min(t){this.$$set({min:t}),vr()}get value(){return this.$$.ctx[6]}set value(t){this.$$set({value:t}),vr()}get duration(){return this.$$.ctx[8]}set duration(t){this.$$set({duration:t}),vr()}get title(){return this.$$.ctx[1]}set title(t){this.$$set({title:t}),vr()}get message(){return this.$$.ctx[2]}set message(t){this.$$set({message:t}),vr()}}const aa=class aa{constructor(){Lt(this,"_sysInfoCache",null)}static get instance(){return aa._instance||(aa._instance=new aa),aa._instance}async getSysUsage(){let t=await fetch("/api/sysUsage",{method:"GET",credentials:"same-origin"}),a=await t.json();if(!a||t.status==401)throw new at;return this._sysInfoCache=a.system,a}async getSysInfo(){if(this._sysInfoCache)return this._sysInfoCache;let t=await fetch("/api/sysInfo",{method:"GET",credentials:"same-origin"}),a=await t.json();if(!a||t.status==401)throw new at;return this._sysInfoCache=a.system,a}async getClientStatus(){let t=await fetch("/api/clientStatus",{method:"GET",credentials:"same-origin"}),a=await t.json();if(!a||t.status==401)throw new at;return this._sysInfoCache=a.system,a}};Lt(aa,"_instance");let za=aa;const zh="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHElEQVR4nO2ZbwrCMAzF36fdST2fTq/VIuI9Nq8RESrM4lib/u/yg3wppMtr9rrAgB3zBPAosB4dMpF7PToipLaONMcA4AbgtTilUjEDGE1N3lwrEEBWXDhCZpN8QHmOi854U5vpiFuPCEkEuXREW6ZyTswI/amNTO1dCFE+iTVAYnbsqCP3iF/tH9NyhXDNHnsEKXZrxXr9QoSo2JuHkPRZJEL8kY7YtGx23YsQFXvzEMQjLkhHSh6abtjsupehUW3kOW1uH0BIbBWUdNbKCYkQNNgRzTR7TijlrZUTSnlr5YTE7OikI7NJ/PxkKc3J1DJxkscEI0honDlCBiPm25mSMRkRrJ+h3UMrpku9Hh0RUltH9MpYkHodu+ANSkYsKecABh8AAAAASUVORK5CYII=",qh="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAABlklEQVR4nO2VzUrDQBSFv415hD6E6br40wrqw1kRpf5UEJ/DutGN1W7ala2PUF0r7qJEBk7gkuYPkxRFD1wY7tw752RyZgb+kY0m0ANmwLtippyby0MDmCjcuDA8oA98AmFKfACnqk0jn5r6aVERHnCrpgA4AVrAlaKlXKCamwQRlnwaG+eK6Kv4GdjMqGurJpQgi0mM0AoaZ5E3tbVBDrkVEajHN/mhiHzjAV+5u6wFe1J5kWMqRxDhTD1HVXjgScXbKeRJ27hmCEp74M0ojr7yIeb++CID5V1vaQ+8GqLoXw1NbpzwBZEA11vaAzMttkNxrKvnsQoPHOaYMAnn6jmowgO+OYbuiOVhy9SvVuEBh2NzEXXIJn9JOYKRB+zXNop4AF2r1+a+vwR2ZbaB/vm55kLlVqgAHrBvrtc6Yg500x6wbo3E8XBcC5hrcoP60DY7sYBQUQYj4D5nnMoTViBgGLtBk8a1CiiCXAHhkuLnCqgbtQoY/epTMNdEkVfwu+hkXUTdJRpwL0mAJxHRTiz9MeJP4gtUX2rbPT2HhAAAAABJRU5ErkJggg==";function Gs(e,t,a){const r=e.slice();return r[6]=t[a],r}function Qs(e,t,a){const r=e.slice();return r[9]=t[a],r}function Ws(e){let t,a,r,n,i,s=e[2].cpuInfo.model+"",o,f,l,u,c=e[2].cpuInfo.speed+"",d,h,p,v,g=e[2].cpuInfo.cores+"",C,x,y,S,T=e[4](e[2].ram)+"",A,k,B,O,I,w,P,V=e[2].osInfo.type+"",$,K,H,q,ne=e[2].osInfo.platform+"",fe,X,M,G,Y=e[2].osInfo.release+"",W,ve,he,xe,ae=e[2].osInfo.hostname+"",ye,Pe,Re,Ae,Ie,me=ar(Object.keys(e[2].network)),Se=[];for(let ge=0;ge<me.length;ge+=1)Se[ge]=Ys(Gs(e,me,ge));return{c(){t=N("h4"),t.textContent="HW Info",a=Q(),r=N("ul"),n=N("li"),i=de("CPU: "),o=de(s),f=Q(),l=N("li"),u=de("Clock: "),d=de(c),h=Q(),p=N("li"),v=de("Cores: "),C=de(g),x=Q(),y=N("li"),S=de("RAM: "),A=de(T),k=Q(),B=N("h4"),B.textContent="OS Info",O=Q(),I=N("ul"),w=N("li"),P=de("Type: "),$=de(V),K=Q(),H=N("li"),q=de("Platform: "),fe=de(ne),X=Q(),M=N("li"),G=de("Release: "),W=de(Y),ve=Q(),he=N("li"),xe=de("hostname: "),ye=de(ae),Pe=Q(),Re=N("h4"),Re.textContent="Network",Ae=Q(),Ie=N("ul");for(let ge=0;ge<Se.length;ge+=1)Se[ge].c();R(t,"class","svelte-1jfva93"),R(r,"class","svelte-1jfva93"),R(B,"class","svelte-1jfva93"),R(I,"class","svelte-1jfva93"),R(Re,"class","svelte-1jfva93"),R(Ie,"class","svelte-1jfva93")},m(ge,Ve){le(ge,t,Ve),le(ge,a,Ve),le(ge,r,Ve),m(r,n),m(n,i),m(n,o),m(r,f),m(r,l),m(l,u),m(l,d),m(r,h),m(r,p),m(p,v),m(p,C),m(r,x),m(r,y),m(y,S),m(y,A),le(ge,k,Ve),le(ge,B,Ve),le(ge,O,Ve),le(ge,I,Ve),m(I,w),m(w,P),m(w,$),m(I,K),m(I,H),m(H,q),m(H,fe),m(I,X),m(I,M),m(M,G),m(M,W),m(I,ve),m(I,he),m(he,xe),m(he,ye),le(ge,Pe,Ve),le(ge,Re,Ve),le(ge,Ae,Ve),le(ge,Ie,Ve);for(let Be=0;Be<Se.length;Be+=1)Se[Be]&&Se[Be].m(Ie,null)},p(ge,Ve){if(Ve&4&&s!==(s=ge[2].cpuInfo.model+"")&&Ke(o,s),Ve&4&&c!==(c=ge[2].cpuInfo.speed+"")&&Ke(d,c),Ve&4&&g!==(g=ge[2].cpuInfo.cores+"")&&Ke(C,g),Ve&4&&T!==(T=ge[4](ge[2].ram)+"")&&Ke(A,T),Ve&4&&V!==(V=ge[2].osInfo.type+"")&&Ke($,V),Ve&4&&ne!==(ne=ge[2].osInfo.platform+"")&&Ke(fe,ne),Ve&4&&Y!==(Y=ge[2].osInfo.release+"")&&Ke(W,Y),Ve&4&&ae!==(ae=ge[2].osInfo.hostname+"")&&Ke(ye,ae),Ve&4){me=ar(Object.keys(ge[2].network));let Be;for(Be=0;Be<me.length;Be+=1){const gt=Gs(ge,me,Be);Se[Be]?Se[Be].p(gt,Ve):(Se[Be]=Ys(gt),Se[Be].c(),Se[Be].m(Ie,null))}for(;Be<Se.length;Be+=1)Se[Be].d(1);Se.length=me.length}},d(ge){ge&&(se(t),se(a),se(r),se(k),se(B),se(O),se(I),se(Pe),se(Re),se(Ae),se(Ie)),_a(Se,ge)}}}function js(e){let t,a,r,n=e[9].address+"",i,s,o,f,l=e[9].netmask+"",u,c,d,h,p=e[9].mac+"",v,g,C,x,y=e[9].internal+"",S,T,A,k,B=e[9].family+"",O,I,w,P,V=e[9].cidr+"",$,K;return{c(){t=N("ul"),a=N("li"),r=de("address: "),i=de(n),s=Q(),o=N("li"),f=de("netmask: "),u=de(l),c=Q(),d=N("li"),h=de("mac: "),v=de(p),g=Q(),C=N("li"),x=de("internal: "),S=de(y),T=Q(),A=N("li"),k=de("family: "),O=de(B),I=Q(),w=N("li"),P=de("cidr: "),$=de(V),K=Q(),R(t,"class","svelte-1jfva93")},m(H,q){le(H,t,q),m(t,a),m(a,r),m(a,i),m(t,s),m(t,o),m(o,f),m(o,u),m(t,c),m(t,d),m(d,h),m(d,v),m(t,g),m(t,C),m(C,x),m(C,S),m(t,T),m(t,A),m(A,k),m(A,O),m(t,I),m(t,w),m(w,P),m(w,$),m(t,K)},p(H,q){q&4&&n!==(n=H[9].address+"")&&Ke(i,n),q&4&&l!==(l=H[9].netmask+"")&&Ke(u,l),q&4&&p!==(p=H[9].mac+"")&&Ke(v,p),q&4&&y!==(y=H[9].internal+"")&&Ke(S,y),q&4&&B!==(B=H[9].family+"")&&Ke(O,B),q&4&&V!==(V=H[9].cidr+"")&&Ke($,V)},d(H){H&&se(t)}}}function Ys(e){let t,a=e[6]+"",r,n,i,s,o=ar(e[2].network[e[6]]),f=[];for(let l=0;l<o.length;l+=1)f[l]=js(Qs(e,o,l));return{c(){t=N("li"),r=de(a),n=de(":"),i=Q();for(let l=0;l<f.length;l+=1)f[l].c();s=ja(),L(t,"margin-top","10px")},m(l,u){le(l,t,u),m(t,r),m(t,n),le(l,i,u);for(let c=0;c<f.length;c+=1)f[c]&&f[c].m(l,u);le(l,s,u)},p(l,u){if(u&4&&a!==(a=l[6]+"")&&Ke(r,a),u&4){o=ar(l[2].network[l[6]]);let c;for(c=0;c<o.length;c+=1){const d=Qs(l,o,c);f[c]?f[c].p(d,u):(f[c]=js(d),f[c].c(),f[c].m(s.parentNode,s))}for(;c<f.length;c+=1)f[c].d(1);f.length=o.length}},d(l){l&&(se(t),se(i),se(s)),_a(f,l)}}}function Gh(e){let t,a,r,n,i,s,o,f,l,u,c,d,h=e[2]&&Ws(e);return{c(){t=N("main"),a=N("div"),r=Q(),n=N("div"),i=N("div"),s=N("div"),h&&h.c(),o=Q(),f=N("div"),l=N("button"),u=de(e[1]),R(a,"class","background svelte-1jfva93"),L(s,"height","100%"),L(s,"width","100%"),L(s,"overflow-y","auto"),L(s,"overflow-x","hidden"),R(i,"class","content-box svelte-1jfva93"),L(l,"width","150px"),L(f,"width","100%"),L(f,"display","flex"),L(f,"justify-content","center"),L(f,"align-items","center"),R(n,"class","popup-box svelte-1jfva93"),L(t,"display",e[0]?"flex":"none"),R(t,"class","svelte-1jfva93")},m(p,v){le(p,t,v),m(t,a),m(t,r),m(t,n),m(n,i),m(i,s),h&&h.m(s,null),m(n,o),m(n,f),m(f,l),m(l,u),c||(d=_e(l,"click",e[3]),c=!0)},p(p,[v]){p[2]?h?h.p(p,v):(h=Ws(p),h.c(),h.m(s,null)):h&&(h.d(1),h=null),v&2&&Ke(u,p[1]),v&1&&L(t,"display",p[0]?"flex":"none")},i:ct,o:ct,d(p){p&&se(t),h&&h.d(),c=!1,d()}}}function Qh(e,t,a){let{show:r=!1}=t,{button:n="Ok"}=t,{sysInfo:i=void 0}=t;const s=Ya();let o=()=>{s("close"),setTimeout(()=>{a(0,r=!1)},0)},f=(l,u)=>l>1099511627776?`${fr.round(l/1099511627776,1)}${u?"":"TiB"}`:l>1073741824?`${fr.round(l/1073741824,1)}${u?"":"GiB"}`:l>1048576?`${fr.round(l/1048576,1)}${u?"":"MiB"}`:l>1024?`${fr.round(l/1024,1)}${u?"":"KiB"}`:`${l}${u?"":"B"}`;return e.$$set=l=>{"show"in l&&a(0,r=l.show),"button"in l&&a(1,n=l.button),"sysInfo"in l&&a(2,i=l.sysInfo)},[r,n,i,o,f]}class Wh extends Wt{constructor(t){super(),Qt(this,t,Qh,Gh,Gt,{show:0,button:1,sysInfo:2})}}function Xs(e,t,a){const r=e.slice();return r[18]=t[a],r[20]=a,r}function Zs(e){let t,a,r,n,i,s,o=e[10](e[6].uptime)+"",f;return{c(){t=N("div"),a=N("div"),r=N("img"),i=Q(),s=N("span"),f=de(o),Xi(r.src,n=qh)||R(r,"src",n),R(r,"width","16"),R(r,"height","16"),R(r,"alt","info"),L(s,"margin-left","2px"),L(s,"font-size","10pt"),L(s,"color","#555"),L(a,"display","flex"),L(a,"align-items","center"),L(a,"margin-bottom","5px"),L(t,"display","inline-block"),L(t,"margin-left","10px")},m(l,u){le(l,t,u),m(t,a),m(a,r),m(a,i),m(a,s),m(s,f)},p(l,u){u&64&&o!==(o=l[10](l[6].uptime)+"")&&Ke(f,o)},d(l){l&&se(t)}}}function Js(e){let t,a,r,n,i,s,o,f,l,u,c,d;return a=new fn({props:{style:"",title:"CPU",message:`${e[6].cpu.process}/${e[6].cpu.total}%`,value:e[6].cpu.process,duration:900}}),i=new fn({props:{style:"",title:"Memory",message:`${e[8](e[6].memory.process)}/${e[8](e[6].memory.total)}`,value:e[6].memory.process,max:e[6].memory.total,duration:900}}),f=new fn({props:{style:"",title:"Heap",message:`${e[8](e[6].heap.used)}/${e[8](e[6].heap.total)}`,value:e[6].heap.used,max:e[6].heap.total,duration:900}}),c=new fn({props:{style:"",title:"Buffer",message:`${e[8](e[6].totalBuffer.used)}/${e[8](e[6].totalBuffer.total)}`,value:e[6].totalBuffer.used,max:e[6].totalBuffer.total,duration:900}}),{c(){t=N("div"),ut(a.$$.fragment),r=Q(),n=N("div"),ut(i.$$.fragment),s=Q(),o=N("div"),ut(f.$$.fragment),l=Q(),u=N("div"),ut(c.$$.fragment),R(t,"class","gauge-box svelte-1emz6h9"),R(n,"class","gauge-box svelte-1emz6h9"),R(o,"class","gauge-box svelte-1emz6h9"),R(u,"class","gauge-box svelte-1emz6h9")},m(h,p){le(h,t,p),ot(a,t,null),le(h,r,p),le(h,n,p),ot(i,n,null),le(h,s,p),le(h,o,p),ot(f,o,null),le(h,l,p),le(h,u,p),ot(c,u,null),d=!0},p(h,p){const v={};p&64&&(v.message=`${h[6].cpu.process}/${h[6].cpu.total}%`),p&64&&(v.value=h[6].cpu.process),a.$set(v);const g={};p&64&&(g.message=`${h[8](h[6].memory.process)}/${h[8](h[6].memory.total)}`),p&64&&(g.value=h[6].memory.process),p&64&&(g.max=h[6].memory.total),i.$set(g);const C={};p&64&&(C.message=`${h[8](h[6].heap.used)}/${h[8](h[6].heap.total)}`),p&64&&(C.value=h[6].heap.used),p&64&&(C.max=h[6].heap.total),f.$set(C);const x={};p&64&&(x.message=`${h[8](h[6].totalBuffer.used)}/${h[8](h[6].totalBuffer.total)}`),p&64&&(x.value=h[6].totalBuffer.used),p&64&&(x.max=h[6].totalBuffer.total),c.$set(x)},i(h){d||(Te(a.$$.fragment,h),Te(i.$$.fragment,h),Te(f.$$.fragment,h),Te(c.$$.fragment,h),d=!0)},o(h){De(a.$$.fragment,h),De(i.$$.fragment,h),De(f.$$.fragment,h),De(c.$$.fragment,h),d=!1},d(h){h&&(se(t),se(r),se(n),se(s),se(o),se(l),se(u)),lt(a),lt(i),lt(f),lt(c)}}}function $s(e){let t,a,r=e[18].id+"",n,i,s=e[18].name+"",o,f,l,u,c,d,h=e[18].state+"",p,v,g,C,x,y=e[18].address+"",S,T,A,k,B,O=e[10](e[18].uptime)+"",I,w;return{c(){t=N("li"),a=de("ID: "),n=de(r),i=de(", "),o=de(s),f=Q(),l=N("ul"),u=N("li"),c=N("span"),c.textContent="state:",d=Q(),p=de(h),v=Q(),g=N("li"),C=N("span"),C.textContent="Address",x=de(": "),S=de(y),T=Q(),A=N("li"),k=N("span"),k.textContent="Uptime",B=de(": "),I=de(O),w=Q(),L(t,"font-size","11pt"),L(t,"font-weight","100"),R(t,"class","svelte-1emz6h9"),L(c,"font-weight","600"),R(u,"class","svelte-1emz6h9"),L(C,"font-weight","600"),R(g,"class","svelte-1emz6h9"),L(k,"font-weight","600"),R(A,"class","svelte-1emz6h9"),L(l,"padding-left","18px"),L(l,"font-size","10pt"),L(l,"line-height","12pt"),L(l,"margin-bottom","10px"),L(l,"color","#717171")},m(P,V){le(P,t,V),m(t,a),m(t,n),m(t,i),m(t,o),le(P,f,V),le(P,l,V),m(l,u),m(u,c),m(u,d),m(u,p),m(l,v),m(l,g),m(g,C),m(g,x),m(g,S),m(l,T),m(l,A),m(A,k),m(A,B),m(A,I),m(l,w)},p(P,V){V&128&&r!==(r=P[18].id+"")&&Ke(n,r),V&128&&s!==(s=P[18].name+"")&&Ke(o,s),V&128&&h!==(h=P[18].state+"")&&Ke(p,h),V&128&&y!==(y=P[18].address+"")&&Ke(S,y),V&128&&O!==(O=P[10](P[18].uptime)+"")&&Ke(I,O)},d(P){P&&(se(t),se(f),se(l))}}}function jh(e){let t,a;return{c(){t=new Tn(!1),a=ja(),t.a=a},m(r,n){t.m(e[2],r,n),le(r,a,n)},p(r,n){n&4&&t.p(r[2])},d(r){r&&(se(a),t.d())}}}function Yh(e){let t,a,r,n,i,s,o,f,l,u,c,d,h,p,v,g,C,x,y,S,T,A,k,B=e[6]!==void 0&&Zs(e),O=e[6]!==void 0&&Js(e),I=ar(e[7]),w=[];for(let K=0;K<I.length;K+=1)w[K]=$s(Xs(e,I,K));function P(K){e[11](K)}function V(K){e[12](K)}let $={$$slots:{default:[jh]},$$scope:{ctx:e}};return e[1]!==void 0&&($.show=e[1]),e[3]!==void 0&&($.button=e[3]),g=new wa({props:$}),ft.push(()=>Ht(g,"show",P)),ft.push(()=>Ht(g,"button",V)),g.$on("close",function(){Wa(e[4])&&e[4].apply(this,arguments)}),S=new Wh({props:{show:e[0],sysInfo:e[5]}}),{c(){t=N("main"),a=N("h2"),a.textContent="Status",r=Q(),n=N("div"),i=N("div"),s=N("div"),o=N("div"),o.innerHTML=`<img src="${zh}" width="16" height="16" alt="info"/> <span style="margin-left: 2px; font-size: 10pt; text-decoration: underline;color: #555;">INFO</span>`,f=Q(),B&&B.c(),l=Q(),O&&O.c(),u=Q(),c=N("div"),d=N("div"),d.textContent="Client list",h=Q(),p=N("ul");for(let K=0;K<w.length;K+=1)w[K].c();v=Q(),ut(g.$$.fragment),y=Q(),ut(S.$$.fragment),R(a,"class","title"),L(o,"display","flex"),L(o,"align-items","center"),L(o,"cursor","pointer"),L(o,"margin-bottom","5px"),L(s,"display","inline-block"),L(d,"margin-top","10px"),L(d,"font-size","12pt"),L(d,"font-weight","bold"),L(p,"padding-left","20px"),L(p,"margin-top","5px"),L(c,"margin-top","10px"),R(n,"class","round-box"),R(t,"class","svelte-1emz6h9")},m(K,H){le(K,t,H),m(t,a),m(t,r),m(t,n),m(n,i),m(i,s),m(s,o),m(i,f),B&&B.m(i,null),m(n,l),O&&O.m(n,null),m(n,u),m(n,c),m(c,d),m(c,h),m(c,p);for(let q=0;q<w.length;q+=1)w[q]&&w[q].m(p,null);m(t,v),ot(g,t,null),m(t,y),ot(S,t,null),T=!0,A||(k=_e(o,"click",e[9]),A=!0)},p(K,[H]){if(e=K,e[6]!==void 0?B?B.p(e,H):(B=Zs(e),B.c(),B.m(i,null)):B&&(B.d(1),B=null),e[6]!==void 0?O?(O.p(e,H),H&64&&Te(O,1)):(O=Js(e),O.c(),Te(O,1),O.m(n,u)):O&&(zr(),De(O,1,1,()=>{O=null}),qr()),H&1152){I=ar(e[7]);let fe;for(fe=0;fe<I.length;fe+=1){const X=Xs(e,I,fe);w[fe]?w[fe].p(X,H):(w[fe]=$s(X),w[fe].c(),w[fe].m(p,null))}for(;fe<w.length;fe+=1)w[fe].d(1);w.length=I.length}const q={};H&2097156&&(q.$$scope={dirty:H,ctx:e}),!C&&H&2&&(C=!0,q.show=e[1],Kt(()=>C=!1)),!x&&H&8&&(x=!0,q.button=e[3],Kt(()=>x=!1)),g.$set(q);const ne={};H&1&&(ne.show=e[0]),H&32&&(ne.sysInfo=e[5]),S.$set(ne)},i(K){T||(Te(O),Te(g.$$.fragment,K),Te(S.$$.fragment,K),T=!0)},o(K){De(O),De(g.$$.fragment,K),De(S.$$.fragment,K),T=!1},d(K){K&&se(t),B&&B.d(),O&&O.d(),_a(w,K),lt(g),lt(S),A=!1,k()}}}function Xh(e,t,a){let r=!1,n=!1,i="",s="Ok",o,f=()=>{},l,u,c=[];kr(async()=>{o||d(),l||a(5,l=await za.instance.getSysInfo())});let d=()=>{h(),o||(o=setInterval(async()=>{await h()==!1&&clearInterval(o)},1e3))},h=async()=>{try{return a(6,u=await za.instance.getSysUsage()),a(7,c=await za.instance.getClientStatus()),!0}catch(T){T instanceof at&&p()}return!1},p=()=>{v("Session is expired.<br/>Please login again.","OK",()=>{location.href="/"})},v=(T,A,k)=>{A?a(3,s=A):A="OK",k==null?a(4,f=()=>{}):a(4,f=k),a(2,i=T),a(1,n=!0)},g=(T,A)=>T>1099511627776?`${fr.round(T/1099511627776,1)}${A?"":"TiB"}`:T>1073741824?`${fr.round(T/1073741824,1)}${A?"":"GiB"}`:T>1048576?`${fr.round(T/1048576,1)}${A?"":"MiB"}`:T>1024?`${fr.round(T/1024,1)}${A?"":"KiB"}`:`${T}${A?"":"B"}`,C=T=>{a(0,r=!0)},x=T=>{T=T/1e3;const A=Math.floor(T/(24*60*60)),k=Math.floor(T%(24*60*60)/(60*60)),B=Math.floor(T%(60*60)/60),O=Math.floor(T%60);return`${A}d ${k}h ${B}m ${O}s`};function y(T){n=T,a(1,n)}function S(T){s=T,a(3,s)}return[r,n,i,s,f,l,u,c,g,C,x,y,S]}class Zh extends Wt{constructor(t){super(),Qt(this,t,Xh,Yh,Gt,{})}}function Jh(e){let t;return{c(){t=N("div"),t.textContent="Checking..."},m(a,r){le(a,t,r)},i:ct,o:ct,d(a){a&&se(t)}}}function $h(e){let t,a;return t=new Mh({}),{c(){ut(t.$$.fragment)},m(r,n){ot(t,r,n),a=!0},i(r){a||(Te(t.$$.fragment,r),a=!0)},o(r){De(t.$$.fragment,r),a=!1},d(r){lt(t,r)}}}function ep(e){let t,a,r,n,i,s;return t=new sh({}),r=new Zh({}),i=new Oh({}),{c(){ut(t.$$.fragment),a=Q(),ut(r.$$.fragment),n=Q(),ut(i.$$.fragment)},m(o,f){ot(t,o,f),le(o,a,f),ot(r,o,f),le(o,n,f),ot(i,o,f),s=!0},i(o){s||(Te(t.$$.fragment,o),Te(r.$$.fragment,o),Te(i.$$.fragment,o),s=!0)},o(o){De(t.$$.fragment,o),De(r.$$.fragment,o),De(i.$$.fragment,o),s=!1},d(o){o&&(se(a),se(n)),lt(t,o),lt(r,o),lt(i,o)}}}function tp(e){let t,a,r,n,i,s;const o=[ep,$h,Jh],f=[];function l(u,c){return u[0]==="Valid"?0:u[0]==="Invalid"?1:2}return a=l(e),r=f[a]=o[a](e),i=new wa({}),{c(){t=N("main"),r.c(),n=Q(),ut(i.$$.fragment),R(t,"class","svelte-16fv2ts")},m(u,c){le(u,t,c),f[a].m(t,null),m(t,n),ot(i,t,null),s=!0},p(u,[c]){let d=a;a=l(u),a!==d&&(zr(),De(f[d],1,1,()=>{f[d]=null}),qr(),r=f[a],r||(r=f[a]=o[a](u),r.c()),Te(r,1),r.m(t,n))},i(u){s||(Te(r),Te(i.$$.fragment,u),s=!0)},o(u){De(r),De(i.$$.fragment,u),s=!1},d(u){u&&se(t),f[a].d(),lt(i)}}}function rp(e,t,a){let r="Checking";return kr(async()=>{a(0,r=await Ga.validateSession()?"Valid":"Invalid")}),[r]}class ap extends Wt{constructor(t){super(),Qt(this,t,rp,tp,Gt,{})}}new ap({target:document.getElementById("app")});
